{
  "name": "Certification_Partner",
  "id": "c61316c9-f889-42a9-9c61-f377b985f709",
  "compatibilityLevel": 1567,
  "model": {
    "culture": "en-US",
    "defaultPowerBIDataSourceVersion": "powerBI_V3",
    "dataSources": [
      {
        "type": "structured",
        "name": "SharePoint/https://microsoft sharepoint com/teams/WWLReporting",
        "connectionDetails": {
          "authentication": null,
          "query": null,
          "protocol": "sharepoint-list",
          "address": {
            "url": "https://microsoft.sharepoint.com/teams/WWLReporting"
          }
        },
        "options": {
          "implementation": null,
          "apiVersion": 15
        },
        "credential": {
          "AuthenticationKind": "Windows",
          "PrivacySetting": "Organizational",
          "Username": "v-ksjaiswal@microsoft.com"
        }
      }
    ],
    "tables": [
      {
        "name": "Account",
        "description": "Account",
        "lineageTag": "c0fe916f-b159-48a6-a4fa-628f6da34032",
        "columns": [
          {
            "name": "Account",
            "dataType": "string",
            "description": "Account",
            "sourceColumn": "Account",
            "lineageTag": "0041a3d6-e40c-4d74-8737-2a1ec5fc75e4"
          },
          {
            "name": "Segment",
            "dataType": "string",
            "description": "Segment",
            "sourceColumn": "Segment",
            "lineageTag": "29db6b28-f1dd-4f81-b659-b02d0f1517e6"
          },
          {
            "name": "Sub Segment",
            "dataType": "string",
            "description": "Sub Segment",
            "sourceColumn": "Sub Segment",
            "lineageTag": "14d6116d-5b00-4d8a-8120-17aa7a635dd0"
          },
          {
            "name": "Is S500",
            "dataType": "string",
            "description": "Is S500",
            "sourceColumn": "Is S500",
            "lineageTag": "d00236e9-1177-4e13-884c-36a77d06e056"
          },
          {
            "name": "Managed Account",
            "dataType": "string",
            "description": "Managed Account",
            "sourceColumn": "Managed Account",
            "lineageTag": "67b022c6-ec04-481c-b902-7f2f9712c6ac"
          },
          {
            "name": "TPID",
            "dataType": "string",
            "description": "TPID",
            "sourceColumn": "TPID",
            "lineageTag": "94d6ff92-adad-4ee4-8175-233a091ef17b"
          },
          {
            "name": "Industry",
            "dataType": "string",
            "description": "Industry",
            "sourceColumn": "Industry",
            "lineageTag": "626ce002-babd-43cb-92b4-df40c2fe1b58"
          },
          {
            "name": "AccountID",
            "dataType": "string",
            "description": "AccountID",
            "isHidden": true,
            "sourceColumn": "AccountID",
            "isAvailableInMdx": false,
            "lineageTag": "df8c18fa-e13f-487f-b323-8edf1dbdd306"
          },
          {
            "name": "Account Owner",
            "dataType": "string",
            "description": "Account Owner",
            "sourceColumn": "Account Owner",
            "lineageTag": "38d58538-5c75-45d5-87e1-ff5b88ec1b99"
          },
          {
            "name": "TPMName",
            "dataType": "string",
            "description": "TPMName",
            "sourceColumn": "TPMName",
            "lineageTag": "d85d87a8-9c32-4926-bfec-1ad2198cde42"
          },
          {
            "name": "PartnerOne Name",
            "dataType": "string",
            "description": "PartnerOneName",
            "sourceColumn": "PartnerOneName",
            "isAvailableInMdx": false,
            "lineageTag": "c35c984d-7799-427d-8028-3ab44954bf9b"
          },
          {
            "name": "PartnerOne ID",
            "dataType": "string",
            "description": "PartnerOneID",
            "sourceColumn": "PartnerOneID",
            "isAvailableInMdx": false,
            "lineageTag": "2b60e61f-6aee-459a-b9f7-257fba45cec5"
          },
          {
            "name": "SalesGroupHierarchyKey",
            "dataType": "string",
            "description": "AccountID",
            "isHidden": true,
            "sourceColumn": "SalesGroupHierarchyKey",
            "isAvailableInMdx": false,
            "lineageTag": "fc7b8786-b13b-4162-acd8-025b2f2de98f"
          },
          {
            "name": "Country",
            "dataType": "string",
            "description": "Country",
            "sourceColumn": "Country",
            "lineageTag": "72808da9-c727-47c4-aac1-b726ca36bada"
          }
        ],
        "partitions": [
          {
            "name": "Account",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "DECLARE @Date AS DATE = '2018-07-01';",
                "DECLARE @AppliedSkillsDate AS DATE = '2023-10-25';",
                "DECLARE @SourceSystem AS NVARCHAR(50) = 'Learn';",
                "",
                "WITH CTE_RestrictedAccount AS (",
                "        SELECT CONVERT(NVARCHAR(255), BPA.AccountID) AS AccountID",
                "        FROM Learning.LearnerCertifications LC",
                "        INNER JOIN [Learning].[BridgePersonAccounts] BPA ON LC.PersonID = BPA.PersonID",
                "            AND CAST(EffectiveDate AS DATE) >= @Date",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), CDES.AccountID) AS AccountID",
                "        FROM Learning.LearnerCertifications LC",
                "        INNER JOIN [Operations].[BridgePersonCDESAccounts] CDES ON LC.PersonID = CDES.PersonID",
                "            AND CDES.SourceSystem = @SourceSystem",
                "        WHERE CAST(EffectiveDate AS DATE) >= @Date",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), BPA.AccountID) AS AccountID",
                "        FROM Learning.ExamParticipation EP",
                "        INNER JOIN [Learning].[BridgePersonAccounts] BPA ON EP.PersonID = BPA.PersonID",
                "            AND CAST(ExamCompletionDate AS DATE) >= @Date",
                "        ",
                "        UNION",
                "        ",
                "        --Exams Participation",
                "        SELECT CONVERT(NVARCHAR(255), CDES.AccountID) AS AccountID",
                "        FROM Learning.ExamParticipation EP",
                "        INNER JOIN [Operations].[BridgePersonCDESAccounts] CDES ON EP.PersonID = CDES.PersonID",
                "            AND CDES.SourceSystem = @SourceSystem",
                "            AND CAST(ExamCompletionDate AS DATE) >= @Date",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), BPA.AccountID) AS AccountID",
                "        FROM Learning.ExamRegistrations ER",
                "        INNER JOIN [Learning].[BridgePersonAccounts] BPA ON ER.PersonID = BPA.PersonID",
                "            AND CAST(ExamDate AS DATE) >= @Date",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), CDES.AccountID) AS AccountID",
                "        FROM Learning.ExamRegistrations ER",
                "        INNER JOIN [Operations].[BridgePersonCDESAccounts] CDES ON ER.PersonID = CDES.PersonID",
                "            AND CDES.SourceSystem = @SourceSystem ",
                "            AND CAST(ExamDate AS DATE) >= @Date",
                "",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), BPA.AccountID) AS AccountID",
                "        FROM Learning.MicrosoftCertifiedTrainers MCT",
                "        INNER JOIN [Learning].[BridgePersonAccounts] BPA ON MCT.PersonID = BPA.PersonID",
                "            AND CAST(MCT.AnniversaryDate AS DATE) > CAST(MCT.EtlUpdateDateTime AS DATE)",
                "        ",
                "        UNION",
                "        ",
                "        --Fact MCT",
                "        SELECT CONVERT(NVARCHAR(255), CDES.AccountID) AS AccountID",
                "        FROM Learning.MicrosoftCertifiedTrainers MCT",
                "        INNER JOIN [Operations].[BridgePersonCDESAccounts] CDES ON MCT.PersonID = CDES.PersonID",
                "            AND CDES.SourceSystem = @SourceSystem ",
                "            AND CAST(MCT.AnniversaryDate AS DATE) > CAST(MCT.EtlUpdateDateTime AS DATE)",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), BPA.AccountID) AS AccountID",
                "        FROM [Learning].[AppliedSkillParticipation] ASP",
                "        INNER JOIN [Learning].[BridgePersonAccounts] BPA ON ASP.PersonID = BPA.PersonID",
                "        WHERE LOWER(ASP.AppliedSkillName) LIKE 'apl-____%'",
                "            AND (",
                "                (NOT LOWER(ASP.SolutionArea) LIKE 'apl-0000%')",
                "                OR ASP.SolutionArea IS NULL",
                "                )",
                "            AND LOWER(ASP.AppliedSkillStatus) <> 'lab creation failed'",
                "            AND TRY_CAST(ASP.AppliedSkillStartTime AS DATE) >= @AppliedSkillsDate",
                "        ",
                "        UNION",
                "        ",
                "        --Applied Skills",
                "        SELECT CONVERT(NVARCHAR(255), CDES.AccountID) AS AccountID",
                "        FROM [Learning].[AppliedSkillParticipation] ASP",
                "        INNER JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = ASP.PersonID",
                "            AND CDES.SourceSystem = @SourceSystem",
                "        WHERE LOWER(ASP.AppliedSkillName) LIKE 'apl-____%'",
                "            AND (",
                "                (NOT LOWER(ASP.SolutionArea) LIKE 'apl-0000%')",
                "                OR ASP.SolutionArea IS NULL",
                "                )",
                "            AND LOWER(ASP.AppliedSkillStatus) <> 'lab creation failed'",
                "            AND TRY_CAST(ASP.AppliedSkillStartTime AS DATE) >= @AppliedSkillsDate",
                "",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), BPA.AccountID) AS AccountID",
                "        FROM [Learning].[PracticeExamParticipation] PEP",
                "        INNER JOIN [Learning].[BridgePersonAccounts] BPA ON PEP.PersonID = BPA.PersonID",
                "            AND PEP.SourceSystem = 'Learn'            ",
                "        ",
                "        UNION",
                "        ",
                "        SELECT CONVERT(NVARCHAR(255), CDES.AccountID) AS AccountID",
                "        FROM [Learning].[PracticeExamParticipation] PEP",
                "        INNER JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PEP.PersonID",
                "            AND PEP.SourceSystem = 'Learn'            ",
                "",
                "        UNION",
                "",
                "        SELECT CONVERT(NVARCHAR(255), A.AccountID) AS AccountID from [Operations].[SafelistedDomains] SLD",
                "        JOIN Learning.Accounts A ON A.SkillingAccountCode = SLD.SkillingAccountCode",
                "        )",
                "SELECT ISNULL(CAST(A.[AccountID] AS NVARCHAR(255)), '-1') AS [AccountID]",
                "    ,ISNULL(CAST(TP.[TPID] AS NVARCHAR(255)), '-1') AS [TPID]",
                "    ,ISNULL(CAST(TP.[AccountName] AS NVARCHAR(400)), 'Unknown') AS [Account]",
                "    ,ISNULL(IIF(TP.[Segment] = 'N/A', 'Unsegmented', TP.[Segment]), 'Unknown') AS [Segment]",
                "    ,ISNULL(IIF(TP.[SubSegment] = 'N/A', 'Unsegmented Reseller', TP.[SubSegment]), 'Unknown') AS [Sub Segment]",
                "    ,ISNULL(IIF(TP.[Industry] = 'N/A', 'Unknown', TP.[Industry]), 'Unknown') AS [Industry]",
                "    ,ISNULL(TP.[IsStrategic500Account], 'No') AS [Is S500]",
                "    ,ISNULL(TP.[IsManagedAccount], 'No') AS [Managed Account]",
                "    ,ISNULL(U.CountryName, 'Unknown') AS Country",
                "    ,ISNULL(CAST(TP.[TrainingProgramManagerName] AS NVARCHAR(400)), 'Unknown') AS [TPMName]",
                "    ,ISNULL(CAST(TP.[AccountOwnerName] AS NVARCHAR(400)), 'Unknown') AS [Account Owner]",
                "    ,ISNULL(CAST(TP.[SalesGroupHierarchyID] AS NVARCHAR(255)), '- 1') AS [SalesGroupHierarchyKey]",
                "    ,ISNULL(CAST(TP.[PartnerOneID] AS NVARCHAR(255)), 'Unknown') AS [PartnerOneID]",
                "    ,ISNULL(TP.PartnerOneName, 'Unknown') AS [PartnerOneName]",
                "FROM [Learning].[Accounts] A",
                "INNER JOIN CTE_RestrictedAccount PA ON PA.AccountID = A.AccountID",
                "LEFT JOIN (",
                "    SELECT A.[TPID]",
                "        ,A.[AccountName]",
                "        ,A.[Segment]",
                "        ,A.[SubSegment]",
                "        ,A.[Industry]",
                "        ,A.[GeographyID]",
                "        ,A.[IsStrategic500Account]",
                "        ,A.[IsManagedAccount]",
                "        ,A.[TrainingProgramManagerName]",
                "        ,A.[AccountOwnerName]",
                "        ,A.[SalesGroupHierarchyID]",
                "        ,A.[PartnerOneID]",
                "        ,A.[PartnerOneName]",
                "    FROM [Learning].[Accounts] A",
                "    WHERE A.MSSalesOrgID = A.[TPID]",
                "        AND A.[TPID] IS NOT NULL",
                "    ) TP ON TP.[TPID] = A.TPID",
                "LEFT JOIN [Learning].[Geographies] U ON U.[GeographyID] = TP.GeographyID --grain is at Country",
                "",
                "UNION ALL",
                "",
                "SELECT '-1' AS [AccountID]",
                "    ,'-1' AS [TPID]",
                "    ,'Unknown' AS [Account]",
                "    ,'Unknown' AS [Segment]",
                "    ,'Unknown' AS [Sub Segment]",
                "    ,'Unknown' AS [Industry]",
                "    ,'No' AS [Is S500]",
                "    ,'No' AS [Managed Account]",
                "    ,'Unknown' AS Country",
                "    ,'Unknown' AS [TPMName]",
                "    ,'Unknown' AS [Account Owner]",
                "    ,'- 1' AS [SalesGroupHierarchyKey]",
                "    ,'Unknown' AS [PartnerOneID]",
                "    ,'Unknown' AS [PartnerOneName]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Event",
        "description": "Event",
        "lineageTag": "74b6ba05-f18a-4144-93b9-13d4e2c3831a",
        "columns": [
          {
            "name": "EventKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "EventKey",
            "isAvailableInMdx": false,
            "lineageTag": "8c4ca39f-ebaa-4685-b8f4-5e8781d423fa"
          },
          {
            "name": "Event Name",
            "dataType": "string",
            "description": "Event Name",
            "sourceColumn": "Event Name",
            "lineageTag": "f94e86cc-282e-4479-b919-4c174538e334"
          },
          {
            "name": "Event Start Date",
            "dataType": "dateTime",
            "description": "Event Start Date",
            "sourceColumn": "Event Start Date",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "f234e541-7bc2-4b3d-a4c0-148d95d67f95"
          },
          {
            "name": "Event Expiry Date",
            "dataType": "dateTime",
            "description": "Event Expiry Date",
            "sourceColumn": "Event Expiry Date",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "37c5386b-3c1f-47da-92f2-c12acc446ab2"
          }
        ],
        "partitions": [
          {
            "name": "Event",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT [EventID] AS [EventKey]",
                "    ,CASE ",
                "        WHEN TRY_CAST(StartDate AS DATE) IS NOT NULL",
                "            THEN CONVERT(DATE, StartDate)",
                "        ELSE '1900-01-01'",
                "        END AS  [Event Start Date]",
                "    ,CASE ",
                "        WHEN TRY_CAST(EndDate AS DATE) IS NOT NULL",
                "            THEN CONVERT(DATE, EndDate)",
                "        ELSE '1900-01-01'",
                "        END AS [Event Expiry Date]",
                "    ,ISNULL(Name, 'Unknown') AS [Event Name]",
                "FROM [Learning].[Events]",
                "WHERE SourceSystem = 'MSCert'",
                "    AND PrimaryEventName <> 'MicrosoftTrainingDay'",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [EventKey]",
                "    ,'1900-01-01' AS [Event Start Date]",
                "    ,'1900-01-01'  AS [Event Expiry Date]",
                "    ,'Unknown' AS [Event Name]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam Metrics",
        "description": "Exam Metrics",
        "lineageTag": "35fc6d06-0dc4-4432-a3da-c616a5e539cc",
        "columns": [
          {
            "name": "Exam Status",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Exam Status",
            "isAvailableInMdx": false,
            "lineageTag": "0743347a-946f-4ba1-9e9f-1a8a6d378a8c"
          },
          {
            "name": "ExamStatusKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamStatusKey",
            "isAvailableInMdx": false,
            "lineageTag": "617181c8-2ec9-4864-bb29-377ca3ac205f"
          }
        ],
        "partitions": [
          {
            "name": "Exam Metrics",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "--Dummy table for grouping",
                "SELECT 'Unknown' AS [Exam Status]",
                "    ,'Unknown' AS [ExamStatusKey]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "Exams",
            "description": "This calculation is finding the number of distinct IDs from the Fact Exam table that have a IsBeta value that is not equal to 1 and an ExamCount value of 1. If the result is 0, then the calculation returns a blank, otherwise it returns the result.",
            "expression": [
              "VAR ExamPass =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Exam'[ID] ),",
              "            1",
              "        ),",
              "        KEEPFILTERS ( 'Fact Exam'[IsBeta] <> \"Yes\"",
              "            && 'Fact Exam'[ExamCount] = 1 )",
              "    )",
              "RETURN",
              "    IF (",
              "        ExamPass = 0,",
              "        BLANK (),",
              "        ExamPass",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Beta Exams",
            "description": "This calculation is used to count the number of distinct exam IDs that have IsBeta set to 1 and ExamCount set to 1. If the result is 0, it will return a blank value, otherwise it will return the number of distinct exam IDs.",
            "expression": [
              "VAR ExamPass =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Exam'[ID] ),",
              "            1",
              "        ),",
              "        'Fact Exam'[IsBeta] = \"Yes\",",
              "        'Fact Exam'[ExamCount] = 1",
              "    )",
              "RETURN",
              "    IF (",
              "        ExamPass = 0,",
              "        BLANK (),",
              "        ExamPass",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Exam Pass Rate",
            "description": "This calculation is used to determine the percentage of exams that have been passed by the current user. It first calculates the number of distinct exam IDs that have been marked as \"Passed\" and have an ExamCount of 1. It then calculates the number of distinct exam IDs that have been marked as \"Failed\" and have an ExamCount of 1. It then checks if the current user is present in the User Alias table. If the user is present, it divides the number of",
            "expression": [
              "VAR ExamPass =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Exam'[ID] ),",
              "            1",
              "        ),",
              "        KEEPFILTERS ( 'Exam Status'[Exam Status] = \"Passed\" ),",
              "        KEEPFILTERS ( 'Fact Exam'[ExamCount] = 1 )",
              "    )",
              "VAR ExamFail =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Exam'[ID] ),",
              "            1",
              "        ),",
              "        KEEPFILTERS ( 'Exam Status'[Exam Status] = \"Failed\" ),",
              "        KEEPFILTERS ( 'Fact Exam'[ExamCount] = 1 )",
              "    )",
              "VAR checkuser =",
              "    CALCULATE (",
              "        COUNTROWS ( 'Exam Pass Rate User Requests' ),",
              "        KEEPFILTERS (",
              "            'Exam Pass Rate User Requests'[Requestor Alias]",
              "                = MID (",
              "                    USERPRINCIPALNAME (),",
              "                    1,",
              "                    SEARCH ( \"@\", USERPRINCIPALNAME () ) - 1",
              "                )",
              "        )",
              "    )",
              "VAR val =",
              "    IF (",
              "        checkuser <> BLANK (),",
              "        1,",
              "        0",
              "    )",
              "VAR result =",
              "    IF (",
              "        val,",
              "        DIVIDE (",
              "            ExamPass,",
              "            ExamPass + ExamFail",
              "        ),",
              "        BLANK ()",
              "    )",
              "RETURN",
              "    result"
            ],
            "formatString": "#,##0.0 %"
          },
          {
            "name": "Exam Unique Users",
            "description": "This calculation is used to count the number of distinct users who have taken an exam, but not a beta exam. The calculation first sums up the number of distinct users, and then checks if the exam is not a beta exam. If the number of distinct users is 0, the calculation will return a blank, otherwise it will return the number of distinct users.",
            "expression": [
              "VAR CERT =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Exam'[UserKey] ),",
              "            1",
              "        ),",
              "        'Fact Exam'[IsBeta] <> \"Yes\"",
              "    )",
              "RETURN",
              "    IF (",
              "        CERT = 0,",
              "        BLANK (),",
              "        CERT",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Beta Exam Unique Users",
            "description": "This calculation is finding the number of distinct users who have taken a beta exam. It returns a blank if no users have taken a beta exam, otherwise it returns the number of users who have taken a beta exam.",
            "expression": [
              "VAR CERT =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Exam'[UserKey] ),",
              "            1",
              "        ),",
              "        'Fact Exam'[IsBeta] = \"Yes\"",
              "    )",
              "RETURN",
              "    IF (",
              "        CERT = 0,",
              "        BLANK (),",
              "        CERT",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Exam No-Show Rate",
            "expression": [
              "var NoshowExams = CALCULATE([Exams],KEEPFILTERS('Exam Status'[Exam Status] =\"No Show\"))",
              "var ExamsPass = CALCULATE([Exams],KEEPFILTERS('Exam Status'[Exam Status] =\"Passed\"))",
              "var ExamsFail = CALCULATE([Exams],KEEPFILTERS('Exam Status'[Exam Status] =\"Failed\"))",
              "Return DIVIDE(NoshowExams,NoshowExams+ExamsPass+ExamsFail,\"NA\")"
            ],
            "formatString": "#,##0.0 %",
            "isHidden": true,
            "lineageTag": "c4d0c86d-3fbc-4584-93bf-3581287ae7fe"
          }
        ]
      },
      {
        "name": "FTE Geo",
        "description": "FTE Geo",
        "lineageTag": "5e0fc30d-2ff7-4e87-aedf-67d42e10e2c6",
        "columns": [
          {
            "name": "FinanceGeographyKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "FinanceGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "8d35a0af-6d1d-4649-9680-196e9ed86bb0"
          },
          {
            "name": "Sales Location",
            "dataType": "string",
            "description": "Sales Location",
            "sourceColumn": "Sales Location",
            "lineageTag": "b268e042-eff8-471c-90de-5cc6d83409cf"
          },
          {
            "name": "Sales District",
            "dataType": "string",
            "description": "Sales District",
            "sourceColumn": "Sales District",
            "lineageTag": "3b33dba6-4da0-4a02-9fbb-3691c8ae72a5"
          },
          {
            "name": "Area Summary",
            "dataType": "string",
            "description": "Area Summary",
            "sourceColumn": "Area Summary",
            "lineageTag": "ea0fde08-b4d8-422f-8ec0-5025ec3a20c2"
          },
          {
            "name": "Region",
            "dataType": "string",
            "description": "Region",
            "sourceColumn": "Region",
            "lineageTag": "946afc09-eccd-4424-979c-8bc46f2e6741"
          },
          {
            "name": "Sub Region",
            "dataType": "string",
            "description": "Sub Region",
            "sourceColumn": "Sub Region",
            "lineageTag": "74cb844b-9af2-4db7-bf70-3a19753b534c"
          },
          {
            "name": "Sales Sub Location",
            "dataType": "string",
            "description": "Sales Sub Location",
            "sourceColumn": "Sales Sub Location",
            "lineageTag": "1301aa5e-7f11-427c-9974-0fcbc6584ac9"
          },
          {
            "name": "Area",
            "dataType": "string",
            "description": "Area",
            "sourceColumn": "Area",
            "lineageTag": "d00057b7-a197-4110-b1bc-13cb5919ae2c"
          }
        ],
        "partitions": [
          {
            "name": "FTE Geo",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ISNULL(SubRegion, 'Unknown') AS [Sub Region]",
                "    ,ISNULL(Region, 'Unknown') AS [Region]",
                "    ,ISNULL(SalesLocation, 'Unknown') AS [Sales Location]",
                "    ,ISNULL(Area, 'Unknown') AS [Area]",
                "    ,ISNULL(SalesDistrict, 'Unknown') AS [Sales District]",
                "    ,ISNULL(SalesSubLocation, 'Unknown') AS [Sales Sub Location]",
                "    ,ISNULL(AreaSummary, 'Unknown') AS [Area Summary]",
                "    ,ISNULL(FinanceGeographyID, 'Unknown') AS [FinanceGeographyKey]",
                "FROM [Learning].[ReadinessFinanceGeographies]",
                "WHERE FinanceGeographyID <> 'Unknown'",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [Sub Region]",
                "    ,'Unknown' AS [Region]",
                "    ,'Unknown' AS [Sales Location]",
                "    ,'Unknown' AS [Area]",
                "    ,'Unknown' AS [Sales District]",
                "    ,'Unknown' AS [Sales Sub Location]",
                "    ,'Unknown' AS [Area Summary]",
                "    ,'Unknown' AS [FinanceGeographyKey]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "Finance Geography Hierarchy",
            "lineageTag": "af5431cf-ea4e-4b9a-8fc9-f384aa099f34",
            "levels": [
              {
                "name": "Area Summary",
                "ordinal": 0,
                "column": "Area Summary",
                "lineageTag": "eb39f62e-f4d4-44b3-adf0-4a7a82f6819a"
              },
              {
                "name": "Area",
                "ordinal": 1,
                "column": "Area",
                "lineageTag": "4782ec0d-4bf6-412e-8cd3-71962fb0c4ab"
              },
              {
                "name": "Region",
                "ordinal": 2,
                "column": "Region",
                "lineageTag": "46b441f6-8898-4b7f-8217-f1dc539514e9"
              },
              {
                "name": "Sub Region",
                "ordinal": 3,
                "column": "Sub Region",
                "lineageTag": "2a85a1d7-e84e-4e63-b1d8-2f4cf3e30f13"
              },
              {
                "name": "Sales Location",
                "ordinal": 4,
                "column": "Sales Location",
                "lineageTag": "b9131ecf-10bd-4467-8743-8f8b758441ee"
              },
              {
                "name": "Sales Sub Location",
                "ordinal": 5,
                "column": "Sales Sub Location",
                "lineageTag": "587c80b2-6817-46d5-9fd4-17739d58c9ef"
              },
              {
                "name": "Sales District",
                "ordinal": 6,
                "column": "Sales District",
                "lineageTag": "25168684-0b3d-4193-965c-c9f4eed38dc9"
              }
            ]
          }
        ]
      },
      {
        "name": "Test Center",
        "description": "Test Center",
        "lineageTag": "b430742a-70dc-45d4-a151-2eb32cadaa74",
        "columns": [
          {
            "name": "TestCenterKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "TestCenterKey",
            "isAvailableInMdx": false,
            "lineageTag": "161990d3-e2d7-45b5-ad15-ae16254545da"
          },
          {
            "name": "Test Center ID",
            "dataType": "string",
            "description": "Test Center ID",
            "sourceColumn": "Test Center ID",
            "lineageTag": "72d71862-7f99-4ad5-be2e-fcc98deaf6a0"
          },
          {
            "name": "Test Center Name",
            "dataType": "string",
            "description": "Test Center Name",
            "sourceColumn": "TestCenterName",
            "lineageTag": "0b563cc7-901a-46cf-9d1e-d5ea907222ef"
          },
          {
            "name": "Test Center Number",
            "dataType": "string",
            "description": "Test Center Number",
            "sourceColumn": "TestCenterNumber",
            "lineageTag": "57aac66c-b55e-4add-935f-2acd0648fff1"
          },
          {
            "name": "Test Center Type Desc",
            "dataType": "string",
            "description": "Test Center Type Desc",
            "sourceColumn": "TestCenterTypeDesc",
            "lineageTag": "18c584af-55c5-4435-8c63-c7a656cfc30f"
          },
          {
            "name": "State Province Name",
            "dataType": "string",
            "description": "State Province Name",
            "sourceColumn": "StateProvinceName",
            "lineageTag": "a66c27c2-ea43-4401-a4e5-6ddc95800e9c"
          },
          {
            "name": "Country Name",
            "dataType": "string",
            "description": "Country Name",
            "sourceColumn": "Country Name",
            "lineageTag": "21516ca5-9d95-451a-9288-f0b45f7527b5"
          },
          {
            "name": "Microsoft Region Name",
            "dataType": "string",
            "description": "Microsoft Region Name",
            "sourceColumn": "MicrosoftRegionName",
            "lineageTag": "34e4ebea-ff56-45bc-a50c-3a84101eca79"
          },
          {
            "name": "Microsoft Sector Name",
            "dataType": "string",
            "description": "Microsoft Sector Name",
            "sourceColumn": "MicrosoftSectorName",
            "lineageTag": "6895eff2-95b7-4741-8543-679a7c9726a9"
          }
        ],
        "partitions": [
          {
            "name": "Test Center",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT CAST(TC.[TestCenterID] AS NVARCHAR(255)) AS [TestCenterKey]",
                "    ,ISNULL(CAST(TC.[SourceIdentifier] AS NVARCHAR(255)), 'Unknown') AS [Test Center ID]",
                "    ,ISNULL([TestCenterName], 'Unknown') AS TestCenterName",
                "    ,CAST(TC.[SourceIdentifier] AS NVARCHAR(255)) AS [TestCenterNumber]",
                "    ,ISNULL(TC.TestCenterDesc, 'Unknown') AS [TestCenterTypeDesc]",
                "    ,ISNULL(TC.StateProvinceName, 'Unknown') AS [StateProvinceName]",
                "    ,ISNULL(GEO.CountryName, 'Unknown') AS [Country Name]",
                "    ,ISNULL(GEO.Region, 'Unknown') AS [MicrosoftRegionName]",
                "    ,ISNULL(TC.MicrosoftSectorName, 'Unknown') AS [MicrosoftSectorName]",
                "FROM [Learning].[TestCenters] TC",
                "LEFT JOIN Learning.Geographies GEO ON GEO.GeographyID = TC.GeographyID",
                "WHERE [TestCenterID] NOT IN (",
                "        - 1",
                "        ,- 2",
                "        )",
                "    AND TestCenterID IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [TestCenterKey]",
                "    ,'Unknown' AS [Test Center ID]",
                "    ,'Unknown' AS [TestCenterName]",
                "    ,'Unknown' AS [TestCenterNumber]",
                "    ,'Unknown' AS [TestCenterTypeDesc]",
                "    ,'Unknown' AS [StateProvinceName]",
                "    ,'Unknown' AS [Country Name]",
                "    ,'Unknown' AS [MicrosoftRegionName]",
                "    ,'Unknown' AS [MicrosoftSectorName]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Finance Organization",
        "description": "Finance Organization",
        "lineageTag": "7fbd60a2-a8b4-422a-927a-73ae3c1e60bc",
        "columns": [
          {
            "name": "Cost Center",
            "dataType": "string",
            "description": "Cost Center",
            "sourceColumn": "Cost Center",
            "lineageTag": "528fc261-aef4-4f16-92dc-8d541cfb71f9"
          },
          {
            "name": "FinanceOrganizationKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "FinanceOrganizationKey",
            "isAvailableInMdx": false,
            "lineageTag": "d10f3650-7ae8-4f47-80c3-96b9df70c4f1"
          },
          {
            "name": "Function",
            "dataType": "string",
            "description": "Function",
            "sourceColumn": "Function",
            "lineageTag": "ef2a5780-0773-4ffe-9c5e-5bceba047a17"
          },
          {
            "name": "Function Detail",
            "dataType": "string",
            "description": "Function Detail",
            "sourceColumn": "Function Detail",
            "lineageTag": "0ca3f021-3e77-42dc-ba0c-02c29ffda01c"
          },
          {
            "name": "Organization Detail",
            "dataType": "string",
            "description": "Organization Detail",
            "sourceColumn": "Organization Detail",
            "lineageTag": "6c6b02c7-6fce-4cc8-9c80-eafb01024bbb"
          },
          {
            "name": "Organization",
            "dataType": "string",
            "description": "Organization",
            "sourceColumn": "Organization",
            "lineageTag": "37b56772-d101-42f7-829d-85c4ee530181"
          }
        ],
        "partitions": [
          {
            "name": "Finance Organization",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ISNULL(CostCenter, 'Unknown') AS [Cost Center]",
                "    ,ISNULL(CAST(FinanceOrganizationID AS NVARCHAR(255)), 'Unknown') AS [FinanceOrganizationKey]",
                "    ,ISNULL([Function], 'Unknown') AS [Function]",
                "    ,ISNULL(FunctionDetail, 'Unknown') AS [Function Detail]",
                "    ,ISNULL(OrgDetail, 'Unknown') AS [Organization Detail]",
                "    ,ISNULL(Org, 'Unknown') AS [Organization]",
                "FROM Learning.ReadinessFinanceOrganizations",
                "WHERE ISNULL(CAST(FinanceOrganizationID AS NVARCHAR(255)), 'Unknown') <> 'Unknown'",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [Cost Center]",
                "    ,'Unknown' AS [FinanceOrganizationKey]",
                "    ,'Unknown' AS [Function]",
                "    ,'Unknown' AS [Function Detail]",
                "    ,'Unknown' AS [Organization Detail]",
                "    ,'Unknown' AS [Organization]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "Organization Hierarchy",
            "lineageTag": "cc515cd8-d2eb-41cb-b7fe-7bfde4ecef70",
            "levels": [
              {
                "name": "Organization",
                "ordinal": 0,
                "column": "Organization",
                "lineageTag": "73634de8-cfe9-4136-8264-a99881682520"
              },
              {
                "name": "Organization Detail",
                "ordinal": 1,
                "column": "Organization Detail",
                "lineageTag": "68144d50-67b7-47bd-9133-9fc396fffcce"
              },
              {
                "name": "Function",
                "ordinal": 2,
                "column": "Function",
                "lineageTag": "a3329106-ade5-4d83-9373-5384ff952d43"
              },
              {
                "name": "Function Detail",
                "ordinal": 3,
                "column": "Function Detail",
                "lineageTag": "50ce5822-f292-4584-8a1f-3b9881b1c6d2"
              }
            ]
          },
          {
            "name": "Segment Hierarchy",
            "lineageTag": "84934a6c-efa8-47c1-a97d-9559b418faf6"
          }
        ]
      },
      {
        "name": "Certiport VLUtilization",
        "description": "Certiport VLUtilization",
        "lineageTag": "2456c3f1-e947-4c87-b4bb-be6fc918f01b",
        "columns": [
          {
            "name": "VLUtilization_PK",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "VLUtilization_PK",
            "isAvailableInMdx": false,
            "lineageTag": "c21eae17-066b-48bd-ba03-677c2e799fdf"
          },
          {
            "name": "VLUtilization Event Code",
            "dataType": "string",
            "description": "VLUtilization Event Code",
            "sourceColumn": "VLUtilization Event Code",
            "lineageTag": "bbf0beaf-972e-43ee-9160-c21bac9519e9"
          },
          {
            "name": "VLUtilization Event Type Desc",
            "dataType": "string",
            "description": "VLUtilization Event Type Desc",
            "sourceColumn": "VLUtilization Event Type Desc",
            "lineageTag": "062fee32-e9ea-467a-a416-7c35f990454e"
          },
          {
            "name": "VLUtilization Event Desc",
            "dataType": "string",
            "description": "VLUtilization Event Desc",
            "sourceColumn": "VLUtilization Event Desc",
            "lineageTag": "9aba1e56-5bcc-44b6-9320-9698f304b42f"
          }
        ],
        "partitions": [
          {
            "name": "Certiport VLUtilization",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT CAST(VLUtilization AS NVARCHAR(255)) AS [VLUtilization_PK]",
                "    ,ISNULL(EventCode, 'Unknown') AS [VLUtilization Event Code]",
                "    ,ISNULL(EventTypeDescription, 'Unknown') AS [VLUtilization Event Type Desc]",
                "    ,ISNULL(EventDescription, 'Unknown') AS [VLUtilization Event Desc]",
                "FROM Learning.CertiportUtilizations",
                "WHERE VLUtilization IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [VLUtilization_PK]",
                "    ,'Unknown' AS [VLUtilization Event Code]",
                "    ,'Unknown' AS [VLUtilization Event Type Desc]",
                "    ,'Unknown' AS [VLUtilization Event Desc]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam Delivery",
        "description": "Exam Delivery",
        "lineageTag": "c9f17f63-bf43-4dfa-b031-5e28186b5028",
        "columns": [
          {
            "name": "ExamDeliveryKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ExamDeliveryKey",
            "isAvailableInMdx": false,
            "lineageTag": "c9d27e2b-8caf-48dc-add9-cf351400e737"
          },
          {
            "name": "Exam Delivery",
            "dataType": "string",
            "description": "Exam Delivery",
            "sourceColumn": "Exam Delivery",
            "lineageTag": "f028796d-8cb9-4494-8f98-6b9d0c0ee10c"
          }
        ],
        "partitions": [
          {
            "name": "Exam Delivery",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "WITH CTE_Vendors",
                "AS (",
                "    SELECT VendorType",
                "    FROM Learning.ExamRegistrations ER",
                "    WHERE (",
                "            (",
                "                LOWER(ER.SourceSystem) = 'certiport'",
                "                AND LOWER(ER.VendorName) = 'certiport'",
                "                )",
                "            OR (",
                "                LOWER(ISNULL(ER.VendorName, '')) <> 'certiport'",
                "                AND LOWER(ER.SourceSystem) = 'mscert'",
                "                 )",
                "            )",
                "    ",
                "    UNION ALL",
                "    ",
                "    SELECT IIF(LOWER(VendorName) = 'certiport', 'Certiport', DeliveryType) AS Vendortype",
                "    FROM Learning.ExamParticipation",
                "    WHERE (",
                "            (",
                "                LOWER(SourceSystem) = 'certiport'",
                "                AND LOWER(VendorName) = 'certiport'",
                "                )",
                "            OR (",
                "                LOWER(ISNULL(VendorName, '')) <> 'certiport'",
                "                AND LOWER(SourceSystem) = 'mscert'",
                "                )",
                "            )",
                "    )",
                "SELECT DISTINCT LOWER(VendorType) AS ExamDeliveryKey",
                "    ,LOWER(CASE ",
                "        WHEN LOWER(VendorType) LIKE '%test%center%'",
                "            THEN 'Test Center'",
                "        WHEN LOWER(VendorType) LIKE '%proctored%'",
                "            AND LOWER(VendorType) NOT LIKE '%un%proctored%'",
                "            AND (",
                "                LOWER(VendorType) LIKE '%remote%'",
                "                OR LOWER(VendorType) LIKE '%online%'",
                "                )",
                "            THEN 'Online Proctored'",
                "        WHEN LOWER(VendorType) LIKE '%anywhere%proctored%'",
                "            OR LOWER(VendorType) LIKE '%anywhere%proctor%'",
                "            THEN 'Anywhere Proctored'",
                "        WHEN LOWER(VendorType) LIKE '%certiport%'",
                "            THEN 'Certiport'",
                "        ELSE 'Unknown'",
                "        END ) AS [Exam Delivery]",
                "FROM CTE_Vendors ER",
                "WHERE ISNULL(VendorType,'') <> ''",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS ExamDeliveryKey",
                "    ,'Unknown' AS [Exam Delivery]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam Offer",
        "description": "Exam Offer",
        "lineageTag": "ff0e8e9d-9484-4866-878a-333c710c7d48",
        "columns": [
          {
            "name": "ExamOfferKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ExamOfferKey",
            "isAvailableInMdx": false,
            "lineageTag": "d0cdfdc7-6455-42c5-b1a3-d4de20e7c925"
          },
          {
            "name": "OfferStartDate",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "OfferStartDate",
            "formatString": "yyyy-MM-dd",
            "isAvailableInMdx": false,
            "lineageTag": "960e091e-f631-4bbe-8624-17bb89bdeac9"
          },
          {
            "name": "Exam Offer",
            "dataType": "string",
            "description": "Exam Offer",
            "sourceColumn": "Exam Offer",
            "lineageTag": "0453e899-1a65-440d-b4df-d1a5a66cf53c"
          },
          {
            "name": "IsVoucherless",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "IsVoucherless",
            "isAvailableInMdx": false,
            "lineageTag": "c118991c-cd42-4be9-91bf-21bedceb78fd"
          },
          {
            "name": "Discount Code",
            "dataType": "string",
            "description": "Discount Code",
            "sourceColumn": "Discount Code",
            "lineageTag": "73b72809-b2df-421c-a617-963aa6f540d7"
          },
          {
            "name": "Offer Description",
            "dataType": "string",
            "description": "Offer Description",
            "sourceColumn": "Offer Description",
            "lineageTag": "89414119-dd31-4b19-af06-5b81906d806e"
          },
          {
            "name": "OfferEndDate",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "OfferEndDate",
            "formatString": "yyyy-MM-dd",
            "isAvailableInMdx": false,
            "lineageTag": "c2114d10-d2c3-4d1b-ab34-7bc489b12849"
          }
        ],
        "partitions": [
          {
            "name": "Exam Offer",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT SourceIdentifier AS ExamOfferKey",
                "    ,ISNULL(CAST(StartDate AS DATE), '1900-01-01') AS OfferStartDate",
                "    ,ISNULL(SourceIdentifier, 'Unknown') AS [Exam Offer]",
                "    ,IIF(IsVoucher = 'Yes', 'No', 'Yes') AS IsVoucherless",
                "    ,ISNULL(SourceIdentifier, 'Unknown') AS [Discount Code]",
                "    ,ISNULL([Description], 'Unknown') AS [Offer Description]",
                "    ,ISNULL(CAST(EndDate AS DATE), '1900-01-01') AS OfferEndDate",
                "FROM [Learning].Discounts",
                "WHERE [DiscountType] = 'Offer'",
                "    AND ISNULL(SourceIdentifier, 'Unknown') <> 'Unknown'",
                "",
                "UNION ALL",
                "",
                "SELECT DISTINCT [PromoName] AS ExamOfferKey",
                "    ,'1900-01-01' AS OfferStartDate",
                "    ,'Unknown' AS [Exam Offer]",
                "    ,'No' AS IsVoucherless",
                "    ,EP.[PromoName] AS [Discount Code]",
                "    ,'Unknown' AS [Offer Description]",
                "    ,'1900-01-01' AS OfferEndDate",
                "FROM [Learning].[ExamParticipation] EP",
                "LEFT JOIN (",
                "    SELECT DISTINCT SourceIdentifier",
                "    FROM [Learning].Discounts",
                "    WHERE [DiscountType] = 'Offer'",
                "    ) BB ON BB.SourceIdentifier = EP.PromoName",
                "WHERE BB.SourceIdentifier IS NULL",
                "    AND ISNULL([PromoName], '') <> ''",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS ExamOfferKey",
                "    ,'1900-01-01' AS OfferStartDate",
                "    ,'Unknown' AS [Exam Offer]",
                "    ,'Unknown' AS IsVoucherless",
                "    ,'Unknown' AS [Discount Code]",
                "    ,'Unknown' AS [Offer Description]",
                "    ,'1900-01-01' AS OfferEndDate",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam Status",
        "description": "Exam Status",
        "lineageTag": "662cabd0-de85-4934-8328-d6c3c58ad9ec",
        "columns": [
          {
            "name": "Exam Status",
            "dataType": "string",
            "description": "Exam Status",
            "sourceColumn": "Exam Status",
            "lineageTag": "fae235a6-ee59-46e6-a065-e658a90b1c20"
          },
          {
            "name": "ExamStatusKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ExamStatusKey",
            "isAvailableInMdx": false,
            "lineageTag": "201a042b-8e80-4642-8558-ccbbfa2ff7a7"
          }
        ],
        "partitions": [
          {
            "name": "Exam Status",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT CASE ",
                "        WHEN ExamStatus IN (",
                "                'PASS'",
                "                ,'Passed'",
                "                )",
                "            THEN 'Passed'",
                "        WHEN ExamStatus IN (",
                "                'Failed'",
                "                ,'FAIL'",
                "                )",
                "            THEN 'Failed'",
                "        WHEN ExamStatus IN (",
                "                'INCO'",
                "                ,'Refused NDA'",
                "                ,'Ungraded'",
                "                )",
                "            THEN ExamStatus",
                "        ELSE 'Unknown'",
                "        END AS [Exam Status]",
                "    ,ExamStatus AS [ExamStatusKey]",
                "FROM [Learning].[ExamParticipation]",
                "WHERE ExamStatus IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT 'No Show' AS [Exam Status]",
                "    ,'No Show' AS [ExamStatusKey]",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [Exam Status]",
                "    ,'Unknown' AS [ExamStatusKey]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Fact Certification",
        "isHidden": true,
        "lineageTag": "05ed2ae0-95fb-4659-97b9-1347a73a0480",
        "columns": [
          {
            "name": "CertificationKey",
            "dataType": "string",
            "description": "CertificationKey",
            "isHidden": true,
            "sourceColumn": "CertificationKey",
            "isAvailableInMdx": false,
            "lineageTag": "d9be6e84-4449-479b-872f-5ae043dbfee1"
          },
          {
            "name": "UserKey",
            "dataType": "string",
            "description": "UserKey",
            "isHidden": true,
            "sourceColumn": "UserKey",
            "isAvailableInMdx": false,
            "lineageTag": "e5d6c931-942a-41a7-8136-c269f73607ef"
          },
          {
            "name": "CertificationRenewalDateKey",
            "dataType": "string",
            "description": "CertificationRenewalDateKey",
            "isHidden": true,
            "sourceColumn": "CertificationRenewalDateKey",
            "isAvailableInMdx": false,
            "lineageTag": "e8080fd6-32ae-4360-acef-7c0ad05571aa"
          },
          {
            "name": "StayCurrentEligibleCount",
            "dataType": "int64",
            "description": "StayCurrentEligibleCount",
            "isHidden": true,
            "sourceColumn": "StayCurrentEligibleCount",
            "isAvailableInMdx": false,
            "lineageTag": "df885cd9-e982-41d7-b462-ae3ceb67c893"
          },
          {
            "name": "UserProfileGeographyKey",
            "dataType": "string",
            "description": "UserProfileGeographyKey",
            "isHidden": true,
            "sourceColumn": "UserProfileGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "f76ff997-754e-4e26-8ec5-68e3ea6e2a47"
          },
          {
            "name": "CertificationExpirationKey",
            "dataType": "string",
            "description": "CertificationExpirationKey",
            "isHidden": true,
            "sourceColumn": "CertificationExpirationKey",
            "isAvailableInMdx": false,
            "lineageTag": "37da22e9-34f4-4169-a284-9c83f9ece88c"
          },
          {
            "name": "CertificationRenewalCount",
            "dataType": "int64",
            "description": "CertificationRenewalCount",
            "isHidden": true,
            "sourceColumn": "CertificationRenewalCount",
            "isAvailableInMdx": false,
            "lineageTag": "2617f7cb-5803-4644-9e8e-d96483ff62ce"
          },
          {
            "name": "NewRoleBasedCertifications",
            "dataType": "int64",
            "description": "NewRoleBasedCertifications",
            "isHidden": true,
            "sourceColumn": "NewRoleBasedCertifications",
            "isAvailableInMdx": false,
            "lineageTag": "9380f660-786b-4d71-af5c-94cd6157b01c"
          },
          {
            "name": "PreviousExpirationDatekey",
            "dataType": "int64",
            "description": "PreviousExpirationDatekey",
            "isHidden": true,
            "sourceColumn": "PreviousExpirationDatekey",
            "isAvailableInMdx": false,
            "lineageTag": "184b93ed-6451-4c84-8d9e-28e57fbe614a"
          },
          {
            "name": "Is Migrated Certification",
            "dataType": "string",
            "description": "Is Migrated Certification",
            "isHidden": true,
            "sourceColumn": "Is Migrated Certification",
            "isAvailableInMdx": false,
            "lineageTag": "dc0be199-809f-468e-b5ff-7b200b941aa9"
          },
          {
            "name": "AchievementEndDateKey",
            "dataType": "int64",
            "description": "AchievementEndDateKey",
            "isHidden": true,
            "sourceColumn": "AchievementEndDateKey",
            "isAvailableInMdx": false,
            "lineageTag": "e0573ad7-67ab-43d7-baf0-8ffc03815965"
          },
          {
            "name": "FundamentalCertificationsEarned",
            "dataType": "int64",
            "description": "FundamentalCertificationsEarned",
            "isHidden": true,
            "sourceColumn": "FundamentalCertificationsEarned",
            "isAvailableInMdx": false,
            "lineageTag": "b43330a0-8283-4912-870b-3bef04327aff"
          },
          {
            "name": "DateKey",
            "dataType": "int64",
            "description": "DateKey",
            "isHidden": true,
            "sourceColumn": "DateKey",
            "isAvailableInMdx": false,
            "lineageTag": "6ccec4ed-8049-4ea9-9cd2-0808220a9b09"
          },
          {
            "name": "Renewed This Cycle",
            "dataType": "int64",
            "description": "Renewed This Cycle",
            "isHidden": true,
            "sourceColumn": "RenewedCertification",
            "isAvailableInMdx": false,
            "lineageTag": "47feb07a-3d84-431a-ab63-ae2c28595eef"
          },
          {
            "name": "StayCurrentEligibilityEndDateKey",
            "dataType": "int64",
            "description": "StayCurrentEligibilityEndDateKey",
            "isHidden": true,
            "sourceColumn": "StayCurrentEligibilityEndDateKey",
            "isAvailableInMdx": false
          },
          {
            "name": "StayCurrentEligibilityStartDateKey",
            "dataType": "int64",
            "description": "StayCurrentEligibilityStartDateKey",
            "isHidden": true,
            "sourceColumn": "StayCurrentEligibilityStartDateKey",
            "isAvailableInMdx": false
          },
          {
            "name": "LearnerCertificationsID",
            "dataType": "string",
            "description": "LearnerCertificationsID",
            "isHidden": true,
            "sourceColumn": "LearnerCertificationsID",
            "lineageTag": "54d70192-1d65-49ae-9d97-e6ca55e37d8e"
          },
          {
            "name": "FirstEarnedCert",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "FirstEarnedCert",
            "lineageTag": "3f63bc0b-58da-4018-b232-ff15ab214dc5"
          },
          {
            "name": "Current Date + 180 Days",
            "dataType": "int64",
            "description": "Current Date + 180 Days",
            "isHidden": true,
            "sourceColumn": "CurrentDatePlus180Days",
            "isAvailableInMdx": false,
            "lineageTag": "f99de1b4-e5c4-472d-a10a-c69aed0da39e"
          },
          {
            "name": "Adv/FundNetNewLearner",
            "dataType": "int64",
            "description": "AchievementEndDateKey",
            "isHidden": true,
            "sourceColumn": "Adv/FundNetNewLearner",
            "isAvailableInMdx": false,
            "lineageTag": "9715befb-2bd1-4fdf-a619-43bd64799fb0"
          },
          {
            "name": "WithTypeNetNewLearner",
            "dataType": "int64",
            "description": "UserProfileGeographyKey",
            "isHidden": true,
            "sourceColumn": "WithTypeNetNewLearner",
            "isAvailableInMdx": false,
            "lineageTag": "64ed3328-9db8-4fc2-83d5-79a4b0569a8f"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "sourceColumn": "PersonID",
            "lineageTag": "06af89ba-5c7a-4b80-953f-3785a5a632c1"
          },
          {
            "name": "CertificationExpirationCount",
            "dataType": "int64",
            "sourceColumn": "CertificationExpirationCount",
            "lineageTag": "fa242339-ef8c-45d6-977f-c3be47f3cf88"
          }
        ],
        "partitions": [
          {
            "name": "Fact Certification",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "WITH CTE_LearnerCertifications",
                "AS (",
                "    SELECT coalesce(DATEADD(YEAR, 1, CAST(LCR.ExpirationDate AS DATE)), CAST(LC.ExpirationDate AS DATE)) AS ExpirationDate",
                "        ,LC.CertificationID",
                "        ,LC.LearnerCertificationsID",
                "        ,LC.PersonDetailsID",
                "        ,LC.PersonID",
                "        ,LC.EffectiveDate",
                "        ,coalesce(LCR.RenewalDate, LC.RenewalDate) AS RenewalDate",
                "        ,LC.EtlUpdateDateTime",
                "        ,C.TransitionedCert",
                "    FROM Learning.LearnerCertifications LC",
                "    INNER JOIN Learning.Certifications C ON LC.CertificationID = C.CertificationID",
                "        AND CAST(LC.EffectiveDate AS DATE) >= '2018-07-01'",
                "    LEFT JOIN Learning.LearnerCertificationRenewals LCR ON LCR.PersonDetailsID = LC.PersonDetailsID",
                "        AND LCR.CertificationID = LC.CertificationID",
                "        AND CAST(coalesce(LCR.RenewalDate, LC.RenewalDate) AS DATE) BETWEEN coalesce(DATEADD(YEAR, - 1, CAST(LCR.ExpirationDate AS DATE)), DATEADD(YEAR, - 2, CAST(LC.ExpirationDate AS DATE)))",
                "            AND coalesce(CAST(LCR.ExpirationDate AS DATE), DATEADD(YEAR, - 1, CAST(LC.ExpirationDate AS DATE)))",
                "    )",
                "    ,CTE_MigratedCert",
                "AS (",
                "    --Migrated Certs info",
                "    SELECT DISTINCT OLD.PersonDetailsID",
                "        ,OLD.CertificationID AS OldCertificationID",
                "        ,OLD.TransitionedCert AS NewCertificationID",
                "        ,OLD.ExpirationDate AS OldExpirationDate",
                "        ,NEW.ExpirationDate AS NewExpirationDate",
                "    FROM CTE_LearnerCertifications OLD",
                "    INNER JOIN CTE_LearnerCertifications NEW ON OLD.TransitionedCert = NEW.CertificationID",
                "        AND OLD.PersonDetailsID = NEW.PersonDetailsID",
                "        AND OLD.ExpirationDate = NEW.ExpirationDate",
                "        AND OLD.TransitionedCert IS NOT NULL",
                "    )",
                "--    ,CTE_SFD",
                "--AS (",
                "--    SELECT DomainName",
                "--        ,A.TPID",
                "--    FROM [Operations].[SafelistedDomains] SFD",
                "--    INNER JOIN Learning.Accounts A ON A.AccountID = CAST(SFD.TPID AS NVARCHAR(250))",
                "--        AND A.TPID = SFD.TPID",
                "--    )",
                "SELECT ",
                "    ISNULL(LC.PersonDetailsID, 'Unknown') AS UserKey,",
                "ISNULL(LC.PersonID, 'Unknown') AS PersonID,",
                "    CONVERT(INT, FORMAT(DATEADD(DAY, 180, GETDATE()), 'yyyyMMdd')) AS [CurrentDatePlus180Days],",
                "    ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), LC.EffectiveDate, 112)), 19000101) AS DateKey,",
                "    ISNULL(CAST(LC.CertificationID AS NVARCHAR(255)), 'Unknown') AS CertificationKey,",
                "    ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), LC.RenewalDate, 112)), 19000101) AS CertificationRenewalDateKey,",
                "    ISNULL(LC.LearnerCertificationsID, -1) AS LearnerCertificationsID,",
                "",
                "    CASE ",
                "        WHEN DENSE_RANK() OVER (PARTITION BY LC.PersonDetailsID ORDER BY LC.EffectiveDate) = 1 THEN 1",
                "        ELSE 0",
                "    END AS FirstEarnedCert,",
                "",
                "    CASE ",
                "        WHEN CAST(LC.EtlUpdateDateTime AS DATE) BETWEEN DATEADD(DAY, -180, CAST(ISNULL(LC.ExpirationDate, '2200-12-31') AS DATE))",
                "            AND CAST(ISNULL(LC.ExpirationDate, '2200-12-31') AS DATE)",
                "            AND LOWER(C.IsStayCurrent) = 'yes'",
                "            AND MR.IsCurrent = 1 THEN 1",
                "        ELSE 0",
                "    END AS StayCurrentEligibleCount,",
                "",
                "    CASE ",
                "        WHEN CAST(LC.ExpirationDate AS DATE) >= CAST(LC.EtlUpdateDateTime AS DATE)",
                "            AND LC.RenewalDate IS NOT NULL THEN 1",
                "        ELSE 0",
                "    END AS RenewedCertification,",
                "",
                "    ISNULL(G.GeographyID, 'Unknown') AS UserProfileGeographyKey,",
                "",
                "    ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), LC.ExpirationDate, 112)), 19000101) AS CertificationExpirationKey,",
                "",
                "    CASE ",
                "        WHEN LC.RenewalDate IS NOT NULL THEN 1",
                "        ELSE 0",
                "    END AS CertificationRenewalCount,",
                "",
                "    CASE ",
                "        WHEN (",
                "                LC.ExpirationDate IS NOT NULL",
                "                AND LOWER(C.IsStayCurrent) = 'yes'",
                "                AND MR.IsCurrent = 1",
                "                AND CAST(LC.ExpirationDate AS DATE) < CAST(LC.EtlUpdateDateTime AS DATE)",
                "            )",
                "            OR (",
                "                C.TransitionedCert IS NOT NULL",
                "                AND MC.NewCertificationID IS NULL",
                "                AND CAST(LC.ExpirationDate AS DATE) <= '2021-08-15'",
                "                AND MR.IsCurrent = 1",
                "            ) THEN 1",
                "        ELSE 0",
                "    END AS CertificationExpirationCount,",
                "",
                "    CASE ",
                "        WHEN LOWER(C.[Description]) NOT LIKE '%fundamentals%'",
                "            AND LOWER(C.IsRoleBased) = 'yes'",
                "            AND CAST(LC.EffectiveDate AS DATE) BETWEEN DATEADD(DAY, -180, CAST(LC.EtlUpdateDateTime AS DATE))",
                "            AND CAST(LC.EtlUpdateDateTime AS DATE)",
                "            AND LC.RenewalDate IS NULL THEN 1",
                "        ELSE 0",
                "    END AS NewRoleBasedCertifications,",
                "",
                "    ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), DATEADD(YEAR, -1, CAST(LC.ExpirationDate AS DATE)), 112)), 19000101) AS PreviousExpirationDatekey,",
                "",
                "    CASE ",
                "        WHEN MC.NewCertificationID IS NOT NULL THEN 'Yes'",
                "        ELSE 'No'",
                "    END AS [Is Migrated Certification],",
                "",
                "    ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), LC.ExpirationDate, 112)), 19000101) AS AchievementEndDateKey,",
                "",
                "    CASE ",
                "        WHEN LOWER(C.[Description]) LIKE '%fundamentals%'",
                "            AND LOWER(C.IsRoleBased) = 'yes' THEN 1",
                "        ELSE 0",
                "    END AS FundamentalCertificationsEarned,",
                "",
                "    CASE ",
                "        WHEN CAST(LC.EtlUpdateDateTime AS DATE) BETWEEN DATEADD(DAY, -180, CAST(ISNULL(LC.ExpirationDate, '2200-12-31') AS DATE))",
                "            AND CAST(ISNULL(LC.ExpirationDate, '2200-12-31') AS DATE)",
                "            AND LOWER(C.IsStayCurrent) = 'yes'",
                "            AND MR.IsCurrent = 1 THEN ISNULL(CONVERT(INT, CONVERT(NVARCHAR, DATEADD(DAY, -180, CAST(ISNULL(LC.ExpirationDate, '2200-12-31') AS DATE)), 112)), 19000101)",
                "        ELSE 19000101",
                "    END AS [StayCurrentEligibilityStartDateKey],",
                "",
                "    CASE ",
                "        WHEN LOWER(C.IsStayCurrent) = 'yes'",
                "            AND MR.IsCurrent = 1 THEN ISNULL(CONVERT(INT, CONVERT(NVARCHAR, LC.[ExpirationDate], 112)), 19000101)",
                "        ELSE 19000101",
                "    END AS [StayCurrentEligibilityEndDateKey],",
                "",
                "    --COALESCE(A.AccountID, A1.AccountID, '-1') AS AccountID,",
                "",
                "    CASE ",
                "        WHEN ROW_NUMBER() OVER (",
                "            PARTITION BY LC.PersonDetailsID, LOWER(C.CertificationType)",
                "            ORDER BY LC.EffectiveDate ASC, ISNULL(CONVERT(DATE, LC.EffectiveDate), '1900-01-01')",
                "        ) = 1",
                "            AND LOWER(C.CertificationType) IN ('role-based', 'specialty', 'fundamentals') THEN 1",
                "        ELSE 0",
                "    END AS [Adv/FundNetNewLearner],",
                "",
                "    CASE ",
                "        WHEN ROW_NUMBER() OVER (",
                "            PARTITION BY LC.PersonDetailsID, LOWER(C.CertificationType)",
                "            ORDER BY LC.EffectiveDate ASC, ISNULL(CONVERT(DATE, LC.EffectiveDate), '1900-01-01')",
                "        ) = 1 THEN 1",
                "        ELSE 0",
                "    END AS [WithTypeNetNewLearner]",
                "    -- ,CASE ",
                "        -- WHEN PD.PersonDetailsID IS NULL",
                "            -- THEN '-1'",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BPA.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BO.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BO.BridgeOldCertLinkID",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A1.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- PD.PersonDetailsID",
                "                    -- ,CDES.[BridgePersonCDESAccountID]",
                "                    -- )",
                "        -- ELSE CONCAT (",
                "                -- 'PD'",
                "                -- ,PD.PersonDetailsID",
                "                -- )",
                "        -- END AS PersonAccountID",
                "FROM CTE_LearnerCertifications LC",
                "LEFT JOIN Learning.Certifications C ON LC.CertificationID = C.CertificationID",
                "LEFT JOIN CTE_MigratedCert MC ON LC.PersonDetailsID = MC.PersonDetailsID",
                "    AND MC.OldCertificationID = LC.CertificationID",
                " LEFT JOIN [Learning].[PersonDetails] PD ON PD.PersonDetailsID = LC.PersonDetailsID",
                "     AND PD.SourceSystem = 'Learn'",
                "-- LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.SourceSystem = 'Learn'",
                "-- LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.PersonDetailsID IS NULL",
                "    -- AND BO.PersonEmailDomain IS NOT NULL",
                "--LEFT JOIN CTE_SFD SFD ON SFD.DomainName = COALESCE(BPA.PersonEmailDomain, BO.PersonEmailDomain)",
                "-- LEFT JOIN Learning.Accounts A ON A.AccountID = COALESCE(CAST(SFD.TPID AS NVARCHAR(250)), BPA.AccountID)",
                "    -- AND A.TPID IS NOT NULL",
                "-- LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PD.PersonID",
                "    -- AND CDES.SourceSystem = 'Learn'",
                "    -- AND A.AccountID IS NULL",
                "-- LEFT JOIN Learning.Accounts A1 ON A1.AccountID = CASt(CDES.AccountID AS NVARCHAR(250))",
                "    -- AND A1.TPID IS NOT NULL",
                "LEFT JOIN Learning.Geographies G ON G.GeographyID = PD.GeographyID",
                " LEFT JOIN (",
                "     SELECT LearnerCertificationsID",
                "         ,MAX(CAST(LC.ExpirationDate AS DATE)) AS ExpirationDate",
                "         ,1 AS IsCurrent",
                "     FROM Learning.LearnerCertifications LC",
                "     WHERE LC.ExpirationDate IS NOT NULL",
                "     GROUP BY LearnerCertificationsID",
                "     ) MR ON MR.LearnerCertificationsID = LC.LearnerCertificationsID",
                "     AND LC.ExpirationDate = MR.ExpirationDate",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Fact Certiport VLUtilization",
        "description": "Fact Certiport VLUtilization",
        "isHidden": true,
        "lineageTag": "2fae0b7f-5f57-41dd-877d-0b79df1c355e",
        "columns": [
          {
            "name": "Licenses Fulfilled",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Licenses Fulfilled",
            "isAvailableInMdx": false,
            "lineageTag": "ed381e66-1ba4-44bb-adee-56409d70d5d3"
          },
          {
            "name": "Licenses Assigned",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Licenses Assigned",
            "isAvailableInMdx": false,
            "lineageTag": "6a208f79-175f-4284-8498-c1a60dae379d"
          },
          {
            "name": "Licenses Activated",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Licenses Activated",
            "isAvailableInMdx": false,
            "lineageTag": "4bd732f3-2a2b-4b0f-971b-92d82fa680e2"
          },
          {
            "name": "Licenses Expired",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Licenses Expired",
            "isAvailableInMdx": false,
            "lineageTag": "32ac08e4-7322-45ae-95c2-0b7c230e0159"
          },
          {
            "name": "Exams Fulfilled",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Exams Fulfilled",
            "isAvailableInMdx": false,
            "lineageTag": "8c05c4c8-d3d5-45bc-93ce-9c65a51b929c"
          },
          {
            "name": "Exams Uploaded",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Exams Uploaded",
            "isAvailableInMdx": false,
            "lineageTag": "434a3af9-7aa2-4220-9e82-6c639e507d60"
          },
          {
            "name": "Exams Expired",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Exams Expired",
            "isAvailableInMdx": false,
            "lineageTag": "7f2daa2e-fd4d-4717-be28-06246b8e061c"
          },
          {
            "name": "Exams Available",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Exams Available",
            "isAvailableInMdx": false,
            "lineageTag": "4fa0ba36-2ad4-4e28-9930-eb1d36914704"
          },
          {
            "name": "DatePurchased_PK",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "DatePurchased_PK",
            "formatString": "yyyy-MM-dd",
            "isAvailableInMdx": false,
            "lineageTag": "43f80ace-9173-4449-9452-b4450411e1b5"
          },
          {
            "name": "EventDate_PK",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "EventDate_PK",
            "formatString": "yyyy-MM-dd",
            "isAvailableInMdx": false,
            "lineageTag": "2dd4cef3-7a45-4dbf-a10d-17ed73e915d6"
          },
          {
            "name": "VLUtilization_PK",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "VLUtilization_PK",
            "isAvailableInMdx": false,
            "lineageTag": "42c033eb-d884-4eb7-b602-d0101a34f099"
          },
          {
            "name": "Product_PK",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Product_PK",
            "isAvailableInMdx": false,
            "lineageTag": "06d268b6-9ec5-4e8b-9daf-4071eda5fc1e"
          }
        ],
        "partitions": [
          {
            "name": "Fact Certiport VLUtilization",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT LicensesFulfilled AS [Licenses Fulfilled]",
                "    ,LicensesAssigned AS [Licenses Assigned]",
                "    ,CASE ",
                "        WHEN IsLicensesActivated = 'Yes' THEN 1",
                "        ELSE 0",
                "     END AS [Licenses Activated]",
                "    ,CASE ",
                "        WHEN IsLicensesExpired = 'Yes' THEN 1",
                "        ELSE 0",
                "     END AS [Licenses Expired]",
                "    ,ExamsFulfilled AS [Exams Fulfilled]",
                "    ,CASE ",
                "        WHEN IsExamsUploaded = 'Yes' THEN 1",
                "        ELSE 0",
                "     END AS [Exams Uploaded]",
                "    ,ExamsExpired AS [Exams Expired]",
                "    ,ExamsAvailable AS [Exams Available]",
                "    ,ISNULL(CAST(DatePurchased AS DATE), '1900-01-01') AS [DatePurchased_PK]",
                "    ,ISNULL(CAST(EventDate AS DATE), '1900-01-01') AS [EventDate_PK]",
                "    ,ISNULL(CAST(VLUtilization AS VARCHAR), 'Unknown') AS [VLUtilization_PK]",
                "    ,ISNULL(CAST(CertiportProductID AS VARCHAR), 'Unknown') AS [Product_PK]",
                "FROM Learning.CertiportUtilizations",
                "WHERE CAST(DatePurchased AS DATE) >= '2020-07-01'",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "Certiport Exams Avaiable",
            "description": "This calculation is summing up the total number of exams available from the Fact Certiport VLUtilization table. This could be used to measure the total number of exams available for a certain period of time or across multiple locations.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Exams Available] )",
            "formatString": "#,0",
            "isHidden": true
          },
          {
            "name": "Certiport Exams Expired",
            "description": "This calculation is summing up the number of exams that have expired in the Fact Certiport VLUtilization table. This is useful for tracking the total number of expired exams in order to understand the usage of the Certiport platform.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Exams Expired] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Exams Fulfilled",
            "description": "This calculation is used to sum up the total number of exams fulfilled from the Fact Certiport VLUtilization table. This calculation can be used to get an overall picture of the total number of exams fulfilled by a company.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Exams Fulfilled] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Exams Uploaded",
            "description": "This calculation is summing up the total number of exams uploaded in the Fact Certiport VLUtilization table. This is useful for understanding the total number of exams that have been uploaded to the system.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Exams Uploaded] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Licenses Activated",
            "description": "This calculation is adding up the total number of licenses activated in the 'Fact Certiport VLUtilization' table. This could be used to determine the total number of licenses activated across a given period of time, such as a month or a year.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Licenses Activated] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Licenses Assigned",
            "description": "This calculation is summing up the total number of licenses assigned from the \"Fact Certiport VLUtilization\" table. This is useful for understanding the total number of licenses assigned and can be used to measure the utilization of licenses.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Licenses Assigned] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Licenses Expired",
            "description": "This calculation is adding up the total number of expired licenses from the Fact Certiport VLUtilization table. This number can be used to measure the total number of expired licenses in a given period of time.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Licenses Expired] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Licenses Fulfilled",
            "description": "This calculation is used to sum up the total number of licenses fulfilled from the Fact Certiport VLUtilization table. This calculation is useful for understanding the total number of licenses fulfilled in a given period of time.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Licenses Fulfilled] )",
            "formatString": "#,0"
          },
          {
            "name": "Certiport Exams Available",
            "description": "This calculation is summing up the number of exams available in the Fact Certiport VLUtilization table. This number represents the total number of exams available for use.",
            "expression": "SUM ( 'Fact Certiport VLUtilization'[Exams Available] )",
            "formatString": "#,0"
          }
        ]
      },
      {
        "name": "Fact Exam",
        "isHidden": true,
        "lineageTag": "498824ff-c622-460e-adc2-2e011b69ce4c",
        "columns": [
          {
            "name": "ExamKey",
            "dataType": "string",
            "description": "ExamKey",
            "isHidden": true,
            "sourceColumn": "ExamKey",
            "isAvailableInMdx": false,
            "lineageTag": "ed381e66-1ba4-44bb-adee-56409d70d5d3"
          },
          {
            "name": "EventKey",
            "dataType": "string",
            "description": "EventKey",
            "isHidden": true,
            "sourceColumn": "EventKey",
            "isAvailableInMdx": false,
            "lineageTag": "fd08dc7b-f33c-4a87-9c69-5babde2782fb"
          },
          {
            "name": "TestCenterKey",
            "dataType": "string",
            "description": "TestCenterKey",
            "isHidden": true,
            "sourceColumn": "TestCenterKey",
            "isAvailableInMdx": false,
            "lineageTag": "6a208f79-175f-4284-8498-c1a60dae379d"
          },
          {
            "name": "UserKey",
            "dataType": "string",
            "description": "UserKey",
            "isHidden": true,
            "sourceColumn": "UserKey",
            "isAvailableInMdx": false,
            "lineageTag": "4bd732f3-2a2b-4b0f-971b-92d82fa680e2"
          },
          {
            "name": "TestCenterGeographyKey",
            "dataType": "string",
            "description": "TestCenterGeographyKey",
            "isHidden": true,
            "sourceColumn": "TestCenterGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "32ac08e4-7322-45ae-95c2-0b7c230e0159"
          },
          {
            "name": "ExamStatusKey",
            "dataType": "string",
            "description": "ExamStatusKey",
            "isHidden": true,
            "sourceColumn": "ExamStatusKey",
            "isAvailableInMdx": false,
            "lineageTag": "a51347c0-273f-4f6a-bd10-b0f29f09cd95"
          },
          {
            "name": "ExamVendorKey",
            "dataType": "string",
            "description": "ExamVendorKey",
            "isHidden": true,
            "sourceColumn": "ExamVendorKey",
            "isAvailableInMdx": false,
            "lineageTag": "5fb45bf6-3d48-4e0e-886d-d12201eac8e3"
          },
          {
            "name": "LanguageKey",
            "dataType": "string",
            "description": "LanguageKey",
            "isHidden": true,
            "sourceColumn": "LanguageKey",
            "isAvailableInMdx": false,
            "lineageTag": "634dc9fc-b7a7-4730-83a0-0379677de7e1"
          },
          {
            "name": "ExamOfferKey",
            "dataType": "string",
            "description": "ExamOfferKey",
            "isHidden": true,
            "sourceColumn": "ExamOfferKey",
            "isAvailableInMdx": false,
            "lineageTag": "728a90b3-4d3e-44ea-a3ce-a3289b9e471b"
          },
          {
            "name": "ExamCount",
            "dataType": "int64",
            "description": "ExamCount",
            "isHidden": true,
            "sourceColumn": "ExamCount",
            "isAvailableInMdx": false,
            "lineageTag": "a26dea83-5c23-47bb-b482-6e8876cc76bf"
          },
          {
            "name": "DateKey",
            "dataType": "int64",
            "description": "DateKey",
            "isHidden": true,
            "sourceColumn": "DateKey",
            "isAvailableInMdx": false,
            "lineageTag": "d089c4fd-b50d-4842-b3f4-d09d2a088a3b"
          },
          {
            "name": "VendorKey",
            "dataType": "string",
            "description": "VendorKey",
            "isHidden": true,
            "sourceColumn": "VendorKey",
            "isAvailableInMdx": false,
            "lineageTag": "3e7a6964-00da-4f38-bf92-2a9fd4e7f581"
          },
          {
            "name": "ExamDeliveryKey",
            "dataType": "string",
            "description": "ExamDeliveryKey",
            "isHidden": true,
            "sourceColumn": "ExamDeliveryKey",
            "isAvailableInMdx": false,
            "lineageTag": "f0712ee0-0dc8-4965-8380-c48ee8b3d928"
          },
          {
            "name": "UserProfileGeographyKey",
            "dataType": "string",
            "description": "UserProfileGeographyKey",
            "isHidden": true,
            "sourceColumn": "UserProfileGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "d4740498-732b-48c4-82fc-bb7d685f3a21"
          },
          {
            "type": "calculated",
            "name": "ChannelKey",
            "dataType": "string",
            "description": "ChannelKey",
            "isHidden": true,
            "expression": [
              "IF (",
              "    RELATED ( 'Stg_Channel_Offer'[OfferChannelKey] )",
              "        <> BLANK (),",
              "    RELATED ( 'Stg_Channel_Offer'[OfferChannelKey] ),",
              "    IF (",
              "        RELATED ( 'Stg_Channel_Exams'[ExamChannelKey] )",
              "            <> BLANK (),",
              "        RELATED ( 'Stg_Channel_Exams'[ExamChannelKey] ),",
              "        \"-1\"",
              "    )",
              ")"
            ],
            "isAvailableInMdx": false,
            "lineageTag": "ebd8fbcd-b80a-49d3-a7e2-4222b3e8d09d"
          },
          {
            "name": "BetaExamCount",
            "dataType": "int64",
            "description": "BetaExamCount",
            "isHidden": true,
            "sourceColumn": "BetaExamCount",
            "isAvailableInMdx": false,
            "lineageTag": "205825b8-f159-498a-bf1e-bbaaf4bb0b60"
          },
          {
            "name": "IsBeta",
            "dataType": "string",
            "description": "IsBeta",
            "isHidden": true,
            "sourceColumn": "IsBeta",
            "isAvailableInMdx": false,
            "lineageTag": "480401b1-653c-4f2d-882b-61389a748845"
          },
          {
            "name": "ID",
            "dataType": "string",
            "description": "ID",
            "isHidden": true,
            "sourceColumn": "ID",
            "isAvailableInMdx": false,
            "lineageTag": "c4a3d56e-dec3-4dab-af91-2683a87e1736"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "sourceColumn": "PersonID",
            "lineageTag": "7454c7da-65c9-461e-8d95-05144c7afe40"
          }
        ],
        "partitions": [
          {
            "name": "Fact Exam",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "DECLARE @Date AS DATE = '2018-07-01';",
                "WITH CTE_ExamPartcipation",
                "AS (",
                "    SELECT ISNULL(E.ExamID, 'Unknown') AS ExamID",
                "        ,ExamCompletionDate",
                "        ,PersonDetailsID",
                "        ,VendorName",
                "        ,EP.ExamStatus",
                "        ,EP.ExamNumber",
                "        ,DeliveryType",
                "        ,[Language]",
                "        ,EP.IsBeta",
                "        ,EP.SourceSystem",
                "        ,ExamRegistrationID",
                "        ,ExamParticipationID",
                "        ,PromoName",
                "        ,EventID",
                "        ,TestCenterID",
                "        ,PersonID",
                "    FROM Learning.ExamParticipation EP",
                "    LEFT JOIN Learning.Exams E ON E.ExamID = EP.ExamID",
                "    WHERE (",
                "            (",
                "                LOWER(EP.SourceSystem) = 'certiport'",
                "                AND LOWER(VendorName) = 'certiport'",
                "                )",
                "            OR (",
                "                LOWER(ISNULL(VendorName, '')) <> 'certiport'",
                "                AND LOWER(EP.SourceSystem) = 'mscert'",
                "                )",
                "            )",
                "        -- AND EP.IsBeta <> 1",
                "        AND CAST(ExamCompletionDate AS DATE) >= @Date",
                "    )",
                "    ,CTE_ExamRegistrations_NoShow",
                "AS (",
                "    SELECT ExamID",
                "        ,ExamDate",
                "        ,PersonDetailsID",
                "        ,VendorName",
                "        ,ExamNumber",
                "        ,SourceSystem",
                "        ,ExamOffer",
                "        ,VendorType",
                "        ,ER.IsBeta",
                "        ,ER.ExamRegistrationID",
                "        ,ER.PersonID",
                "        ,ER.TestCenter",
                "    FROM Learning.ExamRegistrations ER",
                "    LEFT JOIN (",
                "        SELECT DISTINCT EP.ExamRegistrationID",
                "        FROM Learning.ExamParticipation EP",
                "        ) EP1 ON ER.ExamRegistrationID = EP1.ExamRegistrationID",
                "    WHERE (",
                "            (",
                "                LOWER(ER.SourceSystem) = 'certiport'",
                "                AND LOWER(ER.VendorName) = 'certiport'",
                "                )",
                "            OR (",
                "                LOWER(ISNULL(ER.VendorName, '')) <> 'certiport'",
                "                AND LOWER(ER.SourceSystem) = 'mscert'",
                "                )",
                "            )",
                "        AND CAST(ER.ExamDate AS DATE) >= @Date",
                "        AND EP1.ExamRegistrationID IS NULL",
                "        AND ER.[RegistrationStatus] IN (",
                "            'NoShow'",
                "            ,'Expired'",
                "            )",
                "        AND ER.IsBeta <> 'Yes'",
                "    )",
                "    ,CTE_Events",
                "AS (",
                "    SELECT EventID",
                "        ,[Name] AS [EventName]",
                "        ,PrimaryEventName",
                "    FROM [Learning].[Events]",
                "    WHERE LOWER(SourceSystem) = 'mscert'",
                "        AND LOWER(PrimaryEventName) <> 'microsofttrainingday'",
                "    )",
                "    ,CTE_ExamOffer",
                "AS (",
                "    SELECT SourceIdentifier AS ExamOfferKey",
                "    FROM [Learning].Discounts",
                "    WHERE LOWER([DiscountType]) = 'offer'",
                "        AND ISNULL(SourceIdentifier, 'Unknown') <> 'Unknown'",
                "    ",
                "    UNION",
                "    ",
                "    SELECT [PromoName] AS ExamOfferKey",
                "    FROM [Learning].[ExamParticipation] EP",
                "    LEFT JOIN (",
                "        SELECT DISTINCT SourceIdentifier",
                "        FROM [Learning].Discounts",
                "        WHERE LOWER([DiscountType]) = 'offer'",
                "        ) BB ON BB.SourceIdentifier = EP.PromoName",
                "    WHERE BB.SourceIdentifier IS NULL",
                "        AND [PromoName] IS NOT NULL",
                "    )",
                "    ,CTE_TestCenter",
                "AS (",
                "    SELECT ROW_NUMBER() OVER (",
                "            PARTITION BY TestCenterName ORDER BY TestCenterName",
                "            ) row_num",
                "        ,TestCenterName",
                "        ,GeographyID",
                "        ,TestCenterID",
                "    FROM Learning.TestCenters",
                "    )",
                "    -- ,CTE_SFD",
                "-- AS (",
                "    -- SELECT DomainName",
                "        -- ,A.TPID",
                "    -- FROM [Operations].[SafelistedDomains] SFD",
                "    -- INNER JOIN Learning.Accounts A ON A.AccountID = CAST(SFD.TPID AS NVARCHAR(250))",
                "        -- AND A.TPID = SFD.TPID",
                "    -- )",
                "SELECT ISNULL(EP.ExamID, 'Unknown') AS ExamKey",
                "    ,ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), CAST(EP.ExamCompletionDate AS DATE), 112)), 19000101) AS DateKey",
                "    ,ISNULL(E.EventID, 'Unknown') AS EventKey",
                "    ,ISNULL(EP.PersonDetailsID, 'Unknown') AS UserKey",
                "    ,ISNULL(EP.PersonID, 'Unknown') AS PersonID",
                "    ,ISNULL(CAST(TC.TestCenterID AS NVARCHAR(255)), 'Unknown') AS TestCenterKey",
                "    ,ISNULL(TG.GeographyID, 'Unknown') AS TestCenterGeographyKey",
                "    ,COALESCE(NULLIF(EP.VendorName, ''), 'Unknown') AS VendorKey",
                "    ,IIF(LOWER(EP.ExamStatus) = 'p', 'Passed', ISNULL(EP.ExamStatus, 'Unknown')) AS ExamStatusKey",
                "    ,CONCAT (",
                "        ISNULL(Lower(EP.ExamNumber), 'unknown')",
                "        ,' - '",
                "        ,IIF(LOWER(EP.VendorName) = 'pearsonvue', 'pvue', ISNULL(Lower(EP.VendorName), 'unknown'))",
                "        ) AS ExamVendorKey",
                "    ,ISNULL(IIF(LOWER(EP.VendorName) = 'certiport', 'Certiport', EP.DeliveryType), 'Unknown') AS ExamDeliveryKey",
                "    ,ISNULL(EP.[Language], 'Unknown') AS LanguageKey",
                "    ,EP.IsBeta AS IsBeta",
                "   ,ISNULL(G.GeographyID, 'Unknown') AS UserProfileGeographyKey",
                "    ,ISNULL(DO.ExamOfferKey, 'Unknown') AS ExamOfferKey",
                "    ,IIF(EP.ExamParticipationID IS NOT NULL, 1, 0) AS ExamCount",
                "    ,IIF(EP.ExamParticipationID IS NOT NULL, 1, 0) AS BetaExamCount",
                "    ,EP.ExamParticipationID AS ID",
                " --   ,COALESCE(A.AccountID, A1.AccountID, '-1') AS AccountID",
                "    -- ,CASE ",
                "        -- WHEN PD.PersonDetailsID IS NULL",
                "            -- THEN '-1'",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BPA.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BO.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BO.BridgeOldCertLinkID",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A1.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- PD.PersonDetailsID",
                "                    -- ,CDES.[BridgePersonCDESAccountID]",
                "                    -- )",
                "        -- ELSE CONCAT (",
                "                -- 'PD'",
                "                -- ,PD.PersonDetailsID",
                "                -- )",
                "        -- END AS PersonAccountID",
                "FROM CTE_ExamPartcipation EP",
                "LEFT JOIN Learning.ExamRegistrations ER ON EP.ExamRegistrationID = ER.ExamRegistrationID",
                "LEFT JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = EP.PersonDetailsID",
                "     AND LOWER(PD.SourceSystem) = 'learn'",
                "-- LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.SourceSystem = 'Learn'",
                "-- LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.PersonDetailsID IS NULL",
                "    -- AND BO.PersonEmailDomain IS NOT NULL",
                "-- LEFT JOIN CTE_SFD SFD ON SFD.DomainName = COALESCE(BPA.PersonEmailDomain, BO.PersonEmailDomain)",
                "-- LEFT JOIN Learning.Accounts A ON A.AccountID = COALESCE(CAST(SFD.TPID AS NVARCHAR(250)), BPA.AccountID)",
                "    -- AND A.TPID IS NOT NULL",
                "-- LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PD.PersonID",
                "    -- AND CDES.SourceSystem = 'Learn'",
                "    -- AND A.AccountID IS NULL",
                "-- LEFT JOIN Learning.Accounts A1 ON A1.AccountID = CASt(CDES.AccountID AS NVARCHAR(250))",
                "    -- AND A1.TPID IS NOT NULL",
                "LEFT JOIN (",
                "    SELECT DISTINCT BDA.ExamParticipationID",
                "        ,D.[SourceIdentifier] AS [DiscountName]",
                "    FROM [Learning].[BridgeDiscountActivity] BDA",
                "    INNER JOIN [Learning].[Discounts] D ON D.DiscountID = BDA.DiscountID",
                "        AND LOWER(BDA.DiscountType) = 'private access code'",
                "        AND LOWER(D.DiscountType) = 'private access code'",
                "    ) CC ON EP.ExamParticipationID = CC.ExamParticipationID",
                "LEFT JOIN CTE_ExamOffer DO ON DO.ExamOfferKey = COALESCE(EP.PromoName, CC.DiscountName)",
                "LEFT JOIN CTE_Events E ON E.EventID = EP.EventID",
                "LEFT JOIN CTE_TestCenter TC ON TC.TestCenterID = EP.TestCenterID",
                "LEFT JOIN Learning.Geographies G ON G.GeographyID = PD.GeographyID",
                "LEFT JOIN Learning.Geographies TG ON TG.GeographyID = TC.GeographyID",
                "",
                "UNION ALL",
                "",
                "SELECT ISNULL(E.ExamID, 'Unknown') AS ExamKey",
                "    ,ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), CAST(ER.ExamDate AS DATE), 112)), 19000101) AS DateKey",
                "    ,'Unknown' AS EventKey",
                "    ,ISNULL(ER.PersonDetailsID, 'Unknown') AS UserKey",
                "    ,ISNULL(ER.PersonID, 'Unknown') AS PersonID",
                "    ,ISNULL(CAST(TC.TestCenterID AS NVARCHAR(255)), 'Unknown') AS TestCenterKey",
                "    ,ISNULL(TG.GeographyID, 'Unknown') AS TestCenterGeographyKey",
                "    ,COALESCE(NULLIF(ER.VendorName, ''), 'Unknown') AS VendorKey",
                "    ,'No Show' AS ExamStatusKey",
                "    ,CONCAT (",
                "        ISNULL(Lower(ER.ExamNumber), 'unknown')",
                "        ,' - '",
                "        ,IIF(LOWER(ER.VendorName) = 'pearsonvue', 'pvue', ISNULL(Lower(ER.VendorName), 'unknown'))",
                "        ) AS ExamVendorKey",
                "    ,ISNULL(ER.VendorType, 'Unknown') AS ExamDeliveryKey",
                "    ,'Unknown' AS LanguageKey",
                "    ,ER.IsBeta AS IsBeta",
                "   ,ISNULL(G.GeographyID, 'Unknown') AS UserProfileGeographyKey",
                "    ,ISNULL(DO.ExamOfferKey, 'Unknown') AS ExamOfferKey",
                "    ,1 AS ExamCount",
                "    ,0 AS BetaExamCount",
                "    ,ER.ExamRegistrationID AS ID",
                "--    ,COALESCE(A.AccountID, A1.AccountID, '-1') AS AccountID",
                "    -- ,CASE ",
                "        -- WHEN PD.PersonDetailsID IS NULL",
                "            -- THEN '-1'",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BPA.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BO.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BO.BridgeOldCertLinkID",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A1.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- PD.PersonDetailsID",
                "                    -- ,CDES.[BridgePersonCDESAccountID]",
                "                    -- )",
                "        -- ELSE CONCAT (",
                "                -- 'PD'",
                "                -- ,PD.PersonDetailsID",
                "                -- )",
                "        -- END AS PersonAccountID",
                "FROM CTE_ExamRegistrations_NoShow ER",
                "LEFT JOIN Learning.Exams E ON ER.ExamID = E.ExamID",
                " LEFT JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = ER.PersonDetailsID",
                "    AND LOWER(PD.SourceSystem) = 'learn'",
                "-- LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.SourceSystem = 'Learn'",
                "-- LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.PersonDetailsID IS NULL",
                "    -- AND BO.PersonEmailDomain IS NOT NULL",
                "-- LEFT JOIN CTE_SFD SFD ON SFD.DomainName = COALESCE(BPA.PersonEmailDomain, BO.PersonEmailDomain)",
                "-- LEFT JOIN Learning.Accounts A ON A.AccountID = COALESCE(CAST(SFD.TPID AS NVARCHAR(250)), BPA.AccountID)",
                "    -- AND A.TPID IS NOT NULL",
                "-- LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PD.PersonID",
                "    -- AND CDES.SourceSystem = 'Learn'",
                "    -- AND A.AccountID IS NULL",
                "-- LEFT JOIN Learning.Accounts A1 ON A1.AccountID = CASt(CDES.AccountID AS NVARCHAR(250))",
                "    -- AND A1.TPID IS NOT NULL",
                "LEFT JOIN CTE_ExamOffer DO ON DO.ExamOfferKey = ER.ExamOffer",
                "LEFT JOIN CTE_TestCenter TC ON TC.TestCenterName = ER.TestCenter",
                "    AND row_num = 1",
                "LEFT JOIN Learning.Geographies G ON G.GeographyID = PD.GeographyID",
                "LEFT JOIN Learning.Geographies TG ON TG.GeographyID = TC.GeographyID",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "MCT Metrics",
        "description": "MCT Metrics",
        "lineageTag": "4c436c37-12dd-47a5-acca-fad7c0e0b29e",
        "columns": [
          {
            "name": "Exam Status",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Exam Status",
            "isAvailableInMdx": false,
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "ExamStatusKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamStatusKey",
            "isAvailableInMdx": false,
            "lineageTag": "704a69d5-1bd5-45aa-8897-eea4546cd39d"
          }
        ],
        "partitions": [
          {
            "name": "MCT Metrics",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT 'Unknown' AS [Exam Status]",
                "    ,'Unknown' AS [ExamStatusKey]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "MCT Users",
            "description": "This calculation is counting the number of distinct user keys in the Fact MCT table. This is useful for understanding how many unique users are associated with the table, which can help to inform business decisions.",
            "expression": "DISTINCTCOUNT ( 'Fact MCT'[UserKey] )",
            "formatString": "#,0"
          }
        ]
      },
      {
        "name": "FTE Classification",
        "description": "FTE Classification",
        "lineageTag": "861ffde4-7daf-488a-94d9-8cfe188df363",
        "columns": [
          {
            "name": "MSUserKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "MSUserKey",
            "isAvailableInMdx": false,
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "Days In Role",
            "dataType": "string",
            "description": "Days In Role",
            "sourceColumn": "Days In Role",
            "lineageTag": "704a69d5-1bd5-45aa-8897-eea4546cd39d"
          },
          {
            "name": "User Status",
            "dataType": "string",
            "description": "User Status",
            "sourceColumn": "User Status",
            "lineageTag": "6427c61d-6ef7-4dbf-926c-a5f07b3e80b8"
          },
          {
            "name": "Tenure In Microsoft",
            "dataType": "string",
            "description": "Tenure In Microsoft",
            "sourceColumn": "Tenure In Microsoft",
            "lineageTag": "42722cad-af36-4dd2-aee1-891327599192"
          },
          {
            "name": "Tenure In Role",
            "dataType": "string",
            "description": "Tenure In Role",
            "sourceColumn": "Tenure In Role",
            "lineageTag": "6318eff3-65c1-4915-9472-da10a15b3b20"
          },
          {
            "name": "Qualifier 2",
            "dataType": "string",
            "description": "Qualifier 2",
            "sourceColumn": "Qualifier 2",
            "lineageTag": "974c5ce3-703d-4098-8077-43dd8c13038a"
          },
          {
            "name": "Qualifier 1",
            "dataType": "string",
            "description": "Qualifier 1",
            "sourceColumn": "Qualifier 1",
            "lineageTag": "56c1ffba-8722-4412-9bca-378d8fc8e985"
          },
          {
            "name": "Profession",
            "dataType": "string",
            "description": "Profession",
            "sourceColumn": "Profession",
            "lineageTag": "6109dc8c-53e9-4052-a6d1-7c1a9402e380"
          },
          {
            "name": "Discipline",
            "dataType": "string",
            "description": "Discipline",
            "sourceColumn": "Discipline",
            "lineageTag": "0f380456-664c-4904-abac-4cbd5d504ef5"
          },
          {
            "name": "Standard Title",
            "dataType": "string",
            "description": "Standard Title",
            "sourceColumn": "Standard Title",
            "lineageTag": "6bcd66f8-2236-4cf1-b447-bad599fb7602"
          },
          {
            "name": "Role",
            "dataType": "string",
            "sourceColumn": "Role",
            "lineageTag": "002c8ec2-27c4-41f1-8320-29ed9c10259d"
          },
          {
            "name": "RoleSummary",
            "dataType": "string",
            "sourceColumn": "RoleSummary",
            "lineageTag": "411020b8-4e16-49c0-a837-314d4a5d9729"
          }
        ],
        "partitions": [
          {
            "name": "FTE Classification",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "WITH CTE_MSRoleTenure",
                "AS (",
                "    SELECT PersonID",
                "        ,CASE ",
                "            WHEN T1.RoleKey >= 0",
                "                AND T1.RoleKey <= 3",
                "                THEN 'Months in Role 0-3'",
                "            WHEN T1.RoleKey >= 4",
                "                AND T1.RoleKey <= 6",
                "                THEN 'Months in Role 4-6'",
                "            WHEN T1.RoleKey >= 7",
                "                AND T1.RoleKey <= 11",
                "                THEN 'Months in Role 7-12'",
                "            WHEN T1.RoleKey >= 12",
                "                AND T1.RoleKey <= 23",
                "                THEN 'Years in Role 1-2'",
                "            WHEN T1.RoleKey >= 24",
                "                AND T1.RoleKey <= 47",
                "                THEN 'Years in Role 2-4'",
                "            WHEN T1.RoleKey >= 48",
                "                AND T1.RoleKey <= 71",
                "                THEN 'Years in Role 4-6'",
                "            WHEN T1.RoleKey >= 72",
                "                AND T1.RoleKey <= 119",
                "                THEN 'Years in Role 6-10'",
                "            WHEN T1.RoleKey >= 120",
                "                AND T1.RoleKey <= 1200",
                "                THEN 'Years in Role 10+'",
                "            END AS RoleTenure",
                "        ,CASE ",
                "            WHEN T1.Tenure >= 0",
                "                AND T1.Tenure <= 3",
                "                THEN 'Months in MS 0-3'",
                "            WHEN T1.Tenure >= 4",
                "                AND T1.Tenure <= 6",
                "                THEN 'Months in MS 4-6'",
                "            WHEN T1.Tenure >= 7",
                "                AND T1.Tenure <= 11",
                "                THEN 'Months in MS 7-12'",
                "            WHEN T1.Tenure >= 12",
                "                AND T1.Tenure <= 23",
                "                THEN 'Years in MS 1-2'",
                "            WHEN T1.Tenure >= 24",
                "                AND T1.Tenure <= 47",
                "                THEN 'Years in MS 2-4'",
                "            WHEN T1.Tenure >= 48",
                "                AND T1.Tenure <= 71",
                "                THEN 'Years in MS 4-6'",
                "            WHEN T1.Tenure >= 72",
                "                AND T1.Tenure <= 119",
                "                THEN 'Years in MS 6-10'",
                "            WHEN T1.Tenure >= 120",
                "                AND T1.Tenure <= 1200",
                "                THEN 'Years in MS 10+'",
                "            END AS MSTenure",
                "        ,T1.MSFT AS DaysInRole",
                "    FROM (",
                "        SELECT PersonID",
                "            ,DATEDIFF(MONTH, MostRecentHireDate, GETDATE()) AS Tenure",
                "            ,DATEDIFF(MONTH, PositionEntryDate, GETDATE()) AS RoleKey",
                "            ,",
                "            --DATEDIFF(MONTH, FirstRegularHireDate, GETDATE()) AS MSFT",
                "            ISNULL(DATEDIFF(DD, PositionEntryDate, GETDATE()), 0) AS MSFT",
                "        FROM [Learning].[EmployeeDetails]",
                "        ) T1",
                "    )",
                "SELECT DISTINCT ED.PersonID AS [MSUserKey]",
                "    ,MSRT.DaysInRole AS [Days In Role]",
                "    ,IIF(PersonStatusDesc IN ('NA'), 'Not Available', ISNULL(PersonStatusDesc, 'Not Available')) AS [User Status]",
                "    ,ISNULL(MSRT.MSTenure, 'Unknown') AS [Tenure In Microsoft]",
                "    ,ISNULL(MSRT.RoleTenure, 'Unknown') AS [Tenure In Role]",
                "    ,IIF(Qualifier2 = 'N/A', 'Not Available', ISNULL(Qualifier2, 'Not Available')) AS [Qualifier 2]",
                "    ,IIF(Qualifier1 = 'N/A', 'Not Available', ISNULL(Qualifier1, 'Not Available')) AS [Qualifier 1]",
                "    ,ISNULL(Profession, 'Not Available') AS [Profession]",
                "    ,ISNULL(Discipline, 'Not Available') AS [Discipline]",
                "    ,ISNULL(StandardTitle, 'Unknown') AS [Standard Title]",
                "    ,ISNULL(StandardTitle, 'Unknown') AS [Role]",
                "    ,ISNULL(RoleSummary, 'Unknown') AS [RoleSummary]",
                "FROM [Learning].[EmployeeDetails] ED",
                "INNER JOIN CTE_MSRoleTenure MSRT ON ED.PersonID = MSRT.PersonID",
                "WHERE ED.[PersonStatusDesc] IN (",
                "        'Active'",
                "        ,'Pd Leave of Abs'",
                "        ,'Unpd Leave of Abs'",
                "        ,'NA'",
                "        ) --Active Employees",
                "    AND ED.PersonID IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [MSUserKey]",
                "    ,0 AS [Days In Role]",
                "    ,'Not Available' AS [User Status]",
                "    ,'Unknown' AS [Tenure In Microsoft]",
                "    ,'Unknown' AS [Tenure In Role]",
                "    ,'Not Available' AS [Qualifier 2]",
                "    ,'Not Available' AS [Qualifier 1]",
                "    ,'Not Available' AS [Profession]",
                "    ,'Not Available' AS [Discipline]",
                "    ,'Unknown' AS [Standard Title]",
                "    ,'Unknown' AS [Role]",
                "    ,'Unknown' AS [RoleSummary]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Certiport Product Type",
        "description": "Certiport Product Type",
        "lineageTag": "446e3224-18ad-4ae7-bc20-2828a176c53f",
        "columns": [
          {
            "name": "Product_PK",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Product_PK",
            "isAvailableInMdx": false,
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "Product Subtype Desc",
            "dataType": "string",
            "description": "Product Subtype Desc",
            "sourceColumn": "Product Subtype Desc",
            "lineageTag": "711ac646-5d35-4825-816c-6fa123ee5774"
          },
          {
            "name": "Product Type Desc",
            "dataType": "string",
            "description": "Product Type Desc",
            "sourceColumn": "Product Type Desc",
            "lineageTag": "d72fdd71-cfda-4a20-af2b-e1f295853879"
          },
          {
            "name": "Product Desc",
            "dataType": "string",
            "description": "Product Desc",
            "sourceColumn": "Product Desc",
            "lineageTag": "6aa405c8-ca04-4014-a150-84c181306e27"
          },
          {
            "name": "Line Product Type Desc",
            "dataType": "string",
            "description": "Line Product Type Desc",
            "sourceColumn": "Line Product Type Desc",
            "lineageTag": "177a0fd9-42aa-42a3-93ce-cf0324dd419d"
          }
        ],
        "partitions": [
          {
            "name": "Certiport Product Type",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT CAST(CertiportProductID AS NVARCHAR(255)) AS [Product_PK]",
                "    ,ISNULL(ProductSubType, 'Unknown') AS [Product Subtype Desc]",
                "    ,ISNULL(ProductType, 'Unknown') AS [Product Type Desc]",
                "    ,ISNULL(ProductDescription, 'Unknown') AS [Product Desc]",
                "    ,ISNULL(LineProductTypeDesc, 'Unknown') AS [Line Product Type Desc]",
                "FROM [Learning].[CertiportUtilizations]",
                "WHERE CertiportProductID IS NOT NULL",
                "",
                "UNION",
                "",
                "SELECT 'Unknown' AS [Product_PK]",
                "    ,'Unknown' AS [Product Subtype Desc]",
                "    ,'Unknown' AS [Product Type Desc]",
                "    ,'Unknown' AS [Product Desc]",
                "    ,'Unknown' AS [Line Product Type Desc]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Test Center Geography",
        "description": "Test Center Geography",
        "lineageTag": "d68f985c-987d-45ad-90ee-5f60e8a42540",
        "columns": [
          {
            "name": "Region",
            "dataType": "string",
            "description": "Region",
            "sourceColumn": "Region",
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "CountryCode",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "CountryCode",
            "isAvailableInMdx": false,
            "lineageTag": "7c3753ba-96f0-487a-9d4c-88da762cf6e9"
          },
          {
            "name": "Country",
            "dataType": "string",
            "description": "Country",
            "sourceColumn": "Country",
            "lineageTag": "1e2a559b-e552-400c-b26c-ee52ea9d6726"
          },
          {
            "name": "Area",
            "dataType": "string",
            "description": "Area",
            "sourceColumn": "Area",
            "lineageTag": "a602ee38-f521-4dd4-98c7-2b1ee86d78b2"
          },
          {
            "name": "Sub Region",
            "dataType": "string",
            "description": "Sub Region",
            "sourceColumn": "Sub Region",
            "lineageTag": "824cf32a-875f-4663-9715-413f103389a3"
          },
          {
            "name": "Big Area",
            "dataType": "string",
            "description": "Big Area",
            "sourceColumn": "Big Area",
            "lineageTag": "2d5a652c-24b6-4a0d-9cb7-c8637b7782c0"
          },
          {
            "name": "GeographyKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "GeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "bd08335e-654d-4b26-9e2e-89499374da7f"
          },
          {
            "name": "Subsidiary",
            "dataType": "string",
            "description": "Subsidiary",
            "sourceColumn": "Subsidiary",
            "lineageTag": "ed2adfb3-7d03-401a-9163-abe55050c65f"
          }
        ],
        "partitions": [
          {
            "name": "Test Center Geography",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT ISNULL(G.GeographyID, 'Unknown') AS [GeographyKey]",
                "    ,ISNULL(CountryCode, 'Unknown') AS [CountryCode]",
                "    ,ISNULL(CountryName, 'Unknown') AS [Country]",
                "    ,ISNULL(Area, 'Unknown') AS [Area]",
                "    ,ISNULL(SubRegion, 'Unknown') AS [Sub Region]",
                "    ,ISNULL(BigArea, 'Unknown') AS [Big Area]",
                "    ,ISNULL(Region, 'Unknown') AS [Region]",
                "    ,ISNULL(Subsidiary, 'Unknown') AS [Subsidiary]",
                "FROM Learning.TestCenters T",
                "LEFT JOIN [Learning].[Geographies] G ON T.GeographyID = G.GeographyID",
                "WHERE ISNULL(G.GeographyID, 'Unknown') <> 'Unknown'",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [Region]",
                "    ,'Unknown' AS [CountryCode]",
                "    ,'Unknown' AS [Country]",
                "    ,'Unknown' AS [Area]",
                "    ,'Unknown' AS [Sub Region]",
                "    ,'Unknown' AS [Big Area]",
                "    ,'Unknown' AS [GeographyKey]",
                "    ,'Unknown' AS [Subsidiary]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "Test Center Geography Hierarchy",
            "lineageTag": "bed54f63-791d-4a08-b497-9906974a2450",
            "levels": [
              {
                "name": "Big Area",
                "ordinal": 0,
                "column": "Big Area",
                "lineageTag": "8f2c7bc8-3cf7-49f5-ba36-3062a82cf8cc"
              },
              {
                "name": "Area",
                "ordinal": 1,
                "column": "Area",
                "lineageTag": "2f9f6775-02c8-47e5-84d0-1d322e9fae85"
              },
              {
                "name": "Region",
                "ordinal": 2,
                "column": "Region",
                "lineageTag": "1d6fb5a0-281e-4ee0-afa6-41a596bfff61"
              },
              {
                "name": "Sub Region",
                "ordinal": 3,
                "column": "Sub Region",
                "lineageTag": "1a5d1cf3-2b46-4b75-8942-7feba6508bdc"
              },
              {
                "name": "Subsidiary",
                "ordinal": 4,
                "column": "Subsidiary",
                "lineageTag": "16de8f96-2fbe-45f7-a3a5-d107faa2d5d3"
              },
              {
                "name": "Country",
                "ordinal": 5,
                "column": "Country",
                "lineageTag": "9dd9a65f-1736-4df0-979f-d685c0abbf1b"
              }
            ]
          }
        ]
      },
      {
        "name": "Test Center Vendor",
        "description": "Test Center Vendor",
        "lineageTag": "f246b9a5-4750-4f05-a0bd-0f85f73b6241",
        "columns": [
          {
            "name": "Vendor Type",
            "dataType": "string",
            "description": "Vendor Type",
            "sourceColumn": "Vendor Type",
            "lineageTag": "d57e9b16-76b3-4a2a-9cf2-8edf04bdd189"
          },
          {
            "name": "Vendor",
            "dataType": "string",
            "description": "Vendor",
            "sourceColumn": "Vendor",
            "lineageTag": "032dddf5-b5b3-4ab8-8ebe-0661b24da4b5"
          },
          {
            "name": "VendorKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "VendorKey",
            "lineageTag": "74d69573-5f68-459b-8674-72e384b85a03"
          }
        ],
        "partitions": [
          {
            "name": "Test Center Vendor",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "WITH CTE_Vendor",
                "AS (",
                "    SELECT VendorName AS VendorKey",
                "        ,IIF(LOWER(VendorName) = 'pearsonvue', 'PVUE', VendorName) AS VendorName",
                "        ,IIF(LOWER(VendorName) = 'certiport', 'Academic', 'Commercial') AS VendorType",
                "    FROM Learning.ExamRegistrations",
                "    WHERE ISNULL(VendorName,'') <> ''",
                "    ",
                "    UNION",
                "    ",
                "    SELECT VendorName AS VendorKey",
                "        ,IIF(LOWER(VendorName) = 'pearsonvue', 'PVUE', VendorName) AS VendorName",
                "        ,IIF(LOWER(VendorName) = 'certiport', 'Academic', 'Commercial') AS VendorType",
                "    FROM Learning.ExamParticipation",
                "    WHERE ISNULL(VendorName,'') <> ''",
                "    ",
                "    UNION",
                "    ",
                "    SELECT 'Unknown' AS VendorKey",
                "        ,'Unknown' AS VendorName",
                "        ,'Unknown' AS VendorType",
                "    )",
                "SELECT VendorKey",
                "    ,VendorName AS Vendor",
                "    ,VendorType AS [Vendor Type]",
                "FROM CTE_Vendor",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "User Profile Geography",
        "description": "User Profile Geography",
        "lineageTag": "1600390c-046d-4124-82cd-3c344dc0d608",
        "columns": [
          {
            "name": "Region",
            "dataType": "string",
            "description": "Region",
            "sourceColumn": "Region",
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "CountryCode",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "CountryCode",
            "isAvailableInMdx": false,
            "lineageTag": "7c3753ba-96f0-487a-9d4c-88da762cf6e9"
          },
          {
            "name": "Country",
            "dataType": "string",
            "description": "Country",
            "sourceColumn": "Country",
            "lineageTag": "1e2a559b-e552-400c-b26c-ee52ea9d6726"
          },
          {
            "name": "Area",
            "dataType": "string",
            "description": "Area",
            "sourceColumn": "Area",
            "lineageTag": "a602ee38-f521-4dd4-98c7-2b1ee86d78b2"
          },
          {
            "name": "Sub Region",
            "dataType": "string",
            "description": "Sub Region",
            "sourceColumn": "Sub Region",
            "lineageTag": "824cf32a-875f-4663-9715-413f103389a3"
          },
          {
            "name": "Big Area",
            "dataType": "string",
            "description": "Big Area",
            "sourceColumn": "Big Area",
            "lineageTag": "2d5a652c-24b6-4a0d-9cb7-c8637b7782c0"
          },
          {
            "name": "GeographyKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "GeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "bd08335e-654d-4b26-9e2e-89499374da7f"
          },
          {
            "name": "Subsidiary",
            "dataType": "string",
            "description": "Subsidiary",
            "sourceColumn": "Subsidiary",
            "lineageTag": "ed2adfb3-7d03-401a-9163-abe55050c65f"
          }
        ],
        "partitions": [
          {
            "name": "User Profile Geography",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT ISNULL(G.GeographyID, 'Unknown') AS [GeographyKey]",
                "    ,ISNULL(CountryCode, 'Unknown') AS [CountryCode]",
                "    ,ISNULL(CountryName, 'Unknown') AS [Country]",
                "    ,ISNULL(Area, 'Unknown') AS [Area]",
                "    ,ISNULL(SubRegion, 'Unknown') AS [Sub Region]",
                "    ,ISNULL(BigArea, 'Unknown') AS [Big Area]",
                "    ,ISNULL(Region, 'Unknown') AS [Region]",
                "    ,ISNULL(Subsidiary, 'Unknown') AS [Subsidiary]",
                "FROM [Learning].[Geographies] G",
                "WHERE ISNULL(G.GeographyID, 'Unknown') <> 'Unknown'",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [Region]",
                "    ,'Unknown' AS [CountryCode]",
                "    ,'Unknown' AS [Country]",
                "    ,'Unknown' AS [Area]",
                "    ,'Unknown' AS [Sub Region]",
                "    ,'Unknown' AS [Big Area]",
                "    ,'Unknown' AS [GeographyKey]",
                "    ,'Unknown' AS [Subsidiary]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "User Profile Geography Hierarchy",
            "lineageTag": "e0e50505-1d2a-480d-ba41-774c24c5f2dd",
            "levels": [
              {
                "name": "Big Area",
                "ordinal": 0,
                "column": "Big Area",
                "lineageTag": "958b9ee0-33a8-41ea-bce3-6188b307618e"
              },
              {
                "name": "Area",
                "ordinal": 1,
                "column": "Area",
                "lineageTag": "3a221e9d-738e-4b74-a93c-9b13ca4129f9"
              },
              {
                "name": "Region",
                "ordinal": 2,
                "column": "Region",
                "lineageTag": "8d6a8986-f93a-4202-bf44-0e9d51ff368b"
              },
              {
                "name": "Sub Region",
                "ordinal": 3,
                "column": "Sub Region",
                "lineageTag": "f41aca0d-11fd-4df3-a865-229e5ade6b9b"
              },
              {
                "name": "Subsidiary",
                "ordinal": 4,
                "column": "Subsidiary",
                "lineageTag": "496e6403-6116-4dfa-b8c6-6a186cc84699"
              },
              {
                "name": "Country",
                "ordinal": 5,
                "column": "Country",
                "lineageTag": "a80905e0-0978-48d6-8b3d-1ac33784eef6"
              }
            ]
          }
        ]
      },
      {
        "name": "User",
        "description": "User",
        "lineageTag": "5730ed1a-884d-4f46-9d76-cd4b1a79a8e5",
        "columns": [
          {
            "name": "UserKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "UserKey",
            "isAvailableInMdx": false,
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "MCT Area Of Expertise",
            "dataType": "string",
            "description": "MCT Area Of Expertise",
            "sourceColumn": "MCT Area Of Expertise",
            "lineageTag": "b932b2f3-1ddb-4570-a202-8cc3ebb03a3f"
          },
          {
            "name": "MCT Employed In",
            "dataType": "string",
            "description": "MCT Employed In",
            "sourceColumn": "MCT Employed In",
            "lineageTag": "3c3da92c-7a07-4abb-94d1-cc8379e5aa2f"
          },
          {
            "name": "MCT Application Type",
            "dataType": "string",
            "description": "MCT Application Type",
            "sourceColumn": "MCT Application Type",
            "lineageTag": "5c143f0b-0bd0-4227-afbf-f51d2581ed52"
          },
          {
            "name": "MCT Type",
            "dataType": "string",
            "description": "MCT Type",
            "sourceColumn": "MCT Type",
            "lineageTag": "4cb1e63d-89c8-4915-a654-4e9c4cefed9f"
          },
          {
            "name": "MCT Language",
            "dataType": "string",
            "description": "MCT Language",
            "sourceColumn": "MCT Language",
            "lineageTag": "c2cc883a-400b-4b1d-914f-aba3bbcddc48"
          },
          {
            "name": "MCT Anniversary Date",
            "dataType": "dateTime",
            "description": "MCT Anniversary Date",
            "sourceColumn": "MCT Anniversary Date",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "5b10a603-10c1-456f-bd44-d273b4e8cc54"
          },
          {
            "name": "MCTGeographyKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "MCTGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "72ba1c8d-7f25-45f3-8a26-2fa4706b1606"
          },
          {
            "name": "Is Active MCT",
            "dataType": "string",
            "description": "Is Active MCT",
            "sourceColumn": "Is Active MCT",
            "lineageTag": "5ea73914-f58e-4b9b-945d-a02bb2d10d1a"
          },
          {
            "name": "Is FTE",
            "dataType": "string",
            "description": "Is FTE",
            "sourceColumn": "Is FTE",
            "lineageTag": "48e38d97-3a98-46e3-9b21-6a3f0a15da35"
          },
          {
            "name": "City",
            "dataType": "string",
            "description": "City",
            "sourceColumn": "City",
            "lineageTag": "b3ffb79c-d0a1-4e24-8990-85420f4a48cc"
          },
          {
            "name": "Job Title",
            "dataType": "string",
            "description": "Job Title",
            "sourceColumn": "Job title",
            "lineageTag": "8a34f9b2-3c3f-4a54-aabf-70c1a72fe3f9"
          },
          {
            "name": "Is MCT FTE",
            "dataType": "string",
            "description": "Is MCT FTE",
            "sourceColumn": "Is MCT FTE",
            "lineageTag": "6e32bbb7-3e75-4fc6-a965-aaedf2825ec2"
          },
          {
            "name": "FinanceGeographyKey",
            "dataType": "string",
            "description": "FinanceGeographyKey",
            "sourceColumn": "FinanceGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "b45a8708-3c44-4b43-af9d-e9d494f03269"
          },
          {
            "name": "FinanceOrganizationKey",
            "dataType": "string",
            "description": "FinanceOrganizationKey",
            "sourceColumn": "FinanceOrganizationKey",
            "isAvailableInMdx": false,
            "lineageTag": "0ac51ad6-5514-4efe-94cd-4d18a991d6cd"
          },
          {
            "name": "MSUserKey",
            "dataType": "string",
            "description": "MSUserKey",
            "sourceColumn": "MSUserKey",
            "isAvailableInMdx": false,
            "lineageTag": "465cc0cf-7d3a-49b4-b137-97c9bcc53a02"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonID",
            "lineageTag": "3dcef05f-87c1-4567-9a0b-675cc776b851"
          },
          {
            "name": "Is Partner",
            "dataType": "string",
            "sourceColumn": "Is Partner",
            "lineageTag": "26c72154-9642-44f6-8ea9-12fe0c25d629"
          },
          {
            "name": "PartnerOrganizationKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PartnerOrganizationKey",
            "isAvailableInMdx": false,
            "lineageTag": "c7a79b48-13b8-4ed1-a50d-0921a4ccf1ff"
          }
        ],
        "partitions": [
          {
            "name": "User",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "DECLARE @Date AS DATE = '2018-07-01';",
                "DECLARE @AppliedSkillsDate AS DATE = '2023-10-25';",
                "",
                "WITH CTE_PersonsList AS (",
                "    -- Applied Skills",
                "    SELECT ASP.PersonDetailsID",
                "    FROM [Learning].[AppliedSkillParticipation] ASP",
                "    WHERE LOWER(ASP.AppliedSkillName) LIKE 'apl-____%'",
                "        AND (",
                "            (NOT LOWER(ASP.SolutionArea) LIKE 'apl-0000%')",
                "            OR ASP.SolutionArea IS NULL",
                "        )",
                "        AND LOWER(ASP.AppliedSkillStatus) <> 'lab creation failed'",
                "        AND TRY_CAST(ASP.AppliedSkillStartTime AS DATE) >= @AppliedSkillsDate",
                "",
                "    UNION",
                "",
                "    -- Certifications",
                "    SELECT LC.PersonDetailsID",
                "    FROM Learning.LearnerCertifications LC",
                "    WHERE CAST(EffectiveDate AS DATE) >= @Date",
                "",
                "    UNION",
                "",
                "    -- Exams Participation",
                "    SELECT EP.PersonDetailsID",
                "    FROM Learning.ExamParticipation EP",
                "    WHERE CAST(EP.ExamCompletionDate AS DATE) >= @Date",
                "",
                "    UNION",
                "",
                "    -- Exams No show",
                "    SELECT ER.PersonDetailsID",
                "    FROM Learning.ExamRegistrations ER",
                "    WHERE CAST(ER.ExamDate AS DATE) >= @Date",
                "        AND (",
                "            ER.RegistrationStatus IN ('NoShow', 'Expired')",
                "            OR (",
                "                ER.RegistrationStatus IN ('ApptCancelled', 'ApptCreated', 'ApptRescheduled')",
                "                AND CAST(ER.ExamDate AS DATE) >= CAST(ER.EtlUpdateDateTime AS DATE)",
                "            )",
                "        )",
                "",
                "    UNION",
                "",
                "    -- Fact MCT",
                "    SELECT MCT.PersonDetailsID",
                "    FROM Learning.MicrosoftCertifiedTrainers MCT",
                "    WHERE CAST(MCT.AnniversaryDate AS DATE) > CAST(EtlUpdateDateTime AS DATE)",
                ")",
                "",
                "--CTE_IsAcademic AS (",
                "--    SELECT DISTINCT EP.PersonDetailsID, 1 AS IsAcademic",
                "--    FROM CTE_PersonsList PL",
                "--    INNER JOIN Learning.ExamParticipation EP ON EP.PersonDetailsID = PL.PersonDetailsID",
                "--    LEFT JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = EP.PersonDetailsID",
                "--    LEFT JOIN Learning.BridgeDiscountActivity BDA ON BDA.ExamParticipationID = EP.ExamParticipationID",
                "--    LEFT JOIN Learning.Discounts D ON D.DiscountID = BDA.DiscountID",
                "--    WHERE (",
                "--        CandidateCategorization IN ('072', '72')",
                "--        OR LOWER(D.SourceIdentifier) = 'job seeker exam offer 2020'",
                "--        --AND LOWER(PD.JobTitle) = 'student'",
                "--    )",
                "--    AND EP.PersonDetailsID IS NOT NULL",
                "--)",
                "",
                "--CTE_SFD AS (",
                "--    SELECT LOWER(SFD.DomainName) AS DomainName, A.AccountID, ReviewStatus",
                "--    FROM [Operations].[SafelistedDomains] SFD",
                "--    INNER JOIN Learning.Accounts A ON A.SkillingAccountCode = SFD.SkillingAccountCode",
                "--        AND A.TPID = A.MSSalesOrgID",
                "--)",
                "SELECT",
                "    PL.PersonDetailsID AS UserKey,",
                "    PD.PersonID,",
                "    ISNULL(MCT.AreaOfExpertise, 'unknown') AS [MCT Area Of Expertise],",
                "    ISNULL(MCT.EmployedIn, 'unknown') AS [MCT Employed In],",
                "    ISNULL(MCT.ApplicationType, 'unknown') AS [MCT Application Type],",
                "    ISNULL(MCT.TrainerType, 'unknown') AS [MCT Type],",
                "    ISNULL(MCT.[Language], 'unknown') AS [MCT Language],",
                "    CAST(ISNULL(MCT.AnniversaryDate, '1900-01-01') AS DATE) AS [MCT Anniversary Date],",
                "    ISNULL(G.GeographyID, 'unknown') AS [MCTGeographyKey],",
                "    IIF(MCT.PersonDetailsID IS NOT NULL, 'Yes', 'No') AS [Is Active MCT],",
                "    PD.IsPartner AS [Is Partner],",
                "    IIF(ED.PersonID IS NOT NULL, 'Yes', 'No') AS [Is FTE],",
                "    IIF(ED.PersonID IS NOT NULL AND PD.IsMicrosoftCertifiedTrainer = 'Yes', 'Yes', 'No') AS [Is MCT FTE],",
                "    ISNULL(ED.City, 'unknown') AS [City],",
                "    ISNULL(PD.JobTitle, 'unknown') AS [Job title],",
                "    ISNULL(CAST(PD.PartnerOneID AS NVARCHAR(255)), 'Unknown') AS [PartnerOrganizationKey],",
                "    ISNULL(ED.FinanceGeographyID, 'unknown') AS FinanceGeographyKey,",
                "    ISNULL(ED.FinanceOrganizationID, 'unknown') AS FinanceOrganizationKey,",
                "    ISNULL(ED.PersonID, 'unknown') AS MSUserKey",
                "    --CASE ",
                "    --    WHEN A.AccountID IS NOT NULL AND SFD.DomainName IS NOT NULL THEN 'ESI'",
                "    --    WHEN A.AccountID IS NOT NULL THEN 'LEARN'",
                "    --    WHEN A1.AccountID IS NOT NULL THEN 'CDES'",
                "    --    ELSE 'Non-Customer'",
                "    --END AS [Customer Source],",
                "    --COALESCE(",
                "    --    CASE ",
                "    --        WHEN A.AccountID IS NOT NULL AND SFD.ReviewStatus <> 859270001 AND SFD.DomainName IS NOT NULL THEN 'unknown'",
                "    --        ELSE NULL",
                "    --    END,",
                "    --    NULLIF(TRIM(LOWER(SFD.DomainName)), ''),",
                "    --    NULLIF(TRIM(LOWER(BPA.PersonEmailDomain)), ''),",
                "    --    NULLIF(TRIM(LOWER(PD.EmailAddressDomain)), ''),",
                "    --    'unknown'",
                "    --) AS EmailAddressDomain,",
                "    --IIF(IAC.IsAcademic = 1, 'Yes', 'No') AS [Conf_IsAcademicFlag]",
                "    --IIF(A.AccountID IS NOT NULL OR A1.AccountID IS NOT NULL, 'Yes', 'No') AS [Is Customer]",
                "",
                "FROM CTE_PersonsList PL",
                "INNER JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = PL.PersonDetailsID",
                "    AND LOWER(PD.SourceSystem) = 'learn'",
                "--LEFT JOIN CTE_IsAcademic IAC ON IAC.PersonDetailsID = PD.PersonDetailsID",
                "--LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "--    AND LOWER(BPA.SourceSystem) = 'learn'",
                "--LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "--    AND BPA.PersonDetailsID IS NULL",
                "--    AND BO.PersonEmailDomain IS NOT NULL",
                "--LEFT JOIN CTE_SFD SFD ON LOWER(SFD.DomainName) = COALESCE(LOWER(BPA.PersonEmailDomain), LOWER(BO.PersonEmailDomain))",
                "--LEFT JOIN Learning.Accounts A ",
                "--    ON LOWER(A.AccountID) = LOWER(COALESCE(SFD.AccountID, BPA.AccountID))",
                "--    AND A.TPID IS NOT NULL",
                "--LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON LOWER(CDES.PersonID) = LOWER(PD.PersonID)",
                "--    AND LOWER(CDES.SourceSystem) = 'learn'",
                "--    AND A.AccountID IS NULL",
                "--LEFT JOIN Learning.Accounts A1 ",
                "--    ON LOWER(A1.AccountID) = LOWER(CDES.AccountID)",
                "--    AND A1.TPID IS NOT NULL",
                "LEFT JOIN Learning.MicrosoftCertifiedTrainers MCT ON PL.PersonDetailsID = MCT.PersonDetailsID",
                "    AND CAST(MCT.AnniversaryDate AS DATE) > CAST(MCT.EtlUpdateDateTime AS DATE)",
                "LEFT JOIN Learning.Geographies G ON G.GeographyID = MCT.GeographyID",
                "LEFT JOIN [Learning].[EmployeeDetails] ED ON ED.PersonID = PD.PersonID",
                "    AND ED.PersonStatusDesc IN ('Active', 'Pd Leave of Abs', 'Unpd Leave of Abs', 'NA')",
                "    AND ED.PersonID IS NOT NULL",
                "",
                "",
                "UNION ALL",
                "",
                "SELECT ",
                "    'Unknown' AS UserKey,",
                "    'Unknown' AS PersonID,",
                "    'Unknown' AS [MCT Area Of Expertise],",
                "    'Unknown' AS [MCT Employed In],",
                "    'Unknown' AS [MCT Application Type],",
                "    'Unknown' AS [MCT Type],",
                "    'Unknown' AS [MCT Language],",
                "    '1900-01-01' AS [MCT Anniversary Date],",
                "    'Unknown' AS [MCTGeographyKey],",
                "    'No' AS [Is Active MCT],",
                "    'No' AS [Is Partner],",
                "    'No' AS [Is FTE],",
                "    'No' AS [Is MCT FTE],",
                "    'Unknown' AS [PartnerOrganizationKey],",
                "    'Unknown' AS [City],",
                "    'Unknown' AS [Job title],",
                "    'Unknown' AS [FinanceGeographyKey],",
                "    'Unknown' AS [FinanceOrganizationKey],",
                "    'Unknown' AS [MSUserKey]",
                "  --  'Non-Customer' AS [Customer Source],",
                "  --  'Unknown' AS EmailAddressDomain,",
                "  --  'No' AS [Conf_IsAcademicFlag]",
                "   -- 'No' AS [Is Customer]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam",
        "description": "Exam",
        "lineageTag": "36ae55ad-b91c-4571-b21a-868195cf8013",
        "columns": [
          {
            "name": "ExamKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ExamKey",
            "isAvailableInMdx": false,
            "lineageTag": "0743347a-946f-4ba1-9e9f-1a8a6d378a8c"
          },
          {
            "name": "Exam Number",
            "dataType": "string",
            "description": "Exam Number",
            "sourceColumn": "Exam Number",
            "lineageTag": "617181c8-2ec9-4864-bb29-377ca3ac205f"
          },
          {
            "name": "Exam Description",
            "dataType": "string",
            "description": "Exam Description",
            "sourceColumn": "Exam Description",
            "lineageTag": "50efa658-c843-4547-87bf-4b0e487c49eb"
          },
          {
            "name": "Exam Create Date",
            "dataType": "dateTime",
            "description": "Exam Create Date",
            "sourceColumn": "Exam Create Date",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "615ddd6f-408d-4184-b9d3-1667137017fb"
          },
          {
            "name": "Source System",
            "dataType": "string",
            "description": "Source System",
            "isHidden": true,
            "sourceColumn": "Source System",
            "lineageTag": "9bc5b60c-95b7-47c3-9343-492d052d0ef5"
          },
          {
            "name": "Academic AI Exam flag",
            "dataType": "string",
            "description": "Source System",
            "sourceColumn": "Academic AI Exam flag",
            "lineageTag": "4c23775d-12f6-44f9-8b51-8247c760b8c5"
          }
        ],
        "partitions": [
          {
            "name": "Exam",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ",
                "    ExamID AS [ExamKey],",
                "    ISNULL(UPPER(ExamNumber), 'Unknown') AS [Exam Number],",
                "    ISNULL(Description, 'Unknown') AS [Exam Description],",
                "    ISNULL(CAST(ExamCreatedDate AS DATE), '1900-01-01') AS [Exam Create Date],",
                "    [SourceSystem] AS [Source System],",
                "    CASE",
                "        WHEN UPPER(ExamNumber) IN (",
                "                'AI-102',",
                "                'AI-900',",
                "                'DP-100',",
                "                'DP-203',",
                "                'DP-300',",
                "                'DP-420',",
                "                'DP-500',",
                "                'DP-900',",
                "                'PL-300'",
                "            ) ",
                "        THEN 'Yes'",
                "        ELSE 'No'",
                "    END AS [Academic AI Exam flag]",
                "FROM [Learning].[Exams]",
                "WHERE ExamID IS NOT NULL",
                "    AND SourceSystem IN (",
                "        'MSCert',",
                "        'Certiport'",
                "    )",
                "    AND SourceIdentifier NOT LIKE 'test%'",
                "",
                "UNION ALL",
                "",
                "SELECT ",
                "    'Unknown' AS [ExamKey],",
                "    'Unknown' AS [Exam Number],",
                "    'Unknown' AS [Exam Description],",
                "    '1900-01-01' AS [Exam Create Date],",
                "    'Unknown' AS [Source System],",
                "    'No' AS [Academic AI Exam flag]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam Registrations",
        "description": "Exam Registrations",
        "lineageTag": "49bfa1c7-7921-40ba-9efe-21171ddecac0",
        "columns": [
          {
            "name": "Exam Status",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Exam Status",
            "isAvailableInMdx": false,
            "lineageTag": "0743347a-946f-4ba1-9e9f-1a8a6d378a8c"
          },
          {
            "name": "Exam Status Key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Exam Status Key",
            "isAvailableInMdx": false,
            "lineageTag": "617181c8-2ec9-4864-bb29-377ca3ac205f"
          }
        ],
        "partitions": [
          {
            "name": "Exam Registrations",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT 'Unknown' AS [Exam Status]",
                "    ,'Unknown' AS [Exam Status Key]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "Rescheduled Exams",
            "description": "This calculation is counting the number of distinct ExamRegistrationIDs in the Fact Registrations table where the RescheduledExamsCount is equal to 1. This could be used to measure the number of registrations that have been rescheduled exactly once.",
            "expression": [
              "CALCULATE (",
              "    DISTINCTCOUNT ( 'Fact Registrations'[ExamRegistrationID] ),",
              "    KEEPFILTERS ( 'Fact Registrations'[RescheduledExamsCount] = 1 )",
              ")"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Scheduled Cancellations",
            "description": "This calculation is counting the number of distinct ExamRegistrationIDs that have a CancelledExamsCount of 1. This could be used to measure the number of exam registrations that were cancelled out of the total number of registrations.",
            "expression": [
              "CALCULATE (",
              "    DISTINCTCOUNT ( 'Fact Registrations'[ExamRegistrationID] ),",
              "    KEEPFILTERS ( 'Fact Registrations'[CancelledExamsCount] = 1 )",
              ")"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Scheduled Exams",
            "description": "This calculation is counting the number of distinct ExamRegistrationIDs from the Fact Registrations table, but only counting those that have a ScheduledExamsCount of 1.",
            "expression": [
              "CALCULATE (",
              "    DISTINCTCOUNT ( 'Fact Registrations'[ExamRegistrationID] ),",
              "    KEEPFILTERS ( 'Fact Registrations'[ScheduledExamsCount] = 1 )",
              ")"
            ],
            "formatString": "#,0"
          }
        ]
      },
      {
        "name": "Fact Registrations",
        "isHidden": true,
        "lineageTag": "5c71200d-a0c6-4063-bea8-cb19ae874574",
        "columns": [
          {
            "name": "ExamKey",
            "dataType": "string",
            "description": "ExamKey",
            "isHidden": true,
            "sourceColumn": "ExamKey",
            "isAvailableInMdx": false,
            "lineageTag": "ed381e66-1ba4-44bb-adee-56409d70d5d3"
          },
          {
            "name": "CancelledExamsCount",
            "dataType": "int64",
            "description": "CancelledExamsCount",
            "isHidden": true,
            "sourceColumn": "CancelledExamsCount",
            "isAvailableInMdx": false,
            "lineageTag": "32ac08e4-7322-45ae-95c2-0b7c230e0159"
          },
          {
            "name": "UserProfileGeographyKey",
            "dataType": "string",
            "description": "UserProfileGeographyKey",
            "isHidden": true,
            "sourceColumn": "UserProfileGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "f679a694-9688-42af-aaf8-bb6b57921174"
          },
          {
            "name": "ExamVendorKey",
            "dataType": "string",
            "description": "ExamVendorKey",
            "isHidden": true,
            "sourceColumn": "ExamVendorKey",
            "isAvailableInMdx": false,
            "lineageTag": "5fb45bf6-3d48-4e0e-886d-d12201eac8e3"
          },
          {
            "name": "ExamDeliveryKey",
            "dataType": "string",
            "description": "ExamDeliveryKey",
            "isHidden": true,
            "sourceColumn": "ExamDeliveryKey",
            "isAvailableInMdx": false,
            "lineageTag": "634dc9fc-b7a7-4730-83a0-0379677de7e1"
          },
          {
            "name": "ScheduledExamsCount",
            "dataType": "int64",
            "description": "ScheduledExamsCount",
            "isHidden": true,
            "sourceColumn": "ScheduledExamsCount",
            "isAvailableInMdx": false,
            "lineageTag": "f74016cb-6ece-45b7-8d2a-a38289bfb21f"
          },
          {
            "name": "RescheduledExamsCount",
            "dataType": "int64",
            "description": "RescheduledExamsCount",
            "isHidden": true,
            "sourceColumn": "RescheduledExamsCount",
            "isAvailableInMdx": false,
            "lineageTag": "2a861071-38f6-4a2d-b38a-6dd754a9a366"
          },
          {
            "name": "ExamOfferKey",
            "dataType": "string",
            "description": "ExamOfferKey",
            "isHidden": true,
            "sourceColumn": "ExamOfferKey",
            "isAvailableInMdx": false,
            "lineageTag": "728a90b3-4d3e-44ea-a3ce-a3289b9e471b"
          },
          {
            "name": "UserKey",
            "dataType": "string",
            "description": "UserKey",
            "isHidden": true,
            "sourceColumn": "UserKey",
            "isAvailableInMdx": false,
            "lineageTag": "d6e23ca6-3e26-4951-aff5-1eb1151245be"
          },
          {
            "name": "TestCenterGeographyKey",
            "dataType": "string",
            "description": "TestCenterGeographyKey",
            "isHidden": true,
            "sourceColumn": "TestCenterGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "b8cac365-eb58-403d-86c9-aced6cb342b1"
          },
          {
            "name": "DateKey",
            "dataType": "int64",
            "description": "DateKey",
            "isHidden": true,
            "sourceColumn": "DateKey",
            "isAvailableInMdx": false,
            "lineageTag": "fc02f391-b610-491e-8fac-a50b55b5f6d0"
          },
          {
            "type": "calculated",
            "name": "ChannelKey",
            "dataType": "string",
            "isDataTypeInferred": true,
            "description": "ChannelKey",
            "isHidden": true,
            "expression": [
              "IF (",
              "    RELATED ( 'Stg_Channel_Offer'[OfferChannelKey] )",
              "        <> BLANK (),",
              "    RELATED ( 'Stg_Channel_Offer'[OfferChannelKey] ),",
              "    IF (",
              "        RELATED ( 'Stg_Channel_Exams'[ExamChannelKey] )",
              "            <> BLANK (),",
              "        RELATED ( 'Stg_Channel_Exams'[ExamChannelKey] ),",
              "        \"-1\"",
              "    )",
              ")"
            ],
            "isAvailableInMdx": false,
            "lineageTag": "fcf7ff49-7576-4026-91f6-a286ab1a6dbe"
          },
          {
            "name": "ExamRegistrationID",
            "dataType": "string",
            "description": "ExamRegistrationID",
            "isHidden": true,
            "sourceColumn": "ExamRegistrationID",
            "isAvailableInMdx": false,
            "lineageTag": "50404150-848e-4968-b65c-4a36dce1a7cb"
          },
          {
            "name": "TestCenterKey",
            "dataType": "string",
            "description": "TestCenterKey",
            "isHidden": true,
            "sourceColumn": "TestCenterKey",
            "isAvailableInMdx": false,
            "lineageTag": "fc3dcb8d-0123-4767-b20c-7c39b435c101"
          },
          {
            "name": "VendorKey",
            "dataType": "string",
            "description": "VendorKey",
            "isHidden": true,
            "sourceColumn": "VendorKey",
            "isAvailableInMdx": false,
            "lineageTag": "ce22837b-1f27-4ea4-8073-f5a8976d8915"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "sourceColumn": "PersonID",
            "lineageTag": "bbe5e845-3071-430f-99b1-3df98a56df5a"
          }
        ],
        "partitions": [
          {
            "name": "Fact Registrations",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "WITH CTE_ExamOffer",
                "AS (",
                "    SELECT SourceIdentifier AS ExamOfferKey",
                "    FROM [Learning].Discounts",
                "    WHERE [DiscountType] = 'Offer'",
                "        AND ISNULL(SourceIdentifier, 'Unknown') <> 'Unknown'",
                "    ",
                "    UNION",
                "    ",
                "    SELECT [PromoName] AS ExamOfferKey",
                "    FROM [Learning].[ExamParticipation] EP",
                "    LEFT JOIN (",
                "        SELECT DISTINCT SourceIdentifier",
                "        FROM [Learning].Discounts",
                "        WHERE [DiscountType] = 'Offer'",
                "        ) BB ON BB.SourceIdentifier = EP.PromoName",
                "    WHERE BB.SourceIdentifier IS NULL",
                "        AND [PromoName] IS NOT NULL",
                "    )",
                "    ,CTE_ExamRegistration",
                "AS (",
                "    SELECT ER.ExamRegistrationID",
                "        ,ER.ExamID",
                "        ,ER.PersonDetailsID",
                "        ,ER.RegistrationStatus",
                "        ,ER.ExamNumber",
                "        ,ER.VendorType",
                "        ,ER.ExamOffer",
                "        ,ER.TestCenter",
                "        ,ER.ExamDate",
                "        ,ER.VendorName",
                "        ,ER.PersonID",
                "    FROM Learning.ExamRegistrations ER",
                "    --To remove already completed",
                "    LEFT JOIN Learning.ExamParticipation EP ON EP.ExamRegistrationID = ER.ExamRegistrationID",
                "        AND EP.ExamCompletionDate >= ER.ExamDate",
                "    WHERE CAST(ER.ExamDate AS DATE) >= CAST(ER.EtlUpdateDateTime AS DATE) --Try to get future records",
                "        AND EP.ExamRegistrationID IS NULL",
                "        AND ER.RegistrationStatus IN (",
                "            'ApptCancelled'",
                "            ,'ApptCreated'",
                "            ,'ApptRescheduled'",
                "            )",
                "        AND ER.IsBeta <> 'Yes'",
                "    )",
                "    ,CTE_TestCenter",
                "AS (",
                "    SELECT ROW_NUMBER() OVER (",
                "            PARTITION BY TestCenterName ORDER BY TestCenterName",
                "            ) row_num",
                "        ,TestCenterName",
                "        ,GeographyID",
                "        ,TestCenterID",
                "    FROM Learning.TestCenters",
                "    )",
                "    -- ,CTE_SFD",
                "-- AS (",
                "    -- SELECT DomainName",
                "        -- ,A.TPID",
                "    -- FROM [Operations].[SafelistedDomains] SFD",
                "    -- INNER JOIN Learning.Accounts A ON A.AccountID = CAST(SFD.TPID AS NVARCHAR(255))",
                "        -- AND A.TPID = SFD.TPID",
                "    -- )",
                "SELECT ISNULL(ER.ExamID, 'Unknown') AS ExamKey",
                "    ,ISNULL(ER.PersonDetailsID, 'Unknown') AS UserKey",
                "\t,ISNULL(ER.PersonID, 'Unknown') AS PersonID",
                "    ,IIF(ER.RegistrationStatus = 'ApptCancelled', 1, 0) AS [CancelledExamsCount]",
                "    ,ISNULL(G.GeographyID, 'Unknown') AS UserProfileGeographyKey",
                "    ,ISNULL(TG.GeographyID, 'Unknown') AS TestCenterGeographyKey",
                "    ,CONCAT (",
                "        ISNULL(Lower(ER.ExamNumber), 'unknown')",
                "        ,' - '",
                "        ,IIF(ER.VendorName = 'PearsonVUE', 'pvue', ISNULL(Lower(ER.VendorName), 'unknown'))",
                "        ) AS ExamVendorKey",
                "    ,ISNULL(ER.VendorType, 'Unknown') AS ExamDeliveryKey",
                "    ,IIF(ER.RegistrationStatus IN (",
                "            'ApptCreated'",
                "            ,'ApptRescheduled'",
                "            ), 1, 0) AS [ScheduledExamsCount]",
                "    ,IIF(ER.RegistrationStatus = 'ApptRescheduled', 1, 0) AS [RescheduledExamsCount]",
                "    ,ISNULL(DO.ExamOfferKey, 'Unknown') AS ExamOfferKey",
                "    ,ISNULL(CONVERT(INT, CONVERT(NVARCHAR(255), Convert(DATE, ER.ExamDate), 112)), 19000101) AS DateKey",
                "    ,ER.ExamRegistrationID",
                " --   ,COALESCE(A.AccountID, A1.AccountID, '-1') AS AccountID",
                "    -- ,CASE ",
                "        -- WHEN PD.PersonDetailsID IS NULL",
                "            -- THEN '-1'",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BPA.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- AND BO.PersonEmailDomain IS NOT NULL",
                "            -- AND SFD.DomainName IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BO.BridgeOldCertLinkID",
                "                    -- )",
                "        -- WHEN A.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- A.AccountID",
                "                    -- ,BPA.[BridgePersonAccountID]",
                "                    -- )",
                "        -- WHEN A1.AccountID IS NOT NULL",
                "            -- THEN CONCAT (",
                "                    -- PD.PersonDetailsID",
                "                    -- ,CDES.[BridgePersonCDESAccountID]",
                "                    -- )",
                "        -- ELSE CONCAT (",
                "                -- 'PD'",
                "                -- ,PD.PersonDetailsID",
                "                -- )",
                "        -- END AS PersonAccountID",
                "    ,ISNULL(CAST(TC.TestCenterID AS NVARCHAR(255)), 'Unknown') AS TestCenterKey",
                "    ,COALESCE(NULLIF(ER.VendorName, ''), 'Unknown') AS VendorKey",
                "FROM CTE_ExamRegistration ER",
                "LEFT JOIN CTE_ExamOffer DO ON DO.ExamOfferKey = ER.ExamOffer",
                "LEFT JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = ER.PersonDetailsID",
                "     AND PD.SourceSystem = 'Learn'",
                "LEFT JOIN CTE_TestCenter TC ON TC.TestCenterName = ER.TestCenter",
                "    AND row_num = 1",
                "LEFT JOIN Learning.Geographies G ON G.GeographyID = PD.GeographyID",
                "LEFT JOIN Learning.Geographies TG ON TG.GeographyID = TC.GeographyID",
                "-- LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.SourceSystem = 'Learn'",
                "-- LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "    -- AND BPA.PersonDetailsID IS NULL",
                "    -- AND BO.PersonEmailDomain IS NOT NULL",
                "-- LEFT JOIN CTE_SFD SFD ON SFD.DomainName = COALESCE(BPA.PersonEmailDomain, BO.PersonEmailDomain)",
                "-- LEFT JOIN Learning.Accounts A ON A.AccountID = COALESCE(CAST(SFD.TPID AS NVARCHAR(255)), BPA.AccountID)",
                "    -- AND A.TPID IS NOT NULL",
                "-- LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PD.PersonID",
                "    -- AND CDES.SourceSystem = 'Learn'",
                "    -- AND A.AccountID IS NULL",
                "-- LEFT JOIN Learning.Accounts A1 ON A1.AccountID = CAST(CDES.AccountID AS NVARCHAR(255))",
                "    -- AND A1.TPID IS NOT NULL",
                "WHERE ER.PersonDetailsID IS NOT NULL",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Language",
        "description": "Language",
        "lineageTag": "5302cb95-fbbf-4030-b07c-64ade8884282",
        "columns": [
          {
            "name": "Language",
            "dataType": "string",
            "sourceColumn": "Language",
            "lineageTag": "ecc5878c-3a53-45d0-b806-082b2b6f8617"
          },
          {
            "name": "LanguageKey",
            "dataType": "string",
            "sourceColumn": "LanguageKey",
            "lineageTag": "595458f3-d7fa-44a4-a5f2-f6584f80d2fb"
          }
        ],
        "partitions": [
          {
            "name": "Language",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT Language AS [LanguageKey]",
                "    ,Language AS [Language]",
                "FROM [Learning].[ExamParticipation]",
                "WHERE Language IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [LanguageKey]",
                "    ,'Unknown' AS [Language]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Channel",
        "description": "Channel",
        "columns": [
          {
            "name": "Channel Program",
            "dataType": "string",
            "description": "Channel Program",
            "sourceColumn": "ChannelProgram"
          },
          {
            "name": "Channel",
            "dataType": "string",
            "description": "Channel",
            "sourceColumn": "Channel"
          },
          {
            "name": "Channel Sub Program",
            "dataType": "string",
            "description": "Channel Sub Program",
            "sourceColumn": "ChannelSubProgram"
          },
          {
            "name": "ChannelKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ChannelKey",
            "isAvailableInMdx": false
          }
        ],
        "partitions": [
          {
            "name": "Channel",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Tables(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting\", ",
                "    [Implementation = null, ApiVersion = 15]",
                "  ), ",
                "  #\"ef2f97b3-b21a-42b0-92d0-060fa9163f0b\" = Source",
                "    {[Id = \"ef2f97b3-b21a-42b0-92d0-060fa9163f0b\"]}",
                "    [Items], ",
                "  #\"Removed Columns\" = Table.RemoveColumns(",
                "    #\"ef2f97b3-b21a-42b0-92d0-060fa9163f0b\", ",
                "    {\"OData__ColorTag\"}",
                "  ), ",
                "  #\"Removed Other Columns1\" = Table.SelectColumns(",
                "    #\"Removed Columns\", ",
                "    {\"ChannelProgram\", \"ChannelSubProgram\", \"Title\"}",
                "  ), ",
                "  #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns1\"), ",
                "  #\"Added Index\" = Table.AddIndexColumn(#\"Removed Duplicates\", \"Index\", 0, 1, Int64.Type), ",
                "  #\"Renamed Columns1\" = Table.RenameColumns(",
                "    #\"Added Index\", ",
                "    {{\"Title\", \"Channel\"}, {\"Index\", \"ChannelKey\"}}",
                "  ), ",
                "  #\"Appended Query\" = Table.Combine(",
                "    {",
                "      #\"Renamed Columns1\", ",
                "      Table.FromRecords(",
                "        {",
                "          [",
                "            ChannelProgram    = \"Unknown\", ",
                "            ChannelSubProgram = \"Unknown\", ",
                "            Channel           = \"Commercial\", ",
                "            ChannelKey        = \"-1\"",
                "          ]",
                "        }",
                "      )",
                "    }",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(#\"Appended Query\", {{\"ChannelKey\", type number}})",
                "in",
                "  #\"Changed Type\""
              ]
            }
          }
        ]
      },
      {
        "name": "MCT Expiration",
        "description": "MCT Expiration",
        "lineageTag": "f0269d4c-5afc-4065-9d70-a77ccc3dc7af",
        "columns": [
          {
            "name": "MCTExpirationKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "MCTExpirationKey",
            "isAvailableInMdx": false,
            "lineageTag": "1a4f8073-dfe6-4478-a866-0d255557d32b"
          },
          {
            "name": "Expiration Range",
            "dataType": "string",
            "description": "Expiration Range",
            "sourceColumn": "Expiration Range",
            "lineageTag": "6bc90137-0698-4338-bc9d-325af56fb5f9"
          }
        ],
        "partitions": [
          {
            "name": "MCT Expiration",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT CONVERT(INT, CONVERT(NVARCHAR(255), AnniversaryDate, 112)) AS MCTExpirationKey",
                "    ,CASE ",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= - 4500",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 0",
                "            THEN 'Expired'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 1",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 7",
                "            THEN '7 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 8",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 14",
                "            THEN '14 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 15",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 30",
                "            THEN '30 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 31",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 60",
                "            THEN '60 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 61",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 90",
                "            THEN '90 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 91",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 120",
                "            THEN '120 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 121",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 150",
                "            THEN '150 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 151",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 180",
                "            THEN '180 days'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 181",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 210",
                "            THEN '7 months'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 211",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 240",
                "            THEN '8 months'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 241",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 270",
                "            THEN '9 months'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 271",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 300",
                "            THEN '10 months'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 301",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 330",
                "            THEN '11 months'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 331",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 365",
                "            THEN '12 months'",
                "        WHEN DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) >= 366",
                "            AND DATEDIFF(DAY, CAST(EtlUpdateDateTime AS DATE), AnniversaryDate) <= 99999",
                "            THEN 'Not Expired'",
                "        ELSE 'Unknown'",
                "        END AS [Expiration Range]",
                "FROM [Learning].[MicrosoftCertifiedTrainers]",
                "WHERE AnniversaryDate IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT - 1 AS MCTExpirationKey",
                "    ,'Not Expired' AS [Expiration Range]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Fact MCT",
        "isHidden": true,
        "lineageTag": "7a6281c7-2279-4608-aa09-5bae7b88382e",
        "columns": [
          {
            "name": "MCTExpirationKey",
            "dataType": "int64",
            "description": "MCTExpirationKey",
            "isHidden": true,
            "sourceColumn": "MCTExpirationKey",
            "isAvailableInMdx": false,
            "lineageTag": "2b4d9acc-586c-4c57-b7e8-a8b73f90d8ba"
          },
          {
            "name": "UserKey",
            "dataType": "string",
            "description": "UserKey",
            "isHidden": true,
            "sourceColumn": "UserKey",
            "isAvailableInMdx": false,
            "lineageTag": "0dd4834f-2361-43f0-a738-0eed7395dfde"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "sourceColumn": "PersonID",
            "lineageTag": "550fd5a3-1ed2-4860-ab16-5ff3d3b67b71"
          }
        ],
        "partitions": [
          {
            "name": "Fact MCT",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "--WITH CTE_SFD",
                "--AS (",
                "--    SELECT DomainName",
                "--        ,A.TPID",
                "--    FROM [Operations].[SafelistedDomains] SFD",
                "--    INNER JOIN Learning.Accounts A ON A.AccountID = CAST(SFD.TPID AS NVARCHAR(255))",
                "--        AND A.TPID = SFD.TPID",
                "--    )",
                "SELECT MCT.PersonDetailsID AS [UserKey]",
                ",PD.PersonID",
                "    ,CONVERT(INT, CONVERT(NVARCHAR(255), MCT.AnniversaryDate, 112)) AS [MCTExpirationKey]",
                "    --,COALESCE(A.AccountID, A1.AccountID, '-1') AS AccountID",
                "    --,CASE ",
                "    --    WHEN PD.PersonDetailsID IS NULL",
                "    --        THEN '-1'",
                "    --    WHEN A.AccountID IS NOT NULL",
                "    --        AND BPA.PersonEmailDomain IS NOT NULL",
                "    --        AND SFD.DomainName IS NOT NULL",
                "    --        THEN CONCAT (",
                "    --                A.AccountID",
                "    --                ,BPA.[BridgePersonAccountID]",
                "    --                )",
                "    --    WHEN A.AccountID IS NOT NULL",
                "    --        AND BO.PersonEmailDomain IS NOT NULL",
                "    --        AND SFD.DomainName IS NOT NULL",
                "    --        THEN CONCAT (",
                "    --                A.AccountID",
                "    --                ,BO.BridgeOldCertLinkID",
                "    --                )",
                "    --    WHEN A.AccountID IS NOT NULL",
                "    --        THEN CONCAT (",
                "    --                A.AccountID",
                "    --                ,BPA.[BridgePersonAccountID]",
                "    --                )",
                "    --    WHEN A1.AccountID IS NOT NULL",
                "    --        THEN CONCAT (",
                "    --                PD.PersonDetailsID",
                "    --                ,CDES.[BridgePersonCDESAccountID]",
                "    --                )",
                "    --    ELSE CONCAT (",
                "    --            'PD'",
                "    --            ,PD.PersonDetailsID",
                "    --            )",
                "    --    END AS PersonAccountID",
                "FROM Learning.MicrosoftCertifiedTrainers MCT",
                "LEFT JOIN Learning.PersonDetails PD ON MCT.PersonDetailsID = PD.PersonDetailsID",
                "    AND PD.SourceSystem = 'Learn'",
                "--LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "--    AND BPA.SourceSystem = 'Learn'",
                "--LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "--    AND BPA.PersonDetailsID IS NULL",
                "--    AND BO.PersonEmailDomain IS NOT NULL",
                "--LEFT JOIN CTE_SFD SFD ON SFD.DomainName = COALESCE(BPA.PersonEmailDomain, BO.PersonEmailDomain)",
                "--LEFT JOIN Learning.Accounts A ON A.AccountID = COALESCE(CAST(SFD.TPID AS NVARCHAR(255)), BPA.AccountID)",
                "--    AND A.TPID IS NOT NULL",
                "--LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PD.PersonID",
                "--    AND CDES.SourceSystem = 'Learn'",
                "--    AND A.AccountID IS NULL",
                "--LEFT JOIN Learning.Accounts A1 ON A1.AccountID = CAST(CDES.AccountID AS NVARCHAR(255))",
                "--    AND A1.TPID IS NOT NULL",
                "WHERE MCT.PersonDetailsID IS NOT NULL",
                "    AND CAST(MCT.AnniversaryDate AS DATE) > CAST(MCT.EtlUpdateDateTime AS DATE)",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Migrated Certification",
        "description": "Migrated Certification",
        "lineageTag": "138e319e-bc9a-4c34-9191-3a1296e5e57c",
        "columns": [
          {
            "name": "Is Migrated Certification",
            "dataType": "string",
            "description": "Is Migrated Certification",
            "isKey": true,
            "sourceColumn": "Is Migrated Certification",
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d",
            "summarizeBy": "none"
          }
        ],
        "partitions": [
          {
            "name": "Migrated Certification",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT 'Yes' AS [Is Migrated Certification]",
                "",
                "UNION ALL",
                "",
                "SELECT 'No' AS [Is Migrated Certification]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Stg_Channel_MDS",
        "isHidden": true,
        "columns": [
          {
            "name": "Channel",
            "dataType": "string",
            "description": "Channel",
            "isHidden": true,
            "sourceColumn": "Channel",
            "isAvailableInMdx": false
          },
          {
            "name": "Channel Program",
            "dataType": "string",
            "description": "Channel Program",
            "isHidden": true,
            "sourceColumn": "Channel Program",
            "isAvailableInMdx": false
          },
          {
            "name": "UseExamPrefix",
            "dataType": "string",
            "description": "UseExamPrefix",
            "isHidden": true,
            "sourceColumn": "UseExamPrefix",
            "isAvailableInMdx": false
          },
          {
            "name": "ExamNumber",
            "dataType": "string",
            "description": "ExamNumber",
            "isHidden": true,
            "sourceColumn": "ExamNumber",
            "isAvailableInMdx": false
          },
          {
            "name": "UseDiscountAccessCode",
            "dataType": "string",
            "description": "UseDiscountAccessCode",
            "isHidden": true,
            "sourceColumn": "UseDiscountAccessCode",
            "isAvailableInMdx": false
          },
          {
            "name": "DiscountAccessCodePattern",
            "dataType": "string",
            "description": "DiscountAccessCodePattern",
            "isHidden": true,
            "sourceColumn": "DiscountAccessCodePattern",
            "isAvailableInMdx": false
          },
          {
            "name": "VendorID",
            "dataType": "string",
            "description": "VendorID",
            "isHidden": true,
            "sourceColumn": "VendorID",
            "isAvailableInMdx": false
          },
          {
            "name": "IsActive",
            "dataType": "string",
            "description": "IsActive",
            "isHidden": true,
            "sourceColumn": "IsActive",
            "isAvailableInMdx": false
          },
          {
            "name": "Exam Number starts with",
            "dataType": "string",
            "description": "Exam Number starts with",
            "isHidden": true,
            "sourceColumn": "Exam Number starts with",
            "isAvailableInMdx": false
          },
          {
            "name": "Vendor Name",
            "dataType": "string",
            "description": "Vendor Name",
            "isHidden": true,
            "sourceColumn": "Vendor Name",
            "isAvailableInMdx": false
          },
          {
            "name": "Channel Sub Program",
            "dataType": "string",
            "description": "Channel Sub Program",
            "isHidden": true,
            "sourceColumn": "Channel Sub Program",
            "isAvailableInMdx": false
          },
          {
            "name": "ExamPrefix",
            "dataType": "string",
            "description": "ExamPrefix",
            "isHidden": true,
            "sourceColumn": "ExamPrefix",
            "isAvailableInMdx": false
          },
          {
            "name": "JoinKey",
            "dataType": "string",
            "description": "JoinKey",
            "isHidden": true,
            "sourceColumn": "JoinKey",
            "isAvailableInMdx": false
          },
          {
            "name": "ChannelKey",
            "dataType": "string",
            "description": "ChannelKey",
            "isHidden": true,
            "sourceColumn": "ChannelKey",
            "isAvailableInMdx": false,
            "lineageTag": "2609066e-b6d0-48f4-ab2a-bba4e2255b9a"
          }
        ],
        "partitions": [
          {
            "name": "Stg_Channel_MDS",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Tables(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting\", ",
                "    [Implementation = null, ApiVersion = 15]",
                "  ), ",
                "  #\"ef2f97b3-b21a-42b0-92d0-060fa9163f0b\" = Source",
                "    {[Id = \"ef2f97b3-b21a-42b0-92d0-060fa9163f0b\"]}",
                "    [Items], ",
                "  #\"Removed Other Columns\" = Table.SelectColumns(",
                "    #\"ef2f97b3-b21a-42b0-92d0-060fa9163f0b\", ",
                "    {",
                "      \"Title\", ",
                "      \"ChannelProgram\", ",
                "      \"ChannelSubProgram\", ",
                "      \"ExamPrefix\", ",
                "      \"UseExamPrefix\", ",
                "      \"ExamNumber\", ",
                "      \"UseDiscountAccessCode\", ",
                "      \"DiscountAccessCodePattern\", ",
                "      \"VendorID\", ",
                "      \"IsActive\"",
                "    }",
                "  ), ",
                "  #\"Filtered Rows\" = Table.SelectRows(#\"Removed Other Columns\", each ([IsActive] = 1)), ",
                "  #\"Added Conditional Column\" = Table.AddColumn(",
                "    #\"Filtered Rows\", ",
                "    \"Exam Number starts with\", ",
                "    each if [UseExamPrefix] = 1 then [ExamPrefix] else [ExamNumber]",
                "  ), ",
                "  #\"Added Conditional Column1\" = Table.AddColumn(",
                "    #\"Added Conditional Column\", ",
                "    \"Vendor Name\", ",
                "    each if [VendorID] = 14 then \"Certiport\" else if [VendorID] = 19 then \"pvue\" else null",
                "  ), ",
                "  #\"Added Custom\" = Table.AddColumn(#\"Added Conditional Column1\", \"JoinKey\", each 1), ",
                "  #\"Merged Queries\" = Table.NestedJoin(",
                "    #\"Added Custom\", ",
                "    {\"ChannelProgram\", \"ChannelSubProgram\", \"Title\"}, ",
                "    Channel, ",
                "    {\"ChannelProgram\", \"ChannelSubProgram\", \"Channel\"}, ",
                "    \"Channel.1\", ",
                "    JoinKind.LeftOuter",
                "  ), ",
                "  #\"Expanded Channel.1\" = Table.ExpandTableColumn(",
                "    #\"Merged Queries\", ",
                "    \"Channel.1\", ",
                "    {\"ChannelKey\"}, ",
                "    {\"Channel.1.ChannelKey\"}",
                "  ), ",
                "  #\"Renamed Columns1\" = Table.RenameColumns(",
                "    #\"Expanded Channel.1\", ",
                "    {",
                "      {\"Title\", \"Channel\"}, ",
                "      {\"ChannelSubProgram\", \"Channel Sub Program\"}, ",
                "      {\"ChannelProgram\", \"Channel Program\"}, ",
                "      {\"Channel.1.ChannelKey\", \"ChannelKey\"}",
                "    }",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(",
                "    #\"Renamed Columns1\", ",
                "    {",
                "      {\"Channel\", type text}, ",
                "      {\"Channel Program\", type text}, ",
                "      {\"Channel Sub Program\", type text}, ",
                "      {\"ExamPrefix\", type text}, ",
                "      {\"UseExamPrefix\", type text}, ",
                "      {\"ExamNumber\", type text}, ",
                "      {\"UseDiscountAccessCode\", type text}, ",
                "      {\"DiscountAccessCodePattern\", type text}, ",
                "      {\"VendorID\", type text}, ",
                "      {\"Exam Number starts with\", type text}, ",
                "      {\"Vendor Name\", type text}",
                "    }",
                "  )",
                "in",
                "  #\"Changed Type\""
              ]
            }
          }
        ]
      },
      {
        "name": "Stg_Channel_Exams",
        "isHidden": true,
        "columns": [
          {
            "name": "Exam Number",
            "dataType": "string",
            "description": "Exam Number",
            "isHidden": true,
            "sourceColumn": "Exam Number",
            "isAvailableInMdx": false
          },
          {
            "name": "Vendor Name",
            "dataType": "string",
            "description": "Vendor Name",
            "isHidden": true,
            "sourceColumn": "Vendor Name",
            "isAvailableInMdx": false
          },
          {
            "name": "ExamChannelKey",
            "dataType": "string",
            "description": "ExamChannelKey",
            "isHidden": true,
            "sourceColumn": "ChannelKey",
            "isAvailableInMdx": false
          },
          {
            "name": "Exam Number starts with",
            "dataType": "string",
            "description": "Exam Number starts with",
            "isHidden": true,
            "sourceColumn": "Channel.Exam Number starts with",
            "isAvailableInMdx": false
          },
          {
            "name": "ExamVendorKey",
            "dataType": "string",
            "description": "ExamVendorKey",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ExamVendorKey",
            "isAvailableInMdx": false
          }
        ],
        "partitions": [
          {
            "name": "Stg_Channel_Exams",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT ExamNumber AS [Exam Number],1 AS JoinKey,ISNULL(CAST(NULLIF(LEFT(E.ExamNumber, IIF(CHARINDEX('-',E.ExamNumber)>0,CHARINDEX('-',E.ExamNumber)-1,0)),'') AS VARCHAR(100)),'Not Applicable') AS ExamPrefix",
                "FROM [Learning].[Exams] E",
                "WHERE ExamID IS NOT NULL ",
                "    AND SourceSystem IN('MSCert','Certiport')",
                "",
                "\"]",
                "  ), ",
                "  #\"Uppercased Text\" = Table.TransformColumns(",
                "    Source, ",
                "    {{\"Exam Number\", Text.Upper, type text}, {\"ExamPrefix\", Text.Upper, type text}}",
                "  ), ",
                "  #\"Merged Queries\" = Table.NestedJoin(",
                "    #\"Uppercased Text\", ",
                "    {\"ExamPrefix\"}, ",
                "    Stg_Channel_MDS, ",
                "    {\"ExamPrefix\"}, ",
                "    \"Channel\", ",
                "    JoinKind.LeftOuter",
                "  ), ",
                "  #\"Expanded Channel\" = Table.ExpandTableColumn(",
                "    #\"Merged Queries\", ",
                "    \"Channel\", ",
                "    {\"UseExamPrefix\", \"Vendor Name\", \"ChannelKey\"}, ",
                "    {\"Channel.UseExamPrefix\", \"Channel.Vendor Name\", \"Channel.ChannelKey\"}",
                "  ), ",
                "  #\"Merged Queries1\" = Table.NestedJoin(",
                "    #\"Expanded Channel\", ",
                "    {\"Exam Number\"}, ",
                "    Stg_Channel_MDS, ",
                "    {\"ExamNumber\"}, ",
                "    \"Stg_Channel_MDS\", ",
                "    JoinKind.LeftOuter",
                "  ), ",
                "  #\"Expanded Stg_Channel_MDS\" = Table.ExpandTableColumn(",
                "    #\"Merged Queries1\", ",
                "    \"Stg_Channel_MDS\", ",
                "    {\"Vendor Name\", \"ChannelKey\"}, ",
                "    {\"Stg_Channel_MDS.Vendor Name\", \"Stg_Channel_MDS.ChannelKey\"}",
                "  ), ",
                "  #\"Added Conditional Column2\" = Table.AddColumn(",
                "    #\"Expanded Stg_Channel_MDS\", ",
                "    \"ChannelKey\", ",
                "    each ",
                "      if [Channel.UseExamPrefix] = \"1\" then",
                "        [Channel.ChannelKey]",
                "      else",
                "        [Stg_Channel_MDS.ChannelKey]",
                "  ), ",
                "  #\"Added Conditional Column3\" = Table.AddColumn(",
                "    #\"Added Conditional Column2\", ",
                "    \"VendorName\", ",
                "    each ",
                "      if [Channel.UseExamPrefix] = \"1\" then",
                "        [Channel.Vendor Name]",
                "      else",
                "        [Stg_Channel_MDS.Vendor Name]",
                "  ), ",
                "  #\"Removed Columns1\" = Table.RemoveColumns(",
                "    #\"Added Conditional Column3\", ",
                "    {",
                "      \"Channel.Vendor Name\", ",
                "      \"Channel.ChannelKey\", ",
                "      \"Stg_Channel_MDS.Vendor Name\", ",
                "      \"Stg_Channel_MDS.ChannelKey\", ",
                "      \"JoinKey\", ",
                "      \"Channel.UseExamPrefix\"",
                "    }",
                "  ), ",
                "  #\"Filtered Rows1\" = Table.SelectRows(#\"Removed Columns1\", each ([ChannelKey] <> null)), ",
                "  #\"Removed Duplicates\" = Table.Distinct(#\"Filtered Rows1\"), ",
                "  #\"Added Custom1\" = Table.AddColumn(",
                "    #\"Removed Duplicates\", ",
                "    \"ExamVendorKey\", ",
                "    each Text.Lower([Exam Number] & \" - \" & [VendorName])",
                "  ), ",
                "  #\"Renamed Columns\" = Table.RenameColumns(",
                "    #\"Added Custom1\", ",
                "    {{\"ExamPrefix\", \"Channel.Exam Number starts with\"}, {\"VendorName\", \"Vendor Name\"}}",
                "  )",
                "in",
                "  #\"Renamed Columns\""
              ]
            }
          }
        ]
      },
      {
        "name": "Stg_Channel_Offer",
        "isHidden": true,
        "columns": [
          {
            "name": "DiscountAccessCodePattern",
            "dataType": "string",
            "description": "DiscountAccessCodePattern",
            "isHidden": true,
            "sourceColumn": "DiscountAccessCodePattern",
            "isAvailableInMdx": false
          },
          {
            "name": "ExamOfferKey",
            "dataType": "string",
            "description": "ExamOfferKey",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "ExamOfferKey",
            "isAvailableInMdx": false
          },
          {
            "name": "OfferChannelKey",
            "dataType": "string",
            "description": "OfferChannelKey",
            "isHidden": true,
            "sourceColumn": "ChannelKey",
            "isAvailableInMdx": false
          }
        ],
        "partitions": [
          {
            "name": "Stg_Channel_Offer",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT SourceIdentifier AS ExamOfferKey,1 AS JoinKey",
                "FROM  [Learning].Discounts",
                "WHERE [DiscountType]='Offer'",
                "   AND ISNULL(SourceIdentifier, 'Unknown') <> 'Unknown'",
                "",
                "UNION",
                "",
                "SELECT [PromoName] AS ExamOfferKey,1 AS JoinKey",
                "FROM [Learning].[ExamParticipation] EP",
                "LEFT  JOIN ",
                "(SELECT DISTINCT SourceIdentifier",
                "FROM  [Learning].Discounts",
                "WHERE [DiscountType]='Offer'",
                ") BB",
                "ON BB.SourceIdentifier = EP.PromoName",
                "WHERE BB.SourceIdentifier IS NULL",
                "AND ISNULL([PromoName],'') <>''",
                "\"]",
                "  ), ",
                "  #\"Merged Queries\" = Table.NestedJoin(",
                "    Source, ",
                "    {\"JoinKey\"}, ",
                "    Stg_Channel_MDS, ",
                "    {\"JoinKey\"}, ",
                "    \"Channel\", ",
                "    JoinKind.LeftOuter",
                "  ), ",
                "  #\"Expanded Channel\" = Table.ExpandTableColumn(",
                "    #\"Merged Queries\", ",
                "    \"Channel\", ",
                "    {\"ChannelKey\", \"UseDiscountAccessCode\", \"DiscountAccessCodePattern\"}, ",
                "    {\"Channel.ChannelKey\", \"Channel.UseDiscountAccessCode\", \"Channel.DiscountAccessCodePattern\"}",
                "  ), ",
                "  #\"Filtered Rows1\" = Table.SelectRows(",
                "    #\"Expanded Channel\", ",
                "    each ([Channel.UseDiscountAccessCode] = \"1\")",
                "  ), ",
                "  #\"Added Custom1\" = Table.AddColumn(",
                "    #\"Filtered Rows1\", ",
                "    \"DiscountAccessCodePattern\", ",
                "    each [Channel.DiscountAccessCodePattern]",
                "  ), ",
                "  #\"Lowercased Text\" = Table.TransformColumns(",
                "    #\"Added Custom1\", ",
                "    {{\"Channel.DiscountAccessCodePattern\", Text.Lower, type text}}",
                "  ), ",
                "  #\"Split Column by Delimiter\" = Table.SplitColumn(",
                "    #\"Lowercased Text\", ",
                "    \"Channel.DiscountAccessCodePattern\", ",
                "    Splitter.SplitTextByDelimiter(\"%\", QuoteStyle.Csv), ",
                "    {",
                "      \"Channel.DiscountAccessCodePattern.1\", ",
                "      \"Channel.DiscountAccessCodePattern.2\", ",
                "      \"Channel.DiscountAccessCodePattern.3\", ",
                "      \"Channel.DiscountAccessCodePattern.4\", ",
                "      \"Channel.DiscountAccessCodePattern.5\", ",
                "      \"Channel.DiscountAccessCodePattern.6\", ",
                "      \"Channel.DiscountAccessCodePattern.7\", ",
                "      \"Channel.DiscountAccessCodePattern.8\"",
                "    }",
                "  ), ",
                "  #\"Replaced Value\" = Table.ReplaceValue(",
                "    #\"Split Column by Delimiter\", ",
                "    null, ",
                "    \"\", ",
                "    Replacer.ReplaceValue, ",
                "    {",
                "      \"Channel.DiscountAccessCodePattern.1\", ",
                "      \"Channel.DiscountAccessCodePattern.2\", ",
                "      \"Channel.DiscountAccessCodePattern.3\", ",
                "      \"Channel.DiscountAccessCodePattern.4\", ",
                "      \"Channel.DiscountAccessCodePattern.5\", ",
                "      \"Channel.DiscountAccessCodePattern.6\", ",
                "      \"Channel.DiscountAccessCodePattern.7\", ",
                "      \"Channel.DiscountAccessCodePattern.8\"",
                "    }",
                "  ), ",
                "  #\"Duplicated Column\" = Table.DuplicateColumn(#\"Replaced Value\", \"ExamOfferKey\", \"ExamOffer\"), ",
                "  #\"Lowercased Text1\" = Table.TransformColumns(",
                "    #\"Duplicated Column\", ",
                "    {{\"ExamOffer\", Text.Lower, type text}}",
                "  ), ",
                "  #\"Added Custom\" = Table.AddColumn(",
                "    #\"Lowercased Text1\", ",
                "    \"FilterCondition\", ",
                "    each Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.1])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.2])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.3])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.4])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.5])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.6])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.7])",
                "      and Text.Contains([ExamOffer], [Channel.DiscountAccessCodePattern.8])",
                "  ), ",
                "  #\"Filtered Rows\" = Table.SelectRows(#\"Added Custom\", each ([FilterCondition] = true)), ",
                "  #\"Removed Other Columns\" = Table.SelectColumns(",
                "    #\"Filtered Rows\", ",
                "    {\"ExamOfferKey\", \"Channel.ChannelKey\", \"DiscountAccessCodePattern\"}",
                "  ), ",
                "  #\"Renamed Columns\" = Table.RenameColumns(",
                "    #\"Removed Other Columns\", ",
                "    {{\"Channel.ChannelKey\", \"ChannelKey\"}}",
                "  ), ",
                "  #\"Removed Duplicates\" = Table.Distinct(#\"Renamed Columns\")",
                "in",
                "  #\"Removed Duplicates\""
              ]
            }
          }
        ]
      },
      {
        "name": "MCT Geography",
        "description": "MCT Geography",
        "lineageTag": "369ceb4f-df0e-495e-8cd7-296244b34976",
        "columns": [
          {
            "name": "GeographyKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "GeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "348dec3a-ce81-43e8-ac20-236113f4d17f"
          },
          {
            "name": "Big Area",
            "dataType": "string",
            "description": "Big Area",
            "sourceColumn": "Big Area",
            "lineageTag": "c1b13932-f30d-44a3-971a-d55c791ccc7b"
          },
          {
            "name": "Area",
            "dataType": "string",
            "description": "Area",
            "sourceColumn": "Area",
            "lineageTag": "29f6dade-466f-4adb-8454-6c70e14da839"
          },
          {
            "name": "Region",
            "dataType": "string",
            "description": "Region",
            "sourceColumn": "Region",
            "lineageTag": "70da1c1b-3e9c-4c4c-a4c2-b81da864a128"
          },
          {
            "name": "Sub Region",
            "dataType": "string",
            "description": "Sub Region",
            "sourceColumn": "Sub Region",
            "lineageTag": "4b6ddf60-9827-4f25-82d7-9e1e5a756bd9"
          },
          {
            "name": "Subsidiary",
            "dataType": "string",
            "description": "Subsidiary",
            "sourceColumn": "Subsidiary",
            "lineageTag": "a4229492-a611-4b0c-b05a-eb7fd10ffd0c"
          },
          {
            "name": "Country",
            "dataType": "string",
            "description": "Country",
            "sourceColumn": "Country",
            "lineageTag": "a721f926-17d4-48ac-9fb9-8dc637027eda"
          },
          {
            "name": "CountryCode",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "CountryCode",
            "isAvailableInMdx": false,
            "lineageTag": "c7f5a08a-5fd1-4c39-8221-9e2c226ba951"
          },
          {
            "name": "Area4",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Big Area",
            "lineageTag": "2aceb758-6e3f-4c5d-997e-83ca765a9b3e"
          },
          {
            "name": "Area15",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Area",
            "isAvailableInMdx": false,
            "lineageTag": "efc1b213-e92b-49f6-b4f4-7012bccc5da6"
          }
        ],
        "partitions": [
          {
            "name": "MCT Geography",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT GeographyID AS GeographyKey",
                "    ,ISNULL(BigArea, 'Unknown') AS [Big Area]",
                "    ,ISNULL(Area, 'Unknown') AS Area",
                "    ,ISNULL(Region, 'Unknown') AS Region",
                "    ,ISNULL(SubRegion, 'Unknown') AS [Sub Region]",
                "    ,ISNULL(Subsidiary, 'Unknown') AS Subsidiary",
                "    ,ISNULL(CountryName, 'Unknown') AS Country",
                "    ,ISNULL(CountryCode, 'Unknown') AS CountryCode",
                "FROM [Learning].[Geographies]",
                "WHERE GeographyID <> 'Unknown'",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS GeographyKey",
                "    ,'Unknown' AS [Big Area]",
                "    ,'Unknown' AS Area",
                "    ,'Unknown' AS Region",
                "    ,'Unknown' AS [Sub Region]",
                "    ,'Unknown' AS Subsidiary",
                "    ,'Unknown' AS Country",
                "    ,'Unknown' AS CountryCode",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "MCT Geography Hierarchy",
            "lineageTag": "fae1507f-0e05-4248-8805-04655091fd44",
            "levels": [
              {
                "name": "Big Area",
                "ordinal": 0,
                "column": "Big Area",
                "lineageTag": "57a65a23-7dd1-48ea-9d92-5b2969711227"
              },
              {
                "name": "Area4",
                "ordinal": 1,
                "column": "Area4",
                "lineageTag": "47745700-27f2-471d-a5af-629df58896bc"
              },
              {
                "name": "Area",
                "ordinal": 2,
                "column": "Area",
                "lineageTag": "bb9ebe94-d972-4272-b8f7-870f296e9f2b"
              },
              {
                "name": "Region",
                "ordinal": 3,
                "column": "Region",
                "lineageTag": "689f6837-4198-440e-af69-f3ed74fd0b4d"
              },
              {
                "name": "Sub Region",
                "ordinal": 4,
                "column": "Sub Region",
                "lineageTag": "d0c19205-e9dc-4523-804e-99b059519588"
              },
              {
                "name": "Subsidiary",
                "ordinal": 5,
                "column": "Subsidiary",
                "lineageTag": "9547d1d4-865e-43a3-9346-101700bc2472"
              },
              {
                "name": "Country",
                "ordinal": 6,
                "column": "Country",
                "lineageTag": "e42fcdbb-6fe9-4c20-9324-c1bfc49ba453"
              }
            ]
          }
        ]
      },
      {
        "name": "IsAcademic PersonID",
        "isHidden": true,
        "columns": [
          {
            "name": "Flag",
            "dataType": "string",
            "description": "Flag",
            "isHidden": true,
            "sourceColumn": "Flag",
            "isAvailableInMdx": false
          },
          {
            "name": "EmailAddressDomain_Trim",
            "dataType": "string",
            "description": "EmailAddressDomain_Trim",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "EmailAddressDomain_Trim",
            "isAvailableInMdx": false
          }
        ],
        "partitions": [
          {
            "name": "IsAcademic PersonID",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT EmailAddressDomain",
                ",LOWER(TRIM(EmailAddressDomain)) AS EmailAddressDomain_Trim ",
                "FROM Learning.PersonDetails AS P",
                "JOIN (",
                "   VALUES",
                "     ('%.edu'),             ('%.edu.%'),",
                "     ('%.ac'),              ('%.ac.%'),",
                "     ('%.sch'),             ('%.sch.%'),",
                "     ('%.school'),          ('%.school.%'),",
                "     ('%.k12.[a-z][a-z].us'),",
                "     ('%.g12.br'),          ('%.vgs.no'),",
                "     ('%.educanet2.ch'),    ('%.edunet.tn'),",
                "     ('%.go.kr'),           ('%.or.kr'),",
                "     ('%.prof.pr'),         ('%.res.in')",
                ") AS s(pat)",
                "  ON LOWER(EmailAddressDomain) LIKE s.pat",
                "  Where SourceSystem ='Learn'",
                "\"",
                "    ]",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(Source, {{\"EmailAddressDomain_Trim\", type text}}), ",
                "  #\"Added CheckForKeyword\" = Table.AddColumn(",
                "    #\"Changed Type\", ",
                "    \"CheckForKeyword\", ",
                "    each List.Transform(",
                "      EduMDSMapping[Title_Trim], ",
                "      (x) => Text.EndsWith([EmailAddressDomain_Trim], x, Comparer.OrdinalIgnoreCase)",
                "    )",
                "  ), ",
                "  #\"Added Contains_Keyword\" = Table.AddColumn(",
                "    #\"Added CheckForKeyword\", ",
                "    \"Contains_Keyword\", ",
                "    each List.AnyTrue([CheckForKeyword])",
                "  ), ",
                "  #\"Removed Columns\" = Table.RemoveColumns(#\"Added Contains_Keyword\", {\"CheckForKeyword\"}), ",
                "  #\"Filtered Rows\" = Table.SelectRows(#\"Removed Columns\", each ([Contains_Keyword] = true)), ",
                "  #\"Renamed Columns\" = Table.RenameColumns(#\"Filtered Rows\", {{\"Contains_Keyword\", \"Flag\"}}), ",
                "  #\"Removed Duplicates\" = Table.Distinct(#\"Renamed Columns\", {\"EmailAddressDomain_Trim\"})",
                "in",
                "  #\"Removed Duplicates\""
              ]
            }
          }
        ]
      },
      {
        "name": "EduMDSMapping",
        "isHidden": true,
        "columns": [
          {
            "name": "Title_Trim",
            "dataType": "string",
            "description": "Title_Trim",
            "isHidden": true,
            "sourceColumn": "Title_Trim",
            "isAvailableInMdx": false
          }
        ],
        "partitions": [
          {
            "name": "EduMDSMapping",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Tables(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting\", ",
                "    [Implementation = null, ApiVersion = 15]",
                "  ), ",
                "  #\"dd979b48-1f75-4516-8f79-3cb0e7d33a48\" = Source",
                "    {[Id = \"dd979b48-1f75-4516-8f79-3cb0e7d33a48\"]}",
                "    [Items], ",
                "  #\"Removed Other Columns\" = Table.SelectColumns(#\"dd979b48-1f75-4516-8f79-3cb0e7d33a48\", {\"Title\"}), ",
                "  #\"Added Custom\" = Table.AddColumn(#\"Removed Other Columns\", \"Title_Trim\", each Text.Trim([Title])), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(",
                "    #\"Added Custom\", ",
                "    {{\"Title\", type text}, {\"Title_Trim\", type text}}",
                "  ), ",
                "  Custom1 = Table.Buffer(#\"Changed Type\"), ",
                "  #\"Lowercased Text\" = Table.TransformColumns(Custom1, {{\"Title_Trim\", Text.Lower, type text}})",
                "in",
                "  #\"Lowercased Text\""
              ]
            }
          }
        ]
      },
      {
        "name": "WWL Data Status",
        "description": "WWL Data Status",
        "lineageTag": "c1d8ae56-ae1f-4db9-aa93-670ad9a8bcf5",
        "columns": [
          {
            "name": "Last Updated Date On",
            "dataType": "dateTime",
            "description": "Last Updated Date On",
            "sourceColumn": "Last Updated Date On",
            "formatString": "yyyy-MM-dd hh:mm AM/PM",
            "lineageTag": "fae235a6-ee59-46e6-a065-e658a90b1c20"
          },
          {
            "name": "Subject Area",
            "dataType": "string",
            "description": "Subject Area",
            "sourceColumn": "SubjectArea",
            "lineageTag": "c5d83380-e407-4a6a-ab7c-f3891d75ec4e"
          }
        ],
        "partitions": [
          {
            "name": "WWL Data Status",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT MAX(CAST(EtlUpdateDateTime AS DATETIME)) AS [Last Updated Date On]",
                "    ,'Certification' AS SubjectArea",
                "FROM [Learning].[LearnerCertifications]",
                " ",
                "UNION",
                " ",
                "SELECT MAX(CAST(EtlUpdateDateTime AS DATETIME)) AS [Last Updated Date On]",
                "    ,'Exam' AS SubjectArea",
                "FROM [Learning].[ExamParticipation]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "WWL Data Dictionary",
        "description": "WWL Data Dictionary",
        "columns": [
          {
            "name": "Metric",
            "dataType": "string",
            "description": "Metric",
            "sourceColumn": "Metric",
            "lineageTag": "083e975a-ebd0-402a-ac70-fbcde38f849b"
          },
          {
            "name": "Definition",
            "dataType": "string",
            "description": "Definition",
            "sourceColumn": "Definition",
            "lineageTag": "f036d301-fa4b-4c36-bac7-3acc57a5a361"
          }
        ],
        "partitions": [
          {
            "name": "WWL Data Dictionary",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Files(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting/\", ",
                "    [ApiVersion = 15]",
                "  ), ",
                "  #\"Global_Dictionary_FY23 xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/\"",
                "    = Source",
                "    {",
                "      [",
                "        Name           = \"Global_Dictionary_FY23.xlsx\", ",
                "        #\"Folder Path\" = \"https://microsoft.sharepoint.com/teams/WWLReporting/Shared Documents/\"",
                "      ]",
                "    }",
                "    [Content], ",
                "  #\"Imported Excel Workbook\" = Excel.Workbook(",
                "    #\"Global_Dictionary_FY23 xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/\"",
                "  ), ",
                "  Table16_Table = #\"Imported Excel Workbook\"{[Item = \"Table16\", Kind = \"Table\"]}[Data]",
                "in",
                "  Table16_Table"
              ]
            }
          }
        ]
      },
      {
        "name": "Time",
        "description": "Time",
        "lineageTag": "0fa6aaed-763d-410e-b18b-38068e8c15b2",
        "columns": [
          {
            "name": "Calendar Month Digital",
            "dataType": "string",
            "description": "Calendar Month Digital",
            "isHidden": true,
            "sourceColumn": "Calendar Month Digital"
          },
          {
            "name": "Calendar Month",
            "dataType": "string",
            "description": "Calendar Month",
            "sourceColumn": "Calendar Month",
            "sortByColumn": "Calendar Year Month Order"
          },
          {
            "name": "Calendar Quarter",
            "dataType": "string",
            "description": "Calendar Quarter",
            "sourceColumn": "Calendar Quarter"
          },
          {
            "name": "Calendar Semester",
            "dataType": "string",
            "description": "Calendar Semester",
            "sourceColumn": "Calendar Semester"
          },
          {
            "name": "Calendar Year",
            "dataType": "string",
            "description": "Calendar Year",
            "sourceColumn": "Calendar Year"
          },
          {
            "name": "Calendar Year Month Order",
            "dataType": "int64",
            "description": "Calendar Year Month Order",
            "isHidden": true,
            "sourceColumn": "Calendar Year Month Number"
          },
          {
            "name": "Date",
            "dataType": "dateTime",
            "description": "Date",
            "isHidden": true,
            "sourceColumn": "Date",
            "formatString": "yyyy-MM-dd"
          },
          {
            "name": "DateKey",
            "dataType": "int64",
            "description": "DateKey",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "Date Key",
            "isAvailableInMdx": false
          },
          {
            "name": "Fiscal Month",
            "dataType": "string",
            "description": "Fiscal Month",
            "sourceColumn": "Fiscal Month",
            "sortByColumn": "Fiscal Month Start Date"
          },
          {
            "name": "Fiscal Month Digital",
            "dataType": "string",
            "description": "Fiscal Month Digital",
            "isHidden": true,
            "sourceColumn": "Fiscal Month Digital",
            "isAvailableInMdx": false
          },
          {
            "name": "Fiscal Month Start Date",
            "dataType": "dateTime",
            "description": "Fiscal Month Start Date",
            "sourceColumn": "Fiscal Month Start Date"
          },
          {
            "name": "Fiscal Quarter",
            "dataType": "string",
            "description": "Fiscal Quarter",
            "sourceColumn": "Fiscal Quarter"
          },
          {
            "name": "Fiscal Semester",
            "dataType": "string",
            "description": "Fiscal Semester",
            "sourceColumn": "Fiscal Semester"
          },
          {
            "name": "Fiscal Short Month",
            "dataType": "string",
            "description": "Fiscal Short Month",
            "isHidden": true,
            "sourceColumn": "Fiscal Short Month",
            "isAvailableInMdx": false,
            "sortByColumn": "Fiscal Year Month Order"
          },
          {
            "name": "Fiscal Week",
            "dataType": "dateTime",
            "description": "Fiscal Week",
            "sourceColumn": "WeekStartDate"
          },
          {
            "name": "Fiscal Year",
            "dataType": "string",
            "description": "Fiscal Year",
            "sourceColumn": "Fiscal Year"
          },
          {
            "name": "Fiscal Year Month Order",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "Fiscal Year Month Order",
            "lineageTag": "36cd316b-627d-4b42-b55a-d5a1a09ec83a"
          }
        ],
        "partitions": [
          {
            "name": "Time",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "DECLARE @TodayDate DATE = GETDATE();",
                "DECLARE @NextFiscalYearEnd DATE;",
                "",
                "IF MONTH(@TodayDate) > 6",
                "    SET @NextFiscalYearEnd = DATEFROMPARTS(YEAR(@TodayDate) + 2, 6, 30);",
                "ELSE",
                "    SET @NextFiscalYearEnd = DATEFROMPARTS(YEAR(@TodayDate) + 1, 6, 30);",
                "",
                "SELECT [CalendarDateCode] AS [Date Key]",
                "    ,FORMAT(TRY_CONVERT(DATE, [CalendarDate]), 'M/d/yyyy') AS [Date]",
                "    ,CONCAT (",
                "        'CY'",
                "        ,RIGHT([CalendarYear], 2)",
                "        ) AS [Calendar Year]",
                "    ,CONCAT (",
                "        'CY'",
                "        ,RIGHT([CalendarYear], 2)",
                "        ,'-H'",
                "        ,CASE ",
                "            WHEN [CalendarMonthCode] >= 7",
                "                THEN 2",
                "            ELSE 1",
                "            END",
                "        ) AS [Calendar Semester]",
                "    ,CONCAT (",
                "        'CY'",
                "        ,RIGHT([CalendarYear], 2)",
                "        ,'-Q'",
                "        ,(([CalendarMonthCode] - 1) / 3 + 1)",
                "        ) AS [Calendar Quarter]",
                "    ,CONCAT (",
                "        'CY'",
                "        ,RIGHT([CalendarYear], 2)",
                "        ,'-'",
                "        ,LEFT([CalendarMonth], 3)",
                "        ) AS [Calendar Month]",
                "    ,[GregorianMonthCode] AS [Calendar Year Month Number]",
                "    ,[FiscalYearCode] AS [Fiscal Year]",
                "    ,[FiscalSemester] AS [Fiscal Semester]",
                "    ,[FiscalQuarter] AS [Fiscal Quarter]",
                "    ,CONCAT (",
                "        [FiscalYearCode]",
                "        ,'-'",
                "        ,LEFT([FiscalMonthName], 3)",
                "        ) AS [Fiscal Month]",
                "    ,LEFT([FiscalMonthName], 3) AS [Fiscal Short Month]",
                "    ,[FiscalYearMonthNumber] AS [Fiscal Year Month Order]",
                "    ,FORMAT(TRY_CONVERT(DATE, DATEADD(dd, - (DATEPART(dw, [CalendarDate]) - 2), [CalendarDate])), 'M/d/yyyy') AS [WeekStartDate]",
                "    ,CONCAT (",
                "        'CY'",
                "        ,RIGHT([CalendarYear], 2)",
                "        ,'-'",
                "        ,MONTH([CalendarDate])",
                "        ) AS [Calendar Month Digital]",
                "    ,CONCAT (",
                "        FiscalYearCode",
                "        ,'-'",
                "        ,FiscalYearMonthNumber",
                "        ) AS [Fiscal Month Digital]",
                "    ,FORMAT(TRY_CONVERT(DATE, [FiscalMonthStartDate]), 'M/d/yyyy') AS [Fiscal Month Start Date]",
                "FROM [Learning].[Calendar]",
                "WHERE TRY_CONVERT(DATE, [CalendarDate]) <= @NextFiscalYearEnd",
                "    AND TRY_CONVERT(DATE, [CalendarDate]) >= '2018-07-01'",
                "",
                "UNION ALL",
                "",
                "SELECT 19000101 AS [Date Key]",
                "    ,'1/1/1900' AS [Date]",
                "    ,'CY99' AS [Calendar Year]",
                "    ,'CY99-H1' AS [Calendar Semester]",
                "    ,'CY99-Q1' AS [Calendar Quarter]",
                "    ,'CY99-Jul' AS [Calendar Month]",
                "    ,0 AS [Calendar Year Month Number]",
                "    ,'FY99' AS [Fiscal Year]",
                "    ,'FY99-Jul' AS [Fiscal Semester]",
                "    ,'FY99-Q3' AS [Fiscal Quarter]",
                "    ,'FY99-Jul' AS [Fiscal Month]",
                "    ,'Jul' AS [Fiscal Short Month]",
                "    ,7 AS [Fiscal Year Month Order]",
                "    ,'1/1/1900' AS [WeekStartDate]",
                "    ,'CY99-1' AS [Calendar Month Digital]",
                "    ,'FY99-1' AS [Fiscal Month Digital]",
                "    ,'1/1/1900' AS [Fiscal Month Start Date]",
                "",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "Calendar Hierarchy",
            "lineageTag": "bb5b80e8-a7d0-4802-952a-82ae67d7e46f",
            "levels": [
              {
                "name": "Calendar Year",
                "ordinal": 0,
                "column": "Calendar Year",
                "lineageTag": "5c10839b-b106-4558-a32e-207b7188a4c7"
              },
              {
                "name": "Calendar Semester",
                "ordinal": 1,
                "column": "Calendar Semester",
                "lineageTag": "d711979f-6de9-456f-9c60-8f656eb3d067"
              },
              {
                "name": "Calendar Quarter",
                "ordinal": 2,
                "column": "Calendar Quarter",
                "lineageTag": "d66b6f76-60e5-4339-8acc-4d48164dc692"
              },
              {
                "name": "Calendar Month",
                "ordinal": 3,
                "column": "Calendar Month",
                "lineageTag": "0911282c-7bfc-4c24-9f1d-9497eadde507"
              },
              {
                "name": "Date",
                "ordinal": 4,
                "column": "Date",
                "lineageTag": "d2b55e60-1606-4f81-9ca6-bdde6f8765e8"
              }
            ]
          },
          {
            "name": "Fiscal Hierarchy",
            "lineageTag": "d0d340da-35ad-45e1-a9d5-e6ffe1389be8",
            "levels": [
              {
                "name": "Fiscal Year",
                "ordinal": 0,
                "column": "Fiscal Year",
                "lineageTag": "03687dc6-54d9-4072-8201-7ab5086dc93a"
              },
              {
                "name": "Fiscal Semester",
                "ordinal": 1,
                "column": "Fiscal Semester",
                "lineageTag": "76eadf6b-2e4d-4952-a747-ecde8c55314a"
              },
              {
                "name": "Fiscal Quarter",
                "ordinal": 2,
                "column": "Fiscal Quarter",
                "lineageTag": "7b484cde-5ea3-4de6-b8c9-c4657db623b9"
              },
              {
                "name": "Fiscal Month",
                "ordinal": 3,
                "column": "Fiscal Month",
                "lineageTag": "1a7cfce9-c99d-448c-9903-0e57eaa2c9b7"
              },
              {
                "name": "Date",
                "ordinal": 4,
                "column": "Date",
                "lineageTag": "c12bc233-f9cc-4dc3-9175-799b854389b9"
              }
            ]
          }
        ]
      },
      {
        "name": "Assessment",
        "lineageTag": "e04d24f0-616f-4e77-abb8-5320fbc06bdb",
        "columns": [
          {
            "name": "Assessment ID",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "AssessmentID",
            "lineageTag": "51bc7fc6-5978-4d5f-8c29-99914a0aaba4",
            "summarizeBy": "none"
          },
          {
            "name": "Assessment Status",
            "dataType": "string",
            "sourceColumn": "AssessmentStatus",
            "lineageTag": "830d935c-88f2-44e0-a940-9a270551c2fc",
            "summarizeBy": "none"
          },
          {
            "name": "Assessment Title",
            "dataType": "string",
            "sourceColumn": "AssessmentTitle",
            "lineageTag": "b28d2392-2292-4290-831c-6495c9f937ee"
          },
          {
            "name": "Attempts",
            "dataType": "int64",
            "sourceColumn": "Attempts",
            "lineageTag": "9b0a3fc9-796c-45cf-bd74-bf18adfa35cf",
            "summarizeBy": "none"
          },
          {
            "name": "DateKey",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "DateKey",
            "lineageTag": "1e673108-1867-448b-8da6-14f703bb70e4",
            "summarizeBy": "none"
          },
          {
            "name": "Exam ID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamID",
            "lineageTag": "cbc52cad-8f52-42d3-9b20-89e5719c4d53"
          },
          {
            "name": "Exam Number",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamNumber",
            "lineageTag": "f0c04b30-23b7-4098-b646-58fc50c33d34"
          },
          {
            "name": "Exam Score",
            "dataType": "int64",
            "sourceColumn": "ExamScore",
            "lineageTag": "b7ff7235-93bd-4160-b34d-7f2cf1acd1a4",
            "summarizeBy": "none"
          },
          {
            "name": "Locale",
            "dataType": "string",
            "sourceColumn": "Locale",
            "lineageTag": "d113816f-2a06-49d4-a0f2-cc122b0f73e0"
          },
          {
            "name": "Participation ID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ParticipationID",
            "lineageTag": "a0ed43c7-d8ff-4c58-bf25-f1fa6fc2986a"
          },
          {
            "name": "PersonDetailsID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonDetailsID",
            "lineageTag": "1db01a58-5f87-44c1-84ed-34a9a13efc6c"
          },
          {
            "name": "Score Required",
            "dataType": "int64",
            "sourceColumn": "ScoreRequired",
            "lineageTag": "1f955c17-9e30-4d33-9619-c13f9ac6cb4a",
            "summarizeBy": "none"
          },
          {
            "name": "Session Date",
            "dataType": "dateTime",
            "sourceColumn": "SessionDate",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "4ff43b51-95b1-4daf-a84f-c3e00d31f66b"
          },
          {
            "name": "Session DateTime",
            "dataType": "dateTime",
            "sourceColumn": "SessionDateTime",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "5656ba93-423f-4235-beb4-ad39249ace65"
          },
          {
            "type": "calculated",
            "name": "Language",
            "dataType": "string",
            "isDataTypeInferred": true,
            "expression": "RELATED ( 'Language Mapping'[Locale] )",
            "lineageTag": "cea544a1-9ea7-4aae-a259-a6d76ff1eace"
          },
          {
            "name": "AttemptsUpdated",
            "dataType": "string",
            "sourceColumn": "AttemptsUpdated",
            "sortByColumn": "SortAttempts",
            "lineageTag": "fa423b34-3c2a-4b7f-9f1e-ef2d3b95a096",
            "summarizeBy": "none"
          },
          {
            "name": "SortAttempts",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "SortAttempts",
            "lineageTag": "45ddecce-86d3-4420-8734-610e5d745971"
          },
          {
            "name": "RankAttempts",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "RankAttempts",
            "lineageTag": "1f96882d-9da5-4765-ac1b-666686234ced"
          },
          {
            "name": "SortRankAttempts",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "SortRankAttempts",
            "lineageTag": "36ba0204-4b12-4514-b8a1-be1edb3f12b5"
          },
          {
            "name": "AttemptNumber",
            "dataType": "string",
            "sourceColumn": "AttemptNumber",
            "sortByColumn": "SortRankAttempts",
            "lineageTag": "1a1d24a8-8d41-426e-a648-aa383922c8ed"
          },
          {
            "name": "GlobalPersonID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonID",
            "lineageTag": "89b16c3e-62b8-43cc-b412-2f10f146dc06"
          },
          {
            "name": "UserProfileGeographyKey",
            "dataType": "string",
            "description": "UserProfileGeographyKey",
            "isHidden": true,
            "sourceColumn": "UserProfileGeographyKey",
            "lineageTag": "e5e53ad8-4de7-48a8-894e-7b72e44ee857"
          }
        ],
        "partitions": [
          {
            "name": "Assessment",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "WITH CTE_Attempts",
                "AS (",
                "    SELECT PersonDetailsID",
                "        ,ExamID",
                "        ,COUNT([PracticeExamParticipationID]) AS [Count]",
                "    FROM [Learning].[PracticeExamParticipation]",
                "    WHERE SourceSystem = 'Learn'",
                "        AND ExamStartTime >= '2020-07-01'",
                "        AND ExamNumber NOT LIKE '%TEST'",
                "        AND PersonDetailsID IS NOT NULL",
                "    GROUP BY PersonDetailsID",
                "        ,ExamID",
                "    )",
                "    ,CTE_UnknownUserattempts",
                "AS (",
                "    SELECT ExamID",
                "        ,COUNT([PracticeExamParticipationID]) AS [Count]",
                "    FROM [Learning].[PracticeExamParticipation]",
                "    WHERE SourceSystem = 'Learn'",
                "        AND ExamStartTime >= '2020-07-01'",
                "        AND ExamNumber NOT LIKE '%TEST'",
                "        AND PersonDetailsID IS NULL",
                "    GROUP BY ExamID",
                "    )",
                "    ,CTE_DUMMY",
                "AS (",
                "    SELECT MAX(ExamNumber) AS ExamNumber",
                "        ,AssessmentID",
                "    FROM [Learning].[PracticeExamParticipation]",
                "    WHERE ExamNumber IS NOT NULL",
                "        AND ExamNumber <> 'DU-MMY'",
                "    GROUP BY AssessmentID",
                "    )",
                "    ,CTE_Base",
                "AS (",
                "    SELECT PE.[PracticeExamParticipationID]",
                "        ,PE.PersonDetailsID",
                "        ,PE.PersonID",
                "        ,PE.ExamID",
                "        ,CASE ",
                "            WHEN PE.[ExamNumber] = 'DU-MMY'",
                "                THEN DY.ExamNumber",
                "            ELSE PE.[ExamNumber]",
                "            END AS ExamNumber",
                "        ,PE.AssessmentID",
                "        ,PE.ExamStartTime",
                "        ,PE.ExamScore",
                "        ,PE.ExamPassingScore",
                "        ,PE.[IsPassed]",
                "        ,PE.Locale",
                "        ,PE.ExamName",
                "        ,ISNULL(A.[Count], UUA.[Count]) AS [Attempts]",
                "    FROM [Learning].[PracticeExamParticipation] PE",
                "    LEFT JOIN CTE_Attempts A ON A.PersonDetailsID = PE.PersonDetailsID",
                "        AND PE.ExamID = A.ExamID",
                "    LEFT JOIN CTE_UnknownUserattempts UUA ON UUA.ExamID = PE.ExamID",
                "        AND PE.PersonDetailsID IS NULL",
                "    LEFT JOIN CTE_DUMMY AS DY ON PE.AssessmentID = DY.AssessmentID",
                "    WHERE SourceSystem = 'Learn'",
                "        AND PE.ExamStartTime >= '2020-07-01'",
                "        AND PE.ExamNumber NOT LIKE '%TEST'",
                "    )",
                " --   CTE_SFD",
                "--AS (",
                "  --  SELECT DomainName",
                "    --    ,A.TPID",
                "    --FROM [Operations].[SafelistedDomains]SFD",
                "    --INNER JOIN [Learning].[Accounts] A ON A.AccountID = CAST(SFD.TPID AS NVARCHAR(255))",
                "      --  AND A.TPID = SFD.TPID",
                "   -- )",
                "SELECT ISNULL(PE.[PracticeExamParticipationID], 'Unknown') AS ParticipationID",
                "    ,ISNULL(PE.PersonDetailsID, 'Unknown') AS PersonDetailsID",
                "    ,ISNULL(PE.PersonID, 'Unknown') AS PersonID",
                "    ,ISNULL(PE.ExamID, 'Unknown') AS ExamID",
                "    ,ISNULL(PE.[ExamNumber], 'Unknown') AS ExamNumber",
                "    ,ISNULL(G.GeographyID, 'Unknown') AS UserProfileGeographyKey",
                " --   ,COALESCE(A.AccountID, A1.AccountID, '-1') AS AccountID",
                "    ,PE.[Attempts]",
                "    ,ISNULL(PE.AssessmentID, 0) AS AssessmentID",
                "    ,ISNULL(CONCAT (",
                "            PE.[ExamNumber]",
                "            ,' '",
                "            ,ExamName",
                "            ), 'Unknown') AS AssessmentTitle",
                "    ,CASE ",
                "        WHEN PE.Locale IS NULL",
                "            THEN 'Unknown'",
                "        ELSE UPPER(PE.Locale)",
                "        END AS Locale",
                "    ,ISNULL(PE.ExamStartTime, '1900-01-01') AS SessionDateTime",
                "    ,ISNULL(CAST(PE.ExamStartTime AS DATE), '1900-01-01') AS SessionDate",
                "    ,ISNULL(CONVERT(INT, CONVERT(VARCHAR(20), CONVERT(DATE, PE.ExamStartTime), 112)), 19000101) AS [DateKey]",
                "    ,ISNULL(PE.ExamScore, 0) AS ExamScore",
                "    ,ISNULL(PE.ExamPassingScore, 0) AS ScoreRequired",
                "    ,ISNULL(PE.[IsPassed], 'No') AS AssessmentStatus",
                "    ,CASE ",
                "        WHEN PE.[Attempts] > 10",
                "            THEN 'More than 10'",
                "        ELSE CONVERT(VARCHAR, PE.[Attempts])",
                "        END AS AttemptsUpdated",
                "    ,CASE ",
                "        WHEN PE.[Attempts] > 10",
                "            THEN 11",
                "        ELSE PE.[Attempts]",
                "        END AS SortAttempts",
                "    ,PE.RankAttempts",
                "    ,CASE ",
                "        WHEN PE.RankAttempts = 0",
                "            THEN 0",
                "        WHEN PE.RankAttempts = 1",
                "            THEN 1",
                "        WHEN PE.RankAttempts = 2",
                "            THEN 2",
                "        WHEN PE.RankAttempts = 3",
                "            THEN 3",
                "        WHEN PE.RankAttempts = 4",
                "            THEN 4",
                "        WHEN PE.RankAttempts = 5",
                "            THEN 5",
                "        WHEN PE.RankAttempts = 6",
                "            THEN 6",
                "        WHEN PE.RankAttempts = 7",
                "            THEN 7",
                "        WHEN PE.RankAttempts = 8",
                "            THEN 8",
                "        WHEN PE.RankAttempts = 9",
                "            THEN 9",
                "        WHEN PE.RankAttempts = 10",
                "            THEN 10",
                "        ELSE 11",
                "        END AS SortRankAttempts",
                "    ,CASE ",
                "        WHEN PE.RankAttempts <= 10",
                "            THEN CONVERT(VARCHAR, PE.RankAttempts)",
                "        ELSE 'More than 10'",
                "        END AS AttemptNumber",
                "FROM (",
                "    SELECT *",
                "        ,RANK() OVER (",
                "            PARTITION BY PersonDetailsID",
                "            ,ExamID ORDER BY ExamStartTime",
                "            ) AS RankAttempts",
                "    FROM CTE_Base",
                "    ) PE",
                "LEFT JOIN [Learning].[PersonDetails] PD ON PD.PersonDetailsID = PE.PersonDetailsID",
                "LEFT JOIN [Learning].[Geographies] G ON G.GeographyID = PD.GeographyID",
                "--LEFT JOIN [Learning].[BridgePersonAccounts] BPA ON BPA.PersonDetailsID = PD.PersonDetailsID",
                "  --  AND BPA.SourceSystem = 'Learn'",
                "--LEFT JOIN [Operations].[BridgeOldCertLinks] BO ON BO.PersonDetailsID = PD.PersonDetailsID",
                "  --  AND BPA.PersonDetailsID IS NULL",
                "    --AND BO.PersonEmailDomain IS NOT NULL",
                "--LEFT JOIN CTE_SFD SFD ON SFD.DomainName = COALESCE(BPA.PersonEmailDomain, BO.PersonEmailDomain)",
                "--LEFT JOIN [Learning].[Accounts] A ON A.AccountID = COALESCE(CAST(SFD.TPID AS NVARCHAR(255)), BPA.AccountID)",
                "  --  AND A.TPID IS NOT NULL",
                "--LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ON CDES.PersonID = PD.PersonID",
                "  --  AND CDES.SourceSystem = 'Learn'",
                "    --AND A.AccountID IS NULL",
                "--LEFT JOIN [Learning].[Accounts] A1 ON A1.AccountID = CAST(CDES.AccountID AS NVARCHAR(255))",
                "   -- AND A1.TPID IS NOT NULL",
                "ORDER BY PE.ExamStartTime",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "Assessments Completed",
            "description": "This calculation is counting the number of rows in the 'Assessment' table. This is useful for understanding the size of the table and the number of records it contains.",
            "expression": "DISTINCTCOUNT ( 'Assessment'[Participation ID] )",
            "formatString": "#,0"
          },
          {
            "name": "Assessments Passed",
            "description": "This calculation is finding the number of assessments that have been completed. It is using the KEEPFILTERS function to ensure that only assessments with a status of 1 (indicating completion) are included in the calculation.",
            "expression": [
              "CALCULATE (",
              "    [Assessments Completed],",
              "    KEEPFILTERS ( 'Assessment'[Assessment Status] = \"Yes\" )",
              ")"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Cumulative Success Rate%",
            "description": "This calculation is used to calculate the pass rate of an assessment. It takes the maximum number of attempts from the 'Assessment' table and uses it to calculate the number of unique learners who passed the assessment (PassedCount) and the total number of unique learners who attempted the assessment (TotalCount). Finally, it divides the PassedCount by the TotalCount to get the pass rate.",
            "expression": [
              "VAR MaxCount =",
              "    MAX ( 'Assessment'[Attempts] )",
              "VAR PassedCount =",
              "    CALCULATE (",
              "        [Unique Learners],",
              "        KEEPFILTERS ( 'Assessment'[Assessment Status] = \"Yes\"",
              "            && 'Assessment'[Attempts] <= MaxCount ),",
              "        ALL (",
              "            Assessment[AttemptsUpdated],",
              "            Assessment[SortAttempts]",
              "        )",
              "    )",
              "VAR TotalCount =",
              "    CALCULATE (",
              "        [Unique Learners],",
              "        KEEPFILTERS ( 'Assessment'[Attempts] <= MaxCount ),",
              "        ALL (",
              "            Assessment[AttemptsUpdated],",
              "            Assessment[SortAttempts]",
              "        )",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        PassedCount,",
              "        TotalCount,",
              "        0",
              "    )"
            ],
            "formatString": "#,0.0%"
          },
          {
            "name": "Cumulative Unique Learners%",
            "description": "This calculation is finding the ratio of unique learners who attempted an assessment at most the maximum number of attempts, compared to the total number of unique learners who attempted the assessment. It is doing this by first finding the maximum number of attempts, then finding the number of unique learners who attempted the assessment at most the maximum number of attempts, and finally dividing that number by the total number of unique learners who attempted the assessment.",
            "expression": [
              "VAR MaxCount =",
              "    MAX ( 'Assessment'[Attempts] )",
              "VAR TotalCount =",
              "    CALCULATE (",
              "        [Unique Learners],",
              "        'Assessment'[Attempts] <= MaxCount,",
              "        ALL (",
              "            Assessment[AttemptsUpdated],",
              "            Assessment[SortAttempts]",
              "        )",
              "    )",
              "VAR TotalLearners =",
              "    CALCULATE (",
              "        [Unique Learners],",
              "        ALL ( 'Assessment'[AttemptsUpdated] ),",
              "        Assessment[SortAttempts]",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        TotalCount,",
              "        TotalLearners,",
              "        0",
              "    )"
            ],
            "formatString": "#,0.0%"
          },
          {
            "name": "Pass Rate at First Attempt%",
            "description": "This calculation is finding the pass rate percentage for assessments where the rank attempts is equal to 1. This calculation is useful for understanding the pass rate of assessments when a student has only attempted the assessment once.",
            "expression": [
              "CALCULATE (",
              "    [Pass Rate%],",
              "    KEEPFILTERS ( 'Assessment'[RankAttempts] = 1 )",
              ")"
            ],
            "formatString": "#,0.0%"
          },
          {
            "name": "Pass Rate%",
            "description": "This calculation is finding the percentage of assessments passed by dividing the number of assessments passed by the total number of assessments completed. If the number of assessments completed is not blank and the percentage of assessments passed is blank, then the calculation will return 0.",
            "expression": [
              "VAR AssessCom = [Assessments Completed]",
              "VAR PR =",
              "    DIVIDE (",
              "        [Assessments Passed],",
              "        AssessCom",
              "    )",
              "RETURN",
              "    IF (",
              "        AssessCom <> BLANK ()",
              "            && PR = BLANK (),",
              "        0,",
              "        PR",
              "    )"
            ],
            "formatString": "#,0.0%"
          },
          {
            "name": "Success Rate%",
            "description": "This calculation is finding the percentage of unique learners who have passed an assessment. It first calculates the number of unique learners who have passed the assessment, then divides that number by the total number of unique learners. If the assessment has not been completed, it returns 0.",
            "expression": [
              "VAR PassedLearners =",
              "    CALCULATE (",
              "        [Unique Learners],",
              "        KEEPFILTERS ( 'Assessment'[Assessment Status] = \"Yes\" )",
              "    )",
              "VAR SR =",
              "    DIVIDE (",
              "        PassedLearners,",
              "        [Unique Learners],",
              "        0",
              "    )",
              "RETURN",
              "    IF (",
              "        [Assessments Completed] <> BLANK ()",
              "            && SR = BLANK (),",
              "        0,",
              "        SR",
              "    )"
            ],
            "formatString": "#,0.0%",
            "lineageTag": "e85b1ee0-8029-4a96-958c-b53c69cc91cb"
          },
          {
            "name": "Unique Learners",
            "description": "This calculation is counting the number of unique Person IDs in the Assessment table. It is used to determine the total number of people that have taken an assessment.",
            "expression": "DISTINCTCOUNT ( 'Assessment'[PersonDetailsID] )",
            "formatString": "#,0",
            "lineageTag": "ea5a40d8-2e05-4a97-9b43-b59cd823028c"
          },
          {
            "name": "Unique Learners%",
            "description": "This calculation is finding the percentage of unique learners that have attempted an assessment. It is first calculating the total number of unique learners who have attempted the assessment by looking at all attempts. Then it is dividing the number of unique learners by the total number of learners who have attempted the assessment, and returning the result as a percentage.",
            "expression": [
              "VAR TotalLearners =",
              "    CALCULATE (",
              "        [Unique Learners],",
              "        ALL (",
              "            'Assessment'[AttemptsUpdated],",
              "            Assessment[SortAttempts]",
              "        )",
              "    )",
              "RETURN",
              "    DIVIDE (",
              "        [Unique Learners],",
              "        TotalLearners,",
              "        0",
              "    )"
            ],
            "formatString": "#,0.0%"
          }
        ]
      },
      {
        "name": "Language Mapping",
        "description": "Language Mapping",
        "isHidden": true,
        "columns": [
          {
            "name": "Locale",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "Locale",
            "isAvailableInMdx": false,
            "lineageTag": "8730951f-aa02-49c6-997d-698d347406ab"
          },
          {
            "name": "LCID string",
            "dataType": "string",
            "description": "Language",
            "isHidden": true,
            "sourceColumn": "LCID string",
            "isAvailableInMdx": false,
            "lineageTag": "61c5bd6a-3e42-4cd1-a1de-a94b3505283d"
          }
        ],
        "partitions": [
          {
            "name": "Language Mapping",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Files(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting/\", ",
                "    [ApiVersion = 15]",
                "  ), ",
                "  #\"Filtered Rows\" = Table.SelectRows(",
                "    Source, ",
                "    each Text.Contains([Name], \"Assessment Language Mapping\")",
                "  ), ",
                "  #\"Assessment Language Mapping xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/Assessment/Documents/\"",
                "    = #\"Filtered Rows\"",
                "    {",
                "      [",
                "        Name = \"Assessment Language Mapping.xlsx\", ",
                "        #\"Folder Path\"",
                "          = \"https://microsoft.sharepoint.com/teams/WWLReporting/Shared Documents/Assessment/Documents/\"",
                "      ]",
                "    }",
                "    [Content], ",
                "  #\"Imported Excel Workbook\" = Excel.Workbook(",
                "    #\"Assessment Language Mapping xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/Assessment/Documents/\"",
                "  ), ",
                "  Table1_Table = #\"Imported Excel Workbook\"{[Item = \"Table1\", Kind = \"Table\"]}[Data]",
                "in",
                "  Table1_Table"
              ]
            }
          }
        ]
      },
      {
        "name": "Applied Skill Task Participation",
        "isHidden": true,
        "lineageTag": "79344c38-7b9b-4fb8-a997-c08e14fb9c79",
        "columns": [
          {
            "name": "TaskName",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "TaskName",
            "lineageTag": "1af38d57-0bc6-4b6d-b70c-07e29a15f426"
          },
          {
            "name": "AppliedSkillParticipationID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillParticipationID",
            "lineageTag": "f65b18d1-5322-4334-94e1-99b03262bc8f",
            "summarizeBy": "none"
          },
          {
            "name": "AppliedSkillTaskParticipationID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillTaskParticipationID",
            "lineageTag": "9fc213de-8251-4493-909c-f6a0436e94b0",
            "summarizeBy": "none"
          }
        ],
        "partitions": [
          {
            "name": "Applied Skill Task Participation",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ASTP.AppliedSkillParticipationID",
                "    ,ASTP.TaskName",
                "    ,ASTP.AppliedSkillTaskParticipationID",
                "FROM [Learning].[AppliedSkillTaskParticipation] ASTP",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Applied Skill Participation",
        "lineageTag": "3a38023c-06ca-42d7-adac-19f5ef8cfa78",
        "columns": [
          {
            "name": "AppliedSkillParticipationID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillParticipationID",
            "lineageTag": "412bb09f-2192-4cd6-b5f1-af8a3f197db3"
          },
          {
            "name": "AppliedSkillCompletionDate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "AppliedSkillCompletionDate",
            "lineageTag": "d9797948-ab47-48d4-9fbe-5ea8f50deb56"
          },
          {
            "name": "AppliedSkillName",
            "dataType": "string",
            "sourceColumn": "AppliedSkillName",
            "lineageTag": "96befb10-ee30-49a5-8894-de2c0adb275e"
          },
          {
            "name": "AppliedSkillScore",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "AppliedSkillScore",
            "lineageTag": "441eabe2-22fe-46d3-a044-b7fbaf3c9524"
          },
          {
            "name": "AppliedSkillStartTime",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "AppliedSkillStartTime",
            "formatString": "MM-DD-YYYY",
            "lineageTag": "4b1159bd-cff8-4ef8-87de-7f88447f10f8",
            "summarizeBy": "none"
          },
          {
            "name": "AppliedSkillStatus",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillStatus",
            "lineageTag": "a9419079-62aa-4e82-b1d8-9acca02cc1f1"
          },
          {
            "name": "IsPassed",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "IsPassed",
            "lineageTag": "e8f42c3f-9b35-4fec-965c-18b979a154de"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonID",
            "lineageTag": "b8cfed43-bed9-4cff-8b7a-b269f79e839e"
          },
          {
            "name": "TotalTime",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "TotalTime",
            "lineageTag": "b890d590-b061-4b8e-bc7c-668798eb8c23"
          },
          {
            "name": "AppliedSkillEndTime",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "AppliedSkillEndTime",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "31a688b9-1656-4eb4-af59-d4ac85d6a121",
            "summarizeBy": "none"
          },
          {
            "name": "Language",
            "dataType": "string",
            "sourceColumn": "Language",
            "lineageTag": "cd8c67f5-f891-40cc-8558-065d9f6042ae"
          },
          {
            "name": "SolutionArea",
            "dataType": "string",
            "sourceColumn": "SolutionArea",
            "lineageTag": "196d4765-3acd-4467-a4b8-67d7a57011c4"
          },
          {
            "name": "StartUpDuration",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "StartUpDuration",
            "lineageTag": "f7dd127a-0b01-45b3-8e25-686ce32f430a"
          },
          {
            "name": "AppliedSkillPassingScore",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "AppliedSkillPassingScore",
            "lineageTag": "a2941027-1e2e-4d39-b617-c72f82b6283c"
          },
          {
            "name": "AppliedSkillMaxPossibleScore",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "AppliedSkillMaxPossibleScore",
            "lineageTag": "9649b64e-53c4-49e5-91b3-9ea537ccec5b"
          },
          {
            "name": "CompletionDate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "CompletionDate",
            "lineageTag": "9673626a-aef2-4e6c-a65a-dbf6cd10a14c"
          },
          {
            "name": "AppliedSkillCode",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillCode",
            "lineageTag": "8289251d-037a-40bf-87bb-c59862f6459e"
          },
          {
            "name": "AppliedSkillEarned",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "AppliedSkillEarned",
            "lineageTag": "3ed9d809-27ec-4567-9f59-7aef5783e9ab"
          },
          {
            "name": "GeographyID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "GeographyID",
            "lineageTag": "45e92f99-2d18-4ad9-84e6-1aace6378904"
          },
          {
            "name": "StartDate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "StartDate",
            "lineageTag": "c372baf8-10e6-4936-80d2-4b1c364538c7"
          },
          {
            "name": "Is AI",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Is AI",
            "lineageTag": "6a058dad-2d8f-4362-8235-540e523af787"
          },
          {
            "name": "PersonDetailsID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonDetailsID",
            "lineageTag": "72958adc-96f5-4c79-b73f-81118f0ebc92"
          }
        ],
        "partitions": [
          {
            "name": "Applied Skill Participation",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    AppliedSkill = AppliedSkill_Staging,",
                "    Merged = Table.NestedJoin(",
                "        AppliedSkill,",
                "        {\"AppliedSkillCode\"},",
                "        #\"AI Credentials\",",
                "        {\"Credential Key\"},",
                "        \"AI Credentials\",",
                "        JoinKind.LeftOuter",
                "    ),",
                "    Expanded = Table.ExpandTableColumn(",
                "        Merged,",
                "        \"AI Credentials\",",
                "        {\"Credential Key\"},",
                "        {\"AI Credentials.Credential Key\"}",
                "    ),",
                "    AddedFlag = Table.AddColumn(",
                "        Expanded,",
                "        \"Is AI\",",
                "        each if [AI Credentials.Credential Key] = null then \"No\" else \"Yes\"",
                "    ),",
                "    Final = Table.RemoveColumns(AddedFlag, {\"AI Credentials.Credential Key\"})",
                "in",
                "    Final"
              ]
            }
          }
        ]
      },
      {
        "name": "Applied Skill Task Activity Participation",
        "isHidden": true,
        "lineageTag": "1d99f42c-624a-4795-89d9-d95cfffb1324",
        "columns": [
          {
            "name": "AppliedSkillTaskActivityName",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillTaskActivityName",
            "lineageTag": "40439642-7fd2-4f95-aece-fdc5d6dee094"
          },
          {
            "name": "AppliedSkillTaskParticipationID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AppliedSkillTaskParticipationID",
            "lineageTag": "fb400781-ddad-471b-a05f-0dff8a7541e1",
            "summarizeBy": "none"
          }
        ],
        "partitions": [
          {
            "name": "Applied Skill Task Activity Participation",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ASTAP.AppliedSkillTaskParticipationID",
                "    ,ASTAP.AppliedSkillTaskActivityName",
                "FROM [Learning].[AppliedSkillTaskActivityParticipation] ASTAP",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Applied Skill Metrics",
        "description": "Applied Skill Metrics",
        "lineageTag": "fdfc648d-c214-43f8-ba66-816920e1e4dc",
        "columns": [
          {
            "name": "ExamStatusKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamStatusKey",
            "isAvailableInMdx": false,
            "lineageTag": "18146091-262a-4490-9a4d-9f05bff84f48"
          },
          {
            "name": "Exam Status",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Exam Status",
            "isAvailableInMdx": false,
            "lineageTag": "e51d8677-d4c2-4837-85c4-bdddb499f04c"
          }
        ],
        "partitions": [
          {
            "name": "Applied Skills Metrics",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "--Dummy table for grouping",
                "SELECT 'Unknown' AS [Exam Status]",
                "    ,'Unknown' AS [ExamStatusKey]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "Applied Skills Earned",
            "description": "This calculation is summing up the total number of first applied skills earned from the Applied Skill Participation table. This number represents the total number of first applied skills earned by all participants in the program.",
            "expression": "SUM ( 'Applied Skill Participation'[AppliedSkillEarned] )",
            "formatString": "#,0",
            "lineageTag": "f13a1f93-51f9-43da-a8dd-b79e6a9ec127"
          }
        ]
      },
      {
        "name": "AI Credentials",
        "isHidden": true,
        "lineageTag": "17feae29-e27b-45f7-83fe-07c83f387789",
        "columns": [
          {
            "name": "Credential Type",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Credential Type",
            "lineageTag": "e92f0181-7e65-48b2-baaa-405620915d2d"
          },
          {
            "name": "Credential Key",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Credential Key",
            "lineageTag": "d5e28515-413b-42fa-97ae-e1812f2dbee7"
          }
        ],
        "partitions": [
          {
            "name": "AI Credentials",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Tables(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting\", ",
                "    [Implementation = null, ApiVersion = 15]",
                "  ), ",
                "  #\"9585fec8-aa28-464e-bb03-ca1f00182eb5\" = Source",
                "    {[Id = \"9585fec8-aa28-464e-bb03-ca1f00182eb5\"]}",
                "    [Items], ",
                "  #\"Removed Other Columns\" = Table.SelectColumns(",
                "    #\"9585fec8-aa28-464e-bb03-ca1f00182eb5\", ",
                "    {\"Title\", \"IsAI\", \"IsExam\"}",
                "  ), ",
                "  #\"Filtered Rows\" = Table.SelectRows(",
                "    #\"Removed Other Columns\", ",
                "    each ([IsExam] = \"Yes\") and ([IsAI] = \"Yes\")",
                "  ), ",
                "  #\"Removed Other Columns1\" = Table.SelectColumns(#\"Filtered Rows\", {\"Title\"}), ",
                "  #\"Split Column by Delimiter\" = Table.SplitColumn(",
                "    #\"Removed Other Columns1\", ",
                "    \"Title\", ",
                "    Splitter.SplitTextByEachDelimiter({\":\"}, QuoteStyle.Csv, false), ",
                "    {\"Title.1\", \"Title.2\"}",
                "  ), ",
                "  #\"Added Custom\" = Table.AddColumn(",
                "    #\"Split Column by Delimiter\", ",
                "    \"Credential Type\", ",
                "    each ",
                "      if [Title.1] = \"Microsoft Certified\" then",
                "        \"Certification\"",
                "      else",
                "        (if Text.Range([Title.1], 0, 3) = \"APL\" then \"Applied Skill\" else \"Exam\")",
                "  ), ",
                "  #\"Added Custom1\" = Table.AddColumn(",
                "    #\"Added Custom\", ",
                "    \"Credential Key\", ",
                "    each ",
                "      if [Credential Type] = \"Exam\" or [Credential Type] = \"Applied Skill\" then",
                "        [Title.1]",
                "      else",
                "        Text.Trim(Text.Replace([Title.2], \"*\", \"\"))",
                "  ), ",
                "  #\"Removed Other Columns2\" = Table.SelectColumns(",
                "    #\"Added Custom1\", ",
                "    {\"Credential Type\", \"Credential Key\"}",
                "  )",
                "in",
                "  #\"Removed Other Columns2\""
              ]
            }
          }
        ]
      },
      {
        "name": "Is AI",
        "lineageTag": "f9ee00b2-3a27-4fe2-8bcc-0ef3b8baaa9a",
        "columns": [
          {
            "name": "Is AI",
            "dataType": "string",
            "sourceColumn": "Is AI",
            "lineageTag": "35f0c4da-1b1f-4f30-81aa-d7e1c1eeab03"
          }
        ],
        "partitions": [
          {
            "name": "Is AI",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = Table.FromRows(",
                "    Json.Document(",
                "      Binary.Decompress(",
                "        Binary.FromText(\"i45WikwtVorViVbyy1eKjQUA\", BinaryEncoding.Base64), ",
                "        Compression.Deflate",
                "      )",
                "    ), ",
                "    let",
                "      _t = ((type nullable text) meta [Serialized.Text = true])",
                "    in",
                "      type table [#\"Is AI\" = _t]",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(Source, {{\"Is AI\", type text}})",
                "in",
                "  #\"Changed Type\""
              ]
            }
          }
        ]
      },
      {
        "name": "Sales Group",
        "description": "Sales Group",
        "columns": [
          {
            "name": "SalesGroupHierarchyKey",
            "dataType": "int64",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "SalesGroupHierarchyKey",
            "isAvailableInMdx": false,
            "sourceProviderType": "Integer"
          },
          {
            "name": "Sales Territory",
            "dataType": "string",
            "description": "Sales Territory",
            "sourceColumn": "Sales Territory",
            "sourceProviderType": "Char"
          },
          {
            "name": "Sales Group",
            "dataType": "string",
            "description": "Sales Group",
            "sourceColumn": "Sales Group",
            "sourceProviderType": "Char"
          },
          {
            "name": "Sales Unit",
            "dataType": "string",
            "description": "Sales Unit",
            "sourceColumn": "Sales Unit",
            "sourceProviderType": "Char"
          },
          {
            "name": "Sales Team",
            "dataType": "string",
            "description": "Sales Team",
            "sourceColumn": "Sales Team",
            "sourceProviderType": "Char"
          },
          {
            "name": "ATU",
            "dataType": "string",
            "description": "ATU",
            "sourceColumn": "ATU",
            "sourceProviderType": "Char"
          }
        ],
        "partitions": [
          {
            "name": "Sales Group",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ",
                "    ISNULL(SGH.SalesGroupHierarchyID, '-1') AS [SalesGroupHierarchyKey],",
                "    ISNULL(SGH.SalesTerritoryName, 'Unknown') AS [Sales Territory],",
                "    ISNULL(SGH.SalesGroupName, 'Unknown') AS [Sales Group],",
                "    ISNULL(SGH.SalesUnitName, 'Unknown') AS [Sales Unit],",
                "    ISNULL(SGH.SalesTeamName, 'Unknown') AS [Sales Team],",
                "    ISNULL(SGH.AtuName, 'Unknown') AS ATU",
                "FROM [Learning].[SalesGroupHierarchy] SGH",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "Sales Group Hierarchy",
            "description": "Sales Group Hierarchy",
            "levels": [
              {
                "name": "Sales Group",
                "ordinal": 0,
                "description": "Sales Group",
                "column": "Sales Group"
              },
              {
                "name": "Sales Unit",
                "ordinal": 1,
                "description": "Sales Unit",
                "column": "Sales Unit"
              },
              {
                "name": "Sales Team",
                "ordinal": 2,
                "description": "Sales Team",
                "column": "Sales Team"
              },
              {
                "name": "ATU",
                "ordinal": 3,
                "description": "ATU",
                "column": "ATU"
              },
              {
                "name": "Sales Territory",
                "ordinal": 4,
                "description": "Sales Territory",
                "column": "Sales Territory"
              }
            ]
          }
        ],
        "annotations": [
          {
            "name": "_TM_ExtProp_QueryDefinition",
            "value": "SELECT *  FROM [DW].[vw_DimSalesGroupHierarchy]"
          },
          {
            "name": "_TM_ExtProp_DbTableName",
            "value": "vw_DimSalesGroupHierarchy"
          },
          {
            "name": "_TM_ExtProp_DbSchemaName",
            "value": "DW"
          },
          {
            "name": "QueryEditorSerialization",
            "value": "<?xml version=\"1.0\" encoding=\"UTF-16\"?><Gemini xmlns=\"QueryEditorSerialization\"><AnnotationContent><![CDATA[<RSQueryCommandText>SELECT *  FROM [DW].[vw_DimSalesGroupHierarchy]</RSQueryCommandText><RSQueryCommandType>Text</RSQueryCommandType><RSQueryDesignState></RSQueryDesignState>]]></AnnotationContent></Gemini>"
          }
        ]
      },
      {
        "name": "Applied Skill Happiness",
        "isHidden": true,
        "lineageTag": "3eb82730-a99c-490d-810e-948b5cb9b542",
        "columns": [
          {
            "name": "Survey Response ID",
            "dataType": "string",
            "sourceColumn": "Survey Response ID",
            "lineageTag": "c4913e3f-ffc4-46ef-82b3-54a53723e680"
          },
          {
            "name": "Survey Question Response Value",
            "dataType": "int64",
            "sourceColumn": "Survey Question Response Value",
            "lineageTag": "9450718c-bede-4dcd-9476-9ffdd2eb9683"
          },
          {
            "name": "Exam Number",
            "dataType": "string",
            "sourceColumn": "Exam Number",
            "lineageTag": "35f0cff7-6ebd-47fe-b7b5-e8892035f640"
          },
          {
            "name": "Exam Pass/Fail",
            "dataType": "int64",
            "sourceColumn": "Exam Pass/Fail",
            "lineageTag": "b10f79ed-46a3-4a19-9816-bee575661b13"
          },
          {
            "name": "Source Identifier",
            "dataType": "string",
            "sourceColumn": "Source Identifier",
            "lineageTag": "e0d02cb6-484f-4704-83c5-2d176cea2ff7"
          },
          {
            "name": "Survey Start Date Time",
            "dataType": "dateTime",
            "sourceColumn": "Survey Start Date Time",
            "lineageTag": "b6479e9b-0de5-4ad8-8a02-56e4dcfc265a"
          },
          {
            "name": "NSAT Score",
            "dataType": "int64",
            "sourceColumn": "NSAT Score",
            "lineageTag": "7e76f23a-9f5a-4741-8a41-27efe6f00da7"
          },
          {
            "name": "Date Key",
            "dataType": "int64",
            "sourceColumn": "Date Key",
            "lineageTag": "322ca394-1599-48b1-99ff-fded359e2649"
          }
        ],
        "partitions": [
          {
            "name": "Applied Skill Happiness",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ",
                "    SQR.SurveyResponseID AS [Survey Response ID],",
                "    SQR.SurveyQuestionResponseValue AS [Survey Question Response Value],",
                "    SQR.ExamNumber AS [Exam Number],",
                "    SQR.ExamPassFail AS [Exam Pass/Fail],",
                "    SQ.SourceIdentifier AS [Source Identifier],",
                "    SQR.SurveyStartDate AS [Survey Start Date Time],",
                "    ISNULL(CONVERT(VARCHAR, CAST(SQR.SurveyStartDate AS DATE), 112), '19000101') AS [Date Key],",
                "    CASE ",
                "        WHEN SQR.SurveyQuestionResponseValue IN ('1', '2', '3', '4') THEN 0",
                "        WHEN SQR.SurveyQuestionResponseValue IN ('8', '9') THEN 200",
                "        ELSE 100",
                "    END AS [NSAT Score]",
                "FROM ",
                "    [Learning].[SurveyQuestionResponses] AS SQR",
                "INNER JOIN ",
                "    [Learning].[SurveyQuestions] AS SQ",
                "    ON SQR.SurveyQuestionID = SQ.SurveyQuestionID",
                "WHERE ",
                "    SQR.ExamNumber LIKE 'APL%'",
                "    AND (",
                "        -- All up Weighted Content Quality Score",
                "        SQ.SourceIdentifier LIKE 'QAS4A_10%'",
                "",
                "        -- Assessment Content Quality",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_1%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_2%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_5%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_6%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_9%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_11%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_41%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_42%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_43%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_54%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_57%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_58%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4A_62%'",
                "",
                "        -- Impact on Job",
                "        OR SQ.SourceIdentifier LIKE 'QAS4B_11%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4B_12%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4B_44%'",
                "",
                "        -- Applied Skills Assessment Prep Resources",
                "        OR SQ.SourceIdentifier LIKE 'QAS4C_13%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4C_14%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4C_15%'",
                "        OR SQ.SourceIdentifier LIKE 'QAS4C_16%'",
                "    )",
                "    AND SQR.SurveyQuestionResponseValue IS NOT NULL;",
                "",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Version History",
        "isHidden": true,
        "columns": [
          {
            "name": "Report Name",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ReportName",
            "lineageTag": "bcff2304-6af6-44b8-8aa1-48f6d7ef6796"
          },
          {
            "name": "Report Version",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Report Version",
            "lineageTag": "b103ad39-2555-4f84-b9cf-af2c48156fb7"
          },
          {
            "name": "Update",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Update",
            "lineageTag": "8360a942-ccbd-4304-b472-a4fdddde8b79"
          },
          {
            "name": "Date",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "Date",
            "lineageTag": "6ecbbd7b-3bed-4c82-a02f-929b21963d42"
          }
        ],
        "partitions": [
          {
            "name": "Version History",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Files(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting/\", ",
                "    [ApiVersion = 15]",
                "  ),",
                "    #\"Sorted Rows\" = Table.Sort(Source,{{\"Date created\", Order.Descending}}),",
                "    #\"Reports Version Tracker xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/General/\" = #\"Sorted Rows\"{[Name=\"Reports Version Tracker.xlsx\",#\"Folder Path\"=\"https://microsoft.sharepoint.com/teams/WWLReporting/Shared Documents/General/\"]}[Content],",
                "    #\"Imported Excel Workbook\" = Excel.Workbook(#\"Reports Version Tracker xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/General/\"),",
                "    #\"Practice Assessments on MSLearn\" = #\"Imported Excel Workbook\"{[Item=\"Practice Assessments on MSLearn\",Kind=\"Sheet\"]}[Data],",
                "    #\"MCT Certifications - NonPII\" = #\"Imported Excel Workbook\"{[Item=\"MCT Certifications - NonPII\",Kind=\"Sheet\"]}[Data],",
                "    // Combine all three tables (appends them vertically)",
                "    #\"Combined Data\" = Table.Combine({",
                "    #\"MCT Certifications - NonPII\", ",
                "    #\"Practice Assessments on MSLearn\"",
                "  }),",
                "    #\"Removed Duplicates\" = Table.Distinct(#\"Combined Data\"),",
                "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Removed Duplicates\", [PromoteAllScalars=true]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"Report Version\", type text}, {\"Update\", type text}, {\"Date\", type date}, {\"ReportName\", type text}})",
                "in",
                "  #\"Changed Type\""
              ]
            }
          }
        ]
      },
      {
        "name": "Assessment Dictionary",
        "isHidden": true,
        "lineageTag": "1e65aba6-bf87-489b-a2c0-42fa3649e572",
        "columns": [
          {
            "name": "Details",
            "dataType": "string",
            "sourceColumn": "Details",
            "lineageTag": "56d73acb-8bc9-4a16-86b5-f438da04c762"
          },
          {
            "name": "Metrics/Filters",
            "dataType": "string",
            "sourceColumn": "Metrics/Filters",
            "lineageTag": "d5e6ddba-1337-4e98-8c8b-fb6220e92255"
          },
          {
            "name": "Page Name",
            "dataType": "string",
            "sourceColumn": "Page Name",
            "lineageTag": "a88da031-3876-4358-b3f6-cb156076a0b8"
          },
          {
            "name": "Type",
            "dataType": "string",
            "sourceColumn": "Type",
            "lineageTag": "176670fb-1812-40e2-839f-1be404dea98c"
          }
        ],
        "partitions": [
          {
            "name": "Assessment Dictionary",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = SharePoint.Files(",
                "    \"https://microsoft.sharepoint.com/teams/WWLReporting\", ",
                "    [ApiVersion = 15]",
                "  ), ",
                "  #\"Sorted Rows\" = Table.Sort(Source, {{\"Name\", Order.Ascending}}), ",
                "  #\"Global_Dictionary_FY23 xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/\"",
                "    = #\"Sorted Rows\"",
                "    {",
                "      [",
                "        Name           = \"Global_Dictionary_FY23.xlsx\", ",
                "        #\"Folder Path\" = \"https://microsoft.sharepoint.com/teams/WWLReporting/Shared Documents/\"",
                "      ]",
                "    }",
                "    [Content], ",
                "  #\"Imported Excel Workbook\" = Excel.Workbook(",
                "    #\"Global_Dictionary_FY23 xlsx_https://microsoft sharepoint com/teams/WWLReporting/Shared Documents/\"",
                "  ), ",
                "  #\"Practice Assessments_Sheet\" = #\"Imported Excel Workbook\"",
                "    {[Item = \"Practice Assessments\", Kind = \"Sheet\"]}",
                "    [Data], ",
                "  #\"Removed Top Rows\" = Table.Skip(#\"Practice Assessments_Sheet\", 4), ",
                "  #\"Promoted Headers\" = Table.PromoteHeaders(#\"Removed Top Rows\", [PromoteAllScalars = true]), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(",
                "    #\"Promoted Headers\", ",
                "    {",
                "      {\"Page Name\", type text}, ",
                "      {\"Page Level Filters\", type text}, ",
                "      {\"Details\", type text}, ",
                "      {\"Type\", type text}",
                "    }",
                "  ), ",
                "  #\"Renamed Columns\" = Table.RenameColumns(",
                "    #\"Changed Type\", ",
                "    {{\"Page Level Filters\", \"Metrics/Filters\"}}",
                "  )",
                "in",
                "  #\"Renamed Columns\""
              ]
            }
          }
        ]
      },
      {
        "name": "Bridge Certification Exam",
        "isHidden": true,
        "lineageTag": "c42b7c81-4203-43d4-8a98-bb8d63ca67aa",
        "columns": [
          {
            "name": "CertificationKey",
            "dataType": "string",
            "sourceColumn": "CertificationKey",
            "lineageTag": "03720361-e3ce-4500-bac7-cd939ec6ef3c"
          },
          {
            "name": "ExamKey",
            "dataType": "string",
            "sourceColumn": "ExamKey",
            "lineageTag": "352c5b9c-71c9-4e3a-93a8-9ad0fe92c7d2"
          }
        ],
        "partitions": [
          {
            "name": "Bridge Certification Exam",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT  COALESCE(CAST(BEC.ExamID AS NVARCHAR(255)),CAST(E.ExamID AS NVARCHAR(255)), 'Unknown') AS ExamKey",
                "    ,COALESCE(CAST(BEC.CertificationID AS NVARCHAR(255)),CAST(C.CertificationID AS NVARCHAR(255)), 'Unknown') AS CertificationKey",
                "FROM [Learning].[BridgeExamCertifications] BEC",
                "FULL JOIN Learning.Certifications C ON C.CertificationID = BEC.CertificationID",
                "FULL JOIN Learning.Exams E ON E.ExamID = BEC.ExamID",
                "WHERE E.SourceSystem IN (",
                "        'MSCert'",
                "        ,'Certiport'",
                "        )",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS ExamKey",
                "    ,'Unknown' AS CertificationKey",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Bridge Certification Fact Is AI",
        "isHidden": true,
        "lineageTag": "61caa90e-e68e-488a-8234-87eccc2999da",
        "columns": [
          {
            "name": "CertificationKey",
            "dataType": "string",
            "sourceColumn": "CertificationKey",
            "lineageTag": "85f48ba0-fd65-436e-9e30-380e51784893"
          },
          {
            "name": "Is AI",
            "dataType": "string",
            "sourceColumn": "Is AI",
            "lineageTag": "a123669a-ac4b-4c9a-b197-bc78c8fd59f9"
          }
        ],
        "partitions": [
          {
            "name": "Bridge Certification Fact Is AI",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  #\"Credentials with IsAI flag\" = Table.Column(",
                "    Table.SelectRows(Table.Buffer(#\"AI Credentials\"), each ([Credential Type] = \"Certification\")), ",
                "    \"Credential Key\"",
                "  ), ",
                "  #\"Certification Specialities\" = Sql.Database(",
                "#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", ",
                "    [",
                "      Query",
                "        = \"",
                "SELECT DISTINCT C.[CertificationID] AS [CertificationKey]",
                "    ,ISNULL(C.[CertificationName], 'Unknown') AS [Certification Speciality]",
                "FROM [Learning].[Certifications] C",
                "WHERE [CertificationID] IS NOT NULL",
                "\"]",
                "  ), ",
                "  #\"Added Custom\" = Table.AddColumn(",
                "    #\"Certification Specialities\", ",
                "    \"Is AI\", ",
                "    each ",
                "      if List.Contains(#\"Credentials with IsAI flag\", [Certification Speciality]) then",
                "        \"Yes\"",
                "      else",
                "        \"No\"",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom\", {{\"Is AI\", type text}}), ",
                "  #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\", {\"Certification Speciality\"})",
                "in",
                "  #\"Removed Columns\""
              ]
            }
          }
        ]
      },
      {
        "name": "Bridge Person Account",
        "lineageTag": "f20e9e32-2f47-40e1-a016-320bd70b7fa5",
        "columns": [
          {
            "name": "AccountID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "AccountID",
            "lineageTag": "25149c42-5655-4e8c-80f6-858ae12b105d"
          },
          {
            "name": "PersonDetailsID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonDetailsID",
            "lineageTag": "20bcc387-a6f2-4934-b505-b93766673cab"
          },
          {
            "name": "Customer Source",
            "dataType": "string",
            "sourceColumn": "Customer Source",
            "lineageTag": "6018502f-f833-44a7-9b12-0efdee9cc968"
          },
          {
            "name": "EmailAddressDomain",
            "dataType": "string",
            "sourceColumn": "EmailAddressDomain",
            "lineageTag": "0acd629d-0aed-4e9a-8b8b-f1f9f0b923df"
          },
          {
            "name": "Is Customer",
            "dataType": "string",
            "sourceColumn": "Is Customer",
            "lineageTag": "5d1b3216-497b-4f05-bcb0-aba2b31aac4f"
          },
          {
            "name": "Conf_IsAcademicFlag",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Conf_IsAcademicFlag",
            "lineageTag": "3d51a49a-2713-4f02-bb43-b26ef77af56b"
          },
          {
            "type": "calculated",
            "name": "Is Academic",
            "dataType": "string",
            "description": "Is Academic",
            "expression": [
              "IF (",
              "    RELATED ( 'IsAcademic PersonID'[EmailAddressDomain_Trim] )",
              "        <> BLANK ()",
              "        || 'Bridge Person Account'[Conf_IsAcademicFlag] = \"Yes\",",
              "    \"Yes\",",
              "    \"No\"",
              ")"
            ],
            "lineageTag": "3d8065dc-d416-4889-a1cc-3ff35215e2b7",
            "summarizeBy": "none"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "PersonID",
            "lineageTag": "65f91e75-cc61-4d72-a49d-e4d6617158ce"
          }
        ],
        "partitions": [
          {
            "name": "Bridge Person Account",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "DECLARE @Date AS DATE = '2018-07-01';",
                "DECLARE @AppliedSkillsDate AS DATE = '2023-10-25';",
                "WITH ",
                "--Getting all Users with Participation records",
                "CTE_PersonsList AS (",
                "    -- Applied Skills",
                "    SELECT ASP.PersonDetailsID",
                "    FROM [Learning].[AppliedSkillParticipation] ASP",
                "    WHERE LOWER(ASP.AppliedSkillName) LIKE 'apl-____%'",
                "        AND (",
                "            (NOT LOWER(ASP.SolutionArea) LIKE 'apl-0000%')",
                "            OR ASP.SolutionArea IS NULL",
                "        )",
                "        AND LOWER(ASP.AppliedSkillStatus) <> 'lab creation failed'",
                "        AND TRY_CAST(ASP.AppliedSkillStartTime AS DATE) >= @AppliedSkillsDate",
                "",
                "    UNION",
                "",
                "    -- Certifications",
                "    SELECT LC.PersonDetailsID",
                "    FROM Learning.LearnerCertifications LC",
                "    WHERE CAST(EffectiveDate AS DATE) >= @Date",
                "",
                "    UNION",
                "",
                "    -- Exams Participation",
                "    SELECT EP.PersonDetailsID",
                "    FROM Learning.ExamParticipation EP",
                "    WHERE CAST(EP.ExamCompletionDate AS DATE) >= @Date",
                "",
                "    UNION",
                "",
                "    -- Exams No show",
                "    SELECT ER.PersonDetailsID",
                "    FROM Learning.ExamRegistrations ER",
                "    WHERE CAST(ER.ExamDate AS DATE) >= @Date",
                "        AND (",
                "            ER.RegistrationStatus IN ('NoShow', 'Expired')",
                "            OR (",
                "                ER.RegistrationStatus IN ('ApptCancelled', 'ApptCreated', 'ApptRescheduled')",
                "                AND CAST(ER.ExamDate AS DATE) >= CAST(ER.EtlUpdateDateTime AS DATE)",
                "            )",
                "        )",
                "",
                "    UNION",
                "",
                "    -- Fact MCT",
                "    SELECT MCT.PersonDetailsID",
                "    FROM Learning.MicrosoftCertifiedTrainers MCT",
                "    WHERE CAST(MCT.AnniversaryDate AS DATE) > CAST(EtlUpdateDateTime AS DATE)",
                "),",
                "CTE_SFD AS (",
                "    SELECT LOWER(SFD.DomainName) AS DomainName, SkillingAccountCode, ReviewStatus",
                "    FROM [Operations].[SafelistedDomains] SFD",
                "),",
                "--Getting Safelisted BPA PersonIDs",
                "CTE_SFDBPA AS (",
                "    SELECT distinct BPA.PersonID,SD.DomainName,SD.SkillingAccountCode",
                "    FROM Learning.BridgePersonAccounts BPA",
                "    INNER JOIN Learning.PersonDetails PD on PD.PersonID = BPA.PersonID",
                "    INNER JOIN CTE_SFD SD on SD.DomainName = LOWER(PD.EmailAddressDomain)",
                "    AND LOWER(PD.SourceSystem) = 'learn'",
                "),",
                "--Getting Safelisted BOC PersonIDs",
                "CTE_BOC AS (",
                "    SELECT distinct BO.PersonID,SD.DomainName,SD.SkillingAccountCode",
                "    FROM [Operations].[BridgeOldCertLinks] BO",
                "    INNER JOIN Learning.PersonDetails PD on PD.PersonID = BO.PersonID",
                "    AND LOWER(PD.SourceSystem) = 'learn'",
                "    INNER JOIN CTE_SFD SD on SD.DomainName = LOWER(BO.PersonEmailDomain)",
                "),",
                "CTE_IsAcademic AS (",
                "    SELECT DISTINCT EP.PersonDetailsID, 1 AS IsAcademic",
                "    FROM CTE_PersonsList PL",
                "    INNER JOIN Learning.ExamParticipation EP ON EP.PersonDetailsID = PL.PersonDetailsID",
                "    LEFT JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = EP.PersonDetailsID",
                "    LEFT JOIN Learning.BridgeDiscountActivity BDA ON BDA.ExamParticipationID = EP.ExamParticipationID",
                "    LEFT JOIN Learning.Discounts D ON D.DiscountID = BDA.DiscountID",
                "    WHERE (",
                "        CandidateCategorization IN ('072', '72')",
                "        OR LOWER(D.SourceIdentifier) = 'job seeker exam offer 2020'",
                "        --AND LOWER(PD.JobTitle) = 'student'",
                "    )",
                "    AND EP.PersonDetailsID IS NOT NULL",
                ")",
                "SELECT",
                "    ISNULL(PL.PersonDetailsID, 'Unknown') AS PersonDetailsID,",
                "    ISNULL(PL.PersonID, 'Unknown') AS PersonID,",
                "    COALESCE(A.AccountID, A1.AccountID, A2.AccountID, '-1') AS AccountID",
                "        ,CASE ",
                "        WHEN A.AccountID IS NOT NULL THEN 'ESI' --Account mapping from Safelisted BPA or BOC",
                "        WHEN A1.AccountID IS NOT NULL THEN 'LEARN' --Account mapping from BPA",
                "        WHEN A2.AccountID IS NOT NULL THEN 'CDES' --Account mapping from CDES",
                "        ELSE 'Non-Customer'",
                "    END AS [Customer Source],",
                "    IIF(A.AccountID IS NOT NULL OR A1.AccountID IS NOT NULL OR A2.AccountID IS NOT NULL, 'Yes', 'No') AS [Is Customer],",
                "        COALESCE(",
                "        CASE ",
                "            WHEN A.AccountID IS NOT NULL AND SFD.ReviewStatus <> 859270001 THEN 'unknown' --ESI record but not approved, populating unknown domain",
                "            ELSE NULL",
                "        END,",
                "        NULLIF(TRIM(LOWER(SFD.DomainName)), ''), --ESI record and approved",
                "        NULLIF(TRIM(LOWER(PL.EmailAddressDomain)), ''),",
                "        'unknown'",
                "    ) AS EmailAddressDomain,",
                "    IIF(IAC.IsAcademic = 1, 'Yes', 'No') AS [Conf_IsAcademicFlag]",
                "FROM (Select PL.PersonDetailsID, PD.PersonID, PD.EmailAddressDomain",
                "    FROM CTE_PersonsList PL",
                "INNER JOIN Learning.PersonDetails PD ON PD.PersonDetailsID = PL.PersonDetailsID",
                "    AND LOWER(PD.SourceSystem) = 'learn') AS PL",
                "LEFT JOIN CTE_IsAcademic IAC ON IAC.PersonDetailsID = PL.PersonDetailsID",
                "LEFT JOIN CTE_SFDBPA SBPA ",
                "    ON SBPA.PersonID = PL.PersonID --First Priority to Safelisted BPA",
                "LEFT JOIN CTE_BOC SBO ",
                "    ON SBO.PersonID = PL.PersonID",
                "    AND SBPA.PersonID IS NULL --Second Priority to Safelisted BOC if no Safelisted BPA record found",
                "LEFT JOIN CTE_SFD SFD ",
                "    ON LOWER(SFD.DomainName) = LOWER(COALESCE(SBPA.DomainName, SBO.DomainName))",
                "LEFT JOIN Learning.Accounts A ON A.SkillingAccountCode = SFD.SkillingAccountCode",
                "    AND A.TPID = A.MSSalesOrgID",
                "    AND A.TPID IS NOT NULL  --Associate to Account only if it's TPID",
                "LEFT JOIN Learning.BridgePersonAccounts BPA",
                "    ON BPA.PersonID = PL.PersonID ",
                "LEFT JOIN Learning.Accounts A1 ",
                "    ON LOWER(A1.AccountID) = LOWER(BPA.AccountID)",
                "    AND A1.TPID IS NOT NULL --Next fetching accounts from BPA",
                "LEFT JOIN [Operations].[BridgePersonCDESAccounts] CDES ",
                "    ON CDES.PersonID = PL.PersonID",
                "    AND CDES.SourceSystem = 'Learn'",
                "    AND A.AccountID IS NULL",
                "LEFT JOIN Learning.Accounts A2 ",
                "    ON LOWER(A2.AccountID) = LOWER(CDES.AccountID)",
                "    AND A2.TPID IS NOT NULL --At last CDES",
                "",
                "UNION ALL",
                "",
                "SELECT ",
                "    'Unknown' AS PersonDetailsID,",
                "    'Unknown' AS PersonID,",
                "    '-1' AS AccountID,",
                "    'Non-Customer' AS [Customer Source],",
                "    'No' AS [Is Customer],",
                "    'Unknown' AS EmailAddressDomain,",
                "    'No' AS [Conf_IsAcademicFlag]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Bridge Practice Exam Fact Is AI",
        "isHidden": true,
        "lineageTag": "78166a9f-ed94-4b4f-b114-733f4eaaeb2d",
        "columns": [
          {
            "name": "ExamKey",
            "dataType": "string",
            "sourceColumn": "ExamKey",
            "lineageTag": "9c66519b-28f0-4dad-b420-ca149046f41c"
          },
          {
            "name": "Is AI",
            "dataType": "string",
            "sourceColumn": "Is AI",
            "lineageTag": "b2bafa8c-733f-4a7a-abea-63445fcaa6b3"
          }
        ],
        "partitions": [
          {
            "name": "Bridge Practice Exam Fact Is AI",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  #\"Exams with IsAI flag\" = Table.Column(",
                "    Table.SelectRows(Table.Buffer(#\"AI Credentials\"), each ([Credential Type] = \"Exam\")), ",
                "    \"Credential Key\"",
                "  ), ",
                "  #\"Practice Assessment Exam Numbers\" = Sql.Database(",
                "#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", ",
                "    [",
                "      Query",
                "        = \"SELECT distinct ISNULL(PE.ExamID, 'Unknown') AS ExamKey#(lf)    ,ISNULL(PE.[ExamNumber], 'Unknown') AS [Exam Number]#(lf)FROM [Learning].[PracticeExamParticipation] PE#(lf)WHERE SourceSystem = 'Learn'#(lf)    AND PE.ExamStartTime >= '2020-07-01'#(lf)    AND PE.ExamNumber NOT LIKE '%TEST'\"",
                "    ]",
                "  ), ",
                "  #\"Added Custom\" = Table.AddColumn(",
                "    #\"Practice Assessment Exam Numbers\", ",
                "    \"Is AI\", ",
                "    each if List.Contains(#\"Exams with IsAI flag\", [Exam Number]) then \"Yes\" else \"No\"",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom\", {{\"Is AI\", type text}}), ",
                "  #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\", {\"Exam Number\"})",
                "in",
                "  #\"Removed Columns\""
              ]
            }
          }
        ]
      },
      {
        "name": "Certification",
        "lineageTag": "158df8cb-41a2-4208-8ab3-b62c9ebc5e0d",
        "columns": [
          {
            "name": "Certification Job Role",
            "dataType": "string",
            "sourceColumn": "Certification Job Role",
            "lineageTag": "d30b6ce4-c4a7-4b14-b5cd-7be143d0391b"
          },
          {
            "name": "Certification Level",
            "dataType": "string",
            "sourceColumn": "Certification Level",
            "lineageTag": "27882e5d-7076-4520-b36c-8aede432aec4"
          },
          {
            "name": "Certification Speciality",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Certification Speciality",
            "lineageTag": "383bfeb8-d55e-4c81-9af6-3d5d794790b4"
          },
          {
            "name": "Certification Track",
            "dataType": "string",
            "sourceColumn": "Certification Track",
            "lineageTag": "1ac113dc-fc9d-41b8-af10-4786f3286e09"
          },
          {
            "name": "Certification Type",
            "dataType": "string",
            "sourceColumn": "Certification Type",
            "lineageTag": "5dfa2950-e8ec-4623-942c-ea0044ff08cc"
          },
          {
            "name": "Solution Area",
            "dataType": "string",
            "sourceColumn": "Solution Area",
            "lineageTag": "9f694284-8728-40a1-bac8-49638dfd393f"
          },
          {
            "name": "Transcript Name",
            "dataType": "string",
            "sourceColumn": "Transcript Name",
            "lineageTag": "7ccfe27d-f6c8-41f2-b855-9590ea847f1a"
          },
          {
            "name": "CertificationUniqueId",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "CertificationUniqueId",
            "lineageTag": "a8c38e66-aaab-4222-b53a-7de86ebb7c78"
          },
          {
            "name": "Is Role Based Certification",
            "dataType": "string",
            "sourceColumn": "Is Role Based Certification",
            "lineageTag": "ba30df2e-7e7c-4038-8211-e7d001e8e6b3"
          },
          {
            "name": "CertificationKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "CertificationKey",
            "lineageTag": "21ba1c4b-a6e8-4eaa-a9cf-637f23d2be91"
          }
        ],
        "partitions": [
          {
            "name": "Certification",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT C.[CertificationID] AS [CertificationKey]",
                "    ,ISNULL(C.CertificationUniqueID, 'Unknown') AS [CertificationUniqueId]",
                "    ,CASE ",
                "        WHEN [Track] IN ('AZURE')",
                "            THEN 'Azure'",
                "        ELSE ISNULL([Track], 'Unknown')",
                "        END AS [Certification Track]",
                "    ,ISNULL(C.[CertificationName], 'Unknown') AS [Certification Speciality]",
                "    ,CASE ",
                "        WHEN C.[Description] <> ''",
                "            AND C.[Description] IS NOT NULL",
                "            THEN C.[Description]",
                "        ELSE 'Unknown'",
                "        END AS [Transcript Name]",
                "    ,ISNULL(C.JobRole, 'No Role Defined') AS [Certification Job Role]",
                "    ,ISNULL(C.[SolutionArea], 'No Solution Area Defined') AS [Solution Area]",
                "    ,ISNULL([IsRoleBased], 'Unknown') AS [Is Role Based Certification]",
                "    ,CASE ",
                "        WHEN C.[Certificationlevel] IN (",
                "                'beginner'",
                "                ,'fundamentals'",
                "                )",
                "            THEN 'Fundamentals'",
                "        WHEN C.[Certificationlevel] IN (",
                "                'advanced'",
                "                ,'intermediate'",
                "                )",
                "            THEN 'Advanced'",
                "        WHEN C.[Certificationlevel] IN ('speciality')",
                "            THEN 'Speciality'",
                "        WHEN C.[Certificationlevel] IN ('associate')",
                "            THEN 'Associate'",
                "        WHEN C.[Certificationlevel] IN ('expert')",
                "            THEN 'Expert'",
                "        ELSE ISNULL(C.[Certificationlevel], 'Unknown')",
                "        END AS [Certification Level]",
                "    ,CASE ",
                "        WHEN C.[CertificationType] IN ('fundamentals')",
                "            THEN 'Fundamentals'",
                "        WHEN C.[CertificationType] IN (",
                "                'mce'",
                "                ,'mos'",
                "                )",
                "            THEN 'Non-rolebased'",
                "        WHEN C.[CertificationType] IN (",
                "                'role-based'",
                "                ,'specialty'",
                "                )",
                "            THEN 'Advanced'",
                "        ELSE ISNULL(C.[CertificationType], 'Unknown')",
                "        END AS [Certification Type]",
                "FROM [Learning].[Certifications] C",
                "WHERE [CertificationID] IS NOT NULL",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [CertificationKey]",
                "    ,'Unknown' AS [CertificationUniqueId]",
                "    ,'Unknown' AS [Certification Track]",
                "    ,'Unknown' AS [Certification Speciality]",
                "    ,'Unknown' AS [Transcript Name]",
                "    ,'No Role Defined' AS [Certification Job Role]",
                "    ,'No Solution Area Defined' AS [Solution Area]",
                "    ,'Unknown' AS [Is Role Based Certification]",
                "    ,'Unknown' AS [Certification Level]",
                "    ,'Unknown' AS [Certification Type]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "Certification Hierarchy",
            "lineageTag": "18979b00-6ad0-4f7f-bfc4-6df2774259d4",
            "levels": [
              {
                "name": "Certification Track",
                "ordinal": 0,
                "column": "Certification Track",
                "lineageTag": "fba4abc1-6622-445c-b3e5-84d4bdc5ca60"
              },
              {
                "name": "Certification Speciality",
                "ordinal": 1,
                "column": "Certification Speciality",
                "lineageTag": "9280eb81-5692-4d10-abb7-3d7c73805df2"
              }
            ]
          },
          {
            "name": "Certification Level Hierarchy",
            "lineageTag": "cfd0b466-e279-4f38-a54c-daf456cd8f4f",
            "levels": [
              {
                "name": "Certification Type",
                "ordinal": 0,
                "column": "Certification Type",
                "lineageTag": "e6eb7ac1-2c35-460c-ae3d-9dda3a1bfb57"
              },
              {
                "name": "Certification Level",
                "ordinal": 1,
                "column": "Certification Level",
                "lineageTag": "c6ca0dca-3a74-4478-8957-da73b578b5ea"
              }
            ]
          }
        ]
      },
      {
        "name": "Certification Metrics",
        "description": "Certification Metrics",
        "lineageTag": "07d77d9b-bfe7-4c04-8118-b48da3eb4052",
        "columns": [
          {
            "name": "ExamStatusKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamStatusKey",
            "isAvailableInMdx": false,
            "lineageTag": "61c1e65b-00cb-48e5-b189-ad0d5a628200"
          },
          {
            "name": "Exam Status",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Exam Status",
            "isAvailableInMdx": false,
            "lineageTag": "83c44e9c-0323-4658-bfc5-887e8339fbc3"
          }
        ],
        "partitions": [
          {
            "name": "Certification Metrics",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "Select 'Unknown' as [Exam Status]",
                "    ,'Unknown' as [ExamStatusKey]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "Certification Expiration Rate",
            "description": "This calculation is used to calculate the percentage of certifications that have expired out of the total number of certifications. It divides the number of certifications that have expired by the sum of the certifications that have expired and the certifications that have been renewed.",
            "expression": [
              "DIVIDE (",
              "    [Certifications Expired],",
              "    [Certifications Renewed] + [Certifications Expired]",
              ")"
            ],
            "formatString": "#,##0.0 %"
          },
          {
            "name": "Certifications Expired",
            "description": "This calculation is used to count the number of distinct LearnerCertificationsID values in the Fact Certification table, but only when the CertificationExpirationCount is not equal to 0. The result is then checked to see if it is equal to 0, and if so, it returns a blank value.",
            "expression": [
              "VAR _certren =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "            1",
              "        ),",
              "        USERELATIONSHIP ( 'Fact Certification'[AchievementEndDateKey], 'Time'[DateKey] ),",
              "        KEEPFILTERS ( 'Fact Certification'[CertificationExpirationCount] <> 0 )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "All Certifications Earned",
            "description": "This calculation is counting the number of distinct LearnerCertificationsID values in the Fact Certification table. This can be used to determine the total number of certifications a learner has achieved.",
            "expression": [
              "CALCULATE (",
              "    SUMX (",
              "        DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "        1",
              "    )",
              ")"
            ],
            "formatString": "#,0"
          },
          {
            "name": "New Role Based Certifications",
            "description": "This calculation is counting the number of distinct LearnerCertificationsID values in the Fact Certification table that have a value of 0 in the NewRoleBasedCertifications column. If the count is 0, the result is blank, otherwise the count is returned.",
            "expression": [
              "VAR _certren =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "            1",
              "        ),",
              "        KEEPFILTERS ( 'Fact Certification'[NewRoleBasedCertifications] <> 0 )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0",
            "isHidden": true
          },
          {
            "name": "Fundamental Certifications Earned",
            "description": "This calculation is used to count the number of distinct LearnerCertificationsID values from the Fact Certification table that have a FundamentalCertificationsEarned value that is not equal to 0. If the count is 0, the result will be blank, otherwise the count will be returned.",
            "expression": [
              "VAR _certren =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "            1",
              "        ),",
              "        KEEPFILTERS ( 'Fact Certification'[FundamentalCertificationsEarned] <> 0 )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0",
            "isHidden": true
          },
          {
            "name": "Active Certifications",
            "description": "This calculation is adding up the total number of certifications a person has earned or renewed. It includes any new certifications they have earned, any fundamental certifications they have earned, any certifications that are expiring, and any certifications they have renewed. This gives a total number of certifications a person has, which can be used to track their progress or for other purposes.",
            "expression": "[New Role Based Certifications] + [Fundamental Certifications Earned] + [Certifications Expiring] + [Certifications Renewed]",
            "formatString": "#,0"
          },
          {
            "name": "Active Role Based Certifications",
            "description": "This calculation is adding up the total number of certifications that have been assigned to a role, the number of certifications that have been renewed, and the number of certifications that are expiring. This will give a total number of certifications that are currently active and in use.",
            "expression": "[New Role Based Certifications] + [Certifications Renewed] + [Certifications Expiring]",
            "formatString": "#,0"
          },
          {
            "name": "Certifications Expiring",
            "description": "This calculation is counting the distinct number of LearnerCertificationsID in the Fact Certification table, where the StayCurrentEligibilityEndDateKey is related to the DateKey in the Time table, and the StayCurrentEligibleCount is not equal to 0. If the result of the calculation is 0, it will return a blank value, otherwise it will return the result of the calculation.",
            "expression": [
              "VAR _certren =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "            1",
              "        ),",
              "        USERELATIONSHIP ( 'Fact Certification'[StayCurrentEligibilityEndDateKey], 'Time'[DateKey] ),",
              "        KEEPFILTERS ( 'Fact Certification'[StayCurrentEligibleCount] <> 0 )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Certification Unique Users",
            "description": "This calculation is used to count the number of distinct users in the 'Fact Certification' table, taking into account all the rows in the 'Migrated Certification' table. It is essentially counting the number of unique users who have completed a certification.",
            "expression": [
              "CALCULATE (",
              "    SUMX (",
              "        DISTINCT ( 'Fact Certification'[UserKey] ),",
              "        1",
              "    ),",
              "    ALL ( 'Migrated Certification' )",
              ")"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Certifications Eligible For Renewal",
            "description": "This calculation is counting the number of distinct learner certifications that have a stay current eligibility start date and a stay current eligible count that is not equal to 0. If the count is 0, the result will be blank, otherwise the result will be the count.",
            "expression": [
              "VAR _certren =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "            1",
              "        ),",
              "        USERELATIONSHIP ( 'Fact Certification'[StayCurrentEligibilityStartDateKey], 'Time'[DateKey] ),",
              "        KEEPFILTERS ( 'Fact Certification'[StayCurrentEligibleCount] <> 0 )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Certification Renewal Rate",
            "description": "This calculation is finding the percentage of certifications that have been renewed out of the total number of certifications (both expired and renewed). The result will be a number between 0 and 1, with 1 representing 100% of certifications renewed.",
            "expression": [
              "DIVIDE (",
              "    [Certifications Renewed],",
              "    [Certifications Expired] + [Certifications Renewed]",
              ")"
            ],
            "formatString": "#,##0.0 %"
          },
          {
            "name": "Certifications Renewed",
            "description": "This calculation is counting the number of distinct learner certifications that have been renewed at least once. The calculation is using the USERELATIONSHIP function to join the 'Fact Certification' table to the 'Time' table on the 'PreviousExpirationDateKey' and 'DateKey' columns, respectively. The KEEPFILTERS function is then used to filter the results to only include certifications that have been renewed at least once. The IF statement is then used to return",
            "expression": [
              "VAR _certren =",
              "    CALCULATE (",
              "        SUMX (",
              "            DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ),",
              "            1",
              "        ),",
              "        USERELATIONSHIP ( 'Fact Certification'[PreviousExpirationDateKey], 'Time'[DateKey] ),",
              "        KEEPFILTERS ( 'Fact Certification'[CertificationRenewalCount] <> 0 )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Active Not Yet Eligible For Renew Certifications",
            "description": "This calculation is counting the number of distinct certifications that have an Achievement End Date Key greater than the Current Date plus 180 days. If the result is 0, then the calculation will return a blank value, otherwise it will return the result of the calculation.",
            "expression": [
              "VAR _certren = ",
              "    CALCULATE (",
              "         SUMX ( DISTINCT ( 'Fact Certification'[LearnerCertificationsID] ), 1),",
              "        'Fact Certification'[AchievementEndDateKey] > 'Fact Certification'[Current Date + 180 Days],",
              "        USERELATIONSHIP ( 'Time'[DateKey], 'Fact Certification'[AchievementEndDateKey] )",
              "    )",
              "RETURN",
              "    IF (",
              "        _certren = 0,",
              "        BLANK (),",
              "        _certren",
              "    )"
            ],
            "formatString": "#,0"
          },
          {
            "name": "Academic AI Exams Passed",
            "description": "This calculation is adding up the number of exams that have been passed by academic users in two different channels. The first channel is \"Commercial\" with a \"Unknown\" program, and the second channel is \"Academic\" with either a \"Fundamentals\" or \"MCP\" program. It is looking at nine specific exams and returning the total number of exams that have been passed.",
            "expression": [
              "VAR a =",
              "    CALCULATE (",
              "        [Exams],",
              "        KEEPFILTERS ( 'Exam'[Academic AI Exam flag] = \"Yes\" ),",
              "        KEEPFILTERS ( 'Exam Status'[Exam Status] = \"Passed\" ),",
              "        KEEPFILTERS ( 'Bridge Person Account'[Is Academic] = \"Yes\" ),",
              "        KEEPFILTERS (",
              "            AND (",
              "                'Channel'[Channel] = \"Commercial\",",
              "                'Channel'[Channel Program] = \"Unknown\"",
              "            )",
              "        )",
              "    )",
              "",
              "VAR b =",
              "    CALCULATE (",
              "        [Exams],",
              "        KEEPFILTERS ( 'Exam'[Academic AI Exam flag] = \"Yes\" ),",
              "        KEEPFILTERS ( 'Exam Status'[Exam Status] = \"Passed\" ),",
              "        KEEPFILTERS (",
              "            AND (",
              "                'Channel'[Channel] = \"Academic\",",
              "                'Channel'[Channel Program]",
              "                    IN {",
              "                        \"Fundamentals\",",
              "                        \"MCP\"",
              "                    }",
              "            )",
              "        )",
              "    )",
              "",
              "RETURN",
              "    a + b",
              ""
            ],
            "formatString": "#,0"
          },
          {
            "name": "Adv/Fund Net New Learner Earning Credentials",
            "description": "This calculation is counting the number of distinct users who have an Adv/FundNetNewLearner value of 1, and a Certification Type that is not \"Unknown\" or \"Non-rolebased\".",
            "expression": [
              "CALCULATE (",
              "    SUMX (",
              "        DISTINCT ( 'Fact Certification'[UserKey] ),",
              "        1",
              "    ),",
              "    KEEPFILTERS ( 'Fact Certification'[Adv/FundNetNewLearner] = 1 )",
              "   -- KEEPFILTERS ( Certification[Certification Type] <> \"Unknown\" ),",
              "   -- KEEPFILTERS ( Certification[Certification Type] <> \"Non-rolebased\" )",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "31786adc-5205-4557-b8b8-62a9d2455a1e"
          },
          {
            "name": "Adv/Fund Net New Learner Earning Credentials (Cumulative)",
            "description": "This calculation is summing up the \"Adv/Fund Net New Learner Earning Credentials\" from the Fact Certification table for all dates that are less than or equal to the maximum date in the Fact Certification table.",
            "expression": [
              "VAR MAXDate =",
              "    CALCULATE (",
              "        MAX ( 'Fact Certification'[DateKey] )",
              "    )",
              "RETURN",
              "    SUMX (",
              "        CALCULATETABLE (",
              "            ADDCOLUMNS (",
              "                FILTER (",
              "                    ALLSELECTED ( 'Time' ),",
              "                    'Time'[DateKey] <= MAXDate",
              "                ),",
              "                \"Uq\", [Adv/Fund Net New Learner Earning Credentials]",
              "            )",
              "        ),",
              "        [Uq]",
              "    )"
            ],
            "formatString": "#,0",
            "lineageTag": "78553eee-646e-4899-bb6c-39f487f887fd"
          },
          {
            "name": "Certified Learner Count",
            "description": "This calculation counts the number of unique user keys in the 'Fact Certification' table. This can be used to determine the total number of users that have been certified in a given time period.",
            "expression": [
              "SUMX (",
              "    VALUES ( 'Fact Certification'[UserKey] ),",
              "    1",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "8b6f0a57-d2c3-4c85-8c4a-5c0660930fbb"
          },
          {
            "name": "Cummulative Unique Learner Count",
            "description": "This calculation is summing up the number of unique learners for all dates up to the maximum date in the 'Fact Certification' table. It first finds the maximum date in the 'Fact Certification' table, then filters the 'Time' table to only include dates up to that maximum date, and then adds a column to the filtered table with the number of unique learners for each date. Finally, it sums up the number of unique learners in the added column.",
            "expression": [
              "VAR MAXDate =",
              "    CALCULATE (",
              "        MAX ( 'Fact Certification'[DateKey] )",
              "    )",
              "RETURN",
              "    SUMX (",
              "        CALCULATETABLE (",
              "            ADDCOLUMNS (",
              "                FILTER (",
              "                    ALLSELECTED ( 'Time' ),",
              "                    'Time'[DateKey] <= MAXDate",
              "                ),",
              "                \"Uq\", [Unique Learners Count]",
              "            )",
              "        ),",
              "        [Uq]",
              "    )"
            ],
            "formatString": "#,0",
            "lineageTag": "e3a598eb-df35-4ab0-aea5-0572076282be"
          },
          {
            "name": "Net New Learner Earning Credentials",
            "description": "This calculation is counting the number of distinct users who have earned their first certification. It is doing this by summing up the number of distinct user keys in the 'Fact Certification' table, and then filtering it to only include users who have earned their first certification.",
            "expression": [
              "CALCULATE (",
              "    SUMX (",
              "        DISTINCT ( 'Fact Certification'[UserKey] ),",
              "        1",
              "    ),",
              "    KEEPFILTERS ( 'Fact Certification'[FirstEarnedCert] = 1 )",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "434d0d91-2de9-46f4-83c1-c47451e8bdce"
          },
          {
            "name": "Net New Learner Earning Credentials (Cumulative)",
            "description": "This calculation is finding the sum of the number of new learner earning credentials for all selected dates up to the maximum date in the Fact Certification table. It does this by first finding the maximum date in the Fact Certification table, then filtering the Time table to only include dates up to the maximum date, and finally adding a column to the filtered table with the number of new learner earning credentials and summing it.",
            "expression": [
              "VAR MAXDate =",
              "    CALCULATE (",
              "        MAX ( 'Fact Certification'[DateKey] )",
              "    )",
              "RETURN",
              "    SUMX (",
              "        CALCULATETABLE (",
              "            ADDCOLUMNS (",
              "                FILTER (",
              "                    ALLSELECTED ( 'Time' ),",
              "                    'Time'[DateKey] <= MAXDate",
              "                ),",
              "                \"Uq\", [Net New Learner Earning Credentials]",
              "            )",
              "        ),",
              "        [Uq]",
              "    )"
            ],
            "formatString": "#,0",
            "lineageTag": "4ddfcfcf-bdeb-443c-8c91-548b47674869"
          },
          {
            "name": "Net New Learner Earning Credentials With Type",
            "description": "This calculation is summing up the number of distinct users with the filter of \"WithTypeNetNewLearner\" being equal to 1. This is a way to measure the number of unique users who have a specific attribute.",
            "expression": [
              "CALCULATE (",
              "    SUMX (",
              "        DISTINCT ( 'Fact Certification'[UserKey] ),",
              "        1",
              "    ),",
              "    KEEPFILTERS ( 'Fact Certification'[WithTypeNetNewLearner] = 1 )",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "2c8dbba3-1433-4469-9ba2-c4f19f1824cb"
          },
          {
            "name": "Unique Learners Count",
            "description": "This calculation is counting the number of rows in a table that has been filtered to only include rows that have a DateKey that matches the DateOfFirstEarned value for each UserKey. This could be used to determine the number of certifications earned by each user.",
            "expression": [
              "COUNTROWS (",
              "    FILTER (",
              "        CALCULATETABLE (",
              "            ADDCOLUMNS (",
              "                VALUES ( 'Fact Certification'[UserKey] ),",
              "                \"DateOfFirsEarned\",",
              "                    CALCULATE (",
              "                        MIN ( 'Fact Certification'[DateKey] )",
              "                    )",
              "            ),",
              "            ALL ( 'Time' )",
              "        ),",
              "        CONTAINS (",
              "            VALUES ( 'Time'[DateKey] ),",
              "            'Time'[DateKey], [DateOfFirsEarned]",
              "        )",
              "    )",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "51c6db3b-5c4d-4de3-8aa3-49ca70cae416"
          }
        ]
      },
      {
        "name": "CertificationRenewalParticipation",
        "isHidden": true,
        "lineageTag": "1f3d3455-a085-45ab-a6de-0a6f37ac114b",
        "columns": [
          {
            "name": "AnswersCorrect",
            "dataType": "int64",
            "sourceColumn": "AnswersCorrect",
            "lineageTag": "c8ac6323-aab3-4772-8b53-86c095c11a59"
          },
          {
            "name": "CertificationName",
            "dataType": "string",
            "sourceColumn": "CertificationName",
            "lineageTag": "dead584d-e32f-41d5-944f-51c4b03cd95b"
          },
          {
            "name": "CertificationRenewalParticipationID",
            "dataType": "string",
            "sourceColumn": "CertificationRenewalParticipationID",
            "lineageTag": "e9eb286f-1539-464b-86f6-798d977fbcbc"
          },
          {
            "name": "CertificationUniqueId",
            "dataType": "string",
            "sourceColumn": "CertificationUniqueID",
            "lineageTag": "1a9af305-b3d7-4849-acfa-8f57e364caf2"
          },
          {
            "name": "LCPersonID",
            "dataType": "string",
            "sourceColumn": "LCPersonDetailsID",
            "lineageTag": "99710c28-3136-4e47-a6cc-7e546a29d1ec"
          },
          {
            "name": "LearnerCertificationsID",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "LearnerCertificationsID",
            "lineageTag": "73f3b4f3-16ea-401b-8f71-df9fa34d8542"
          },
          {
            "name": "NumberOfQuestions",
            "dataType": "int64",
            "sourceColumn": "NumberOfQuestions",
            "lineageTag": "10baa3c8-37fa-4697-9e62-645dff22070c"
          },
          {
            "name": "Passed",
            "dataType": "string",
            "sourceColumn": "Passed",
            "lineageTag": "5d2ac5c8-4851-4a26-85d1-d6de0f8f3cec"
          },
          {
            "name": "PersonDetailsID",
            "dataType": "string",
            "sourceColumn": "PersonDetailsID",
            "lineageTag": "09f6e698-8c27-4b19-8dce-2b262c8ab4f9"
          },
          {
            "name": "PreviousExpirationDatekey",
            "dataType": "dateTime",
            "sourceColumn": "PreviousExpirationDatekey",
            "lineageTag": "8bfe2a1a-6bfa-47b5-88bc-65958dcbe30a"
          },
          {
            "name": "SolutionArea",
            "dataType": "string",
            "sourceColumn": "SolutionArea",
            "lineageTag": "6f894792-de80-4432-b0cf-f7cdc29b7ea9"
          },
          {
            "name": "UserProfileGeographyKey",
            "dataType": "string",
            "description": "UserProfileGeographyKey",
            "isHidden": true,
            "sourceColumn": "UserProfileGeographyKey",
            "isAvailableInMdx": false,
            "lineageTag": "df2450aa-5754-4be4-91bc-d1691254e43e"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "sourceColumn": "PersonID",
            "lineageTag": "06366921-df89-4475-b9d7-160c520dcbe2"
          },
          {
            "name": "CertificationRenewalEndTime",
            "dataType": "dateTime",
            "sourceColumn": "CertificationRenewalEndTime",
            "lineageTag": "e1b13077-6767-4e3e-a398-04c2ebe9baea"
          },
          {
            "name": "CertificationRenewalStartTime",
            "dataType": "dateTime",
            "sourceColumn": "CertificationRenewalStartTime",
            "lineageTag": "9bb235e1-eb8f-437e-b266-75a80e982c87"
          }
        ],
        "partitions": [
          {
            "name": "CertificationRenewalParticipation",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT DISTINCT [CertificationRenewalParticipationID]",
                "    ,CRP.[PersonDetailsID]",
                "    ,CRP.[PersonID]",
                "    ,LC.[PersonDetailsID] AS LCPersonDetailsID",
                "    ,CRP.[CertificationUniqueID]",
                "    ,[IsPassed] AS [Passed]",
                "    ,[LearnerCertificationsID]",
                "    ,[AnswersCorrect]",
                "    ,[NumberOfQuestions]",
                "    ,coalesce(CAST(LCR.ExpirationDate AS DATE), DATEADD(YEAR, - 1, CAST(LC.ExpirationDate AS DATE))) AS PreviousExpirationDatekey",
                "    ,[CertificationRenewalStartTime]",
                "    ,[CertificationRenewalEndTime]",
                "    ,C.[CertificationName] AS [CertificationName]",
                "    ,ISNULL([SolutionArea], 'No Solution Area Defined') AS SolutionArea",
                "    ,ISNULL(G.GeographyID, 'Unknown') AS UserProfileGeographyKey",
                "FROM [Learning].[CertificationRenewalParticipation] CRP",
                "INNER JOIN [Learning].[Certifications] C ON CRP.CertificationID = C.CertificationID",
                "INNER JOIN [Learning].[LearnerCertifications] LC ON LC.[PersonDetailsID] = CRP.PersonDetailsID",
                "    AND LC.CertificationID = CRP.CertificationID",
                "LEFT JOIN [Learning].[LearnerCertificationRenewals] LCR ON LCR.[PersonDetailsID] = CRP.PersonDetailsID",
                "    AND LCR.CertificationID = CRP.CertificationID",
                "    AND CAST(CRP.CertificationRenewalStartDate AS DATE) BETWEEN DATEADD(YEAR, - 1, CAST(LCR.ExpirationDate AS DATE))",
                "        AND CAST(LCR.ExpirationDate AS DATE)",
                "LEFT JOIN [Learning].[PersonDetails] PD ON PD.PersonDetailsID = CRP.PersonDetailsID",
                "    AND PD.SourceSystem = 'Learn'",
                "LEFT JOIN Learning.Geographies G ON G.GeographyID = PD.GeographyID",
                "WHERE ISNULL(C.[CertificationType], 'Unknown') NOT IN ('fundamentals')",
                "    AND C.[CertificationType] NOT IN (",
                "        'fundamentals'",
                "        ,'mos'",
                "        ,'mce'",
                "        )",
                "    AND C.CertificationType IS NOT NULL",
                "    AND coalesce(CAST(LCR.ExpirationDate AS DATE), DATEADD(YEAR, - 1, CAST(LC.ExpirationDate AS DATE))) >= '2021-07-01'",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Bridge Exam Fact Is AI",
        "isHidden": true,
        "lineageTag": "2113d6b6-c909-4687-9f55-1c4ea843f9a6",
        "columns": [
          {
            "name": "ExamKey",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ExamKey",
            "lineageTag": "ba935429-1e26-44e7-b107-5bf10d3fb05e"
          },
          {
            "name": "Is AI",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Is AI",
            "lineageTag": "9c47d1cd-cd75-4af1-a08c-964594e9bcfb"
          }
        ],
        "partitions": [
          {
            "name": "Bridge Exam Fact Is AI",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  #\"Exams with IsAI flag\" = Table.Column(",
                "    Table.SelectRows(Table.Buffer(#\"AI Credentials\"), each ([Credential Type] = \"Exam\")), ",
                "    \"Credential Key\"",
                "  ), ",
                "  #\"Exam Numbers\" = Sql.Database(",
                "#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", ",
                "    [",
                "      Query",
                "        = \"SELECT DISTINCT ExamID AS [ExamKey]#(lf)    ,ISNULL(UPPER(ExamNumber), 'Unknown') AS [Exam Number]#(lf)FROM [Learning].[Exams]#(lf)WHERE ExamID IS NOT NULL#(lf)    AND SourceSystem IN (#(lf)        'MSCert'#(lf)        ,'Certiport'#(lf)        )#(lf)    AND SourceIdentifier NOT LIKE 'test%'\"",
                "    ]",
                "  ), ",
                "  #\"Added Custom\" = Table.AddColumn(",
                "    #\"Exam Numbers\", ",
                "    \"Is AI\", ",
                "    each if List.Contains(#\"Exams with IsAI flag\", [Exam Number]) then \"Yes\" else \"No\"",
                "  ), ",
                "  #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom\", {{\"Is AI\", type text}}), ",
                "  #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\", {\"Exam Number\"})",
                "in",
                "  #\"Removed Columns\""
              ]
            }
          }
        ]
      },
      {
        "name": "AppliedSkill_Staging",
        "isHidden": true,
        "lineageTag": "f2663bec-477f-4340-b3cd-6a6d7c0ccba2",
        "columns": [
          {
            "name": "AppliedSkillCode",
            "dataType": "string",
            "sourceColumn": "AppliedSkillCode",
            "lineageTag": "4d1f2edd-8544-431d-baa9-56e56709e788"
          },
          {
            "name": "AppliedSkillCompletionDate",
            "dataType": "dateTime",
            "sourceColumn": "AppliedSkillCompletionDate",
            "lineageTag": "05369f87-f751-420e-bcf4-bea2b549834c"
          },
          {
            "name": "AppliedSkillEarned",
            "dataType": "int64",
            "sourceColumn": "AppliedSkillEarned",
            "lineageTag": "e49c7ef7-7a3a-4ca0-8b3e-061f4da0054c"
          },
          {
            "name": "AppliedSkillEndTime",
            "dataType": "dateTime",
            "sourceColumn": "AppliedSkillEndTime",
            "lineageTag": "c7132804-ccc5-4fe5-8398-b196b099dfdb"
          },
          {
            "name": "AppliedSkillMaxPossibleScore",
            "dataType": "int64",
            "sourceColumn": "AppliedSkillMaxPossibleScore",
            "lineageTag": "e32bd327-4d4b-4642-85f2-0a2332ee4878"
          },
          {
            "name": "AppliedSkillName",
            "dataType": "string",
            "sourceColumn": "AppliedSkillName",
            "lineageTag": "b4f7588c-1fb2-4a55-bf31-6bf77befeb34"
          },
          {
            "name": "AppliedSkillParticipationID",
            "dataType": "string",
            "sourceColumn": "AppliedSkillParticipationID",
            "lineageTag": "4abff9c4-7e00-4c95-8253-5c1ba549a2b6"
          },
          {
            "name": "AppliedSkillPassingScore",
            "dataType": "int64",
            "sourceColumn": "AppliedSkillPassingScore",
            "lineageTag": "c2fe7a26-1029-487b-b6ee-a0b306050f15"
          },
          {
            "name": "AppliedSkillScore",
            "dataType": "double",
            "sourceColumn": "AppliedSkillScore",
            "lineageTag": "370eb2ce-eb92-4d0e-aa86-f3f3964d0381"
          },
          {
            "name": "AppliedSkillStartTime",
            "dataType": "dateTime",
            "sourceColumn": "AppliedSkillStartTime",
            "formatString": "yyyy-MM-dd",
            "lineageTag": "08318139-d7b6-4d92-9285-231021229d37"
          },
          {
            "name": "AppliedSkillStatus",
            "dataType": "string",
            "sourceColumn": "AppliedSkillStatus",
            "lineageTag": "9c78df3a-43e2-4443-a08b-39a064263674"
          },
          {
            "name": "CompletionDate",
            "dataType": "dateTime",
            "sourceColumn": "CompletionDate",
            "lineageTag": "5c21f1ac-0e4c-4a4e-974f-8b16ea110a96"
          },
          {
            "name": "GeographyID",
            "dataType": "string",
            "sourceColumn": "GeographyID",
            "lineageTag": "10b16152-a3ea-4fbc-a213-fc46ead457ed"
          },
          {
            "name": "IsPassed",
            "dataType": "string",
            "sourceColumn": "IsPassed",
            "lineageTag": "5eb241e9-2ae6-4f23-a5d4-bc5443fa78a8"
          },
          {
            "name": "Language",
            "dataType": "string",
            "sourceColumn": "Language",
            "lineageTag": "0a893c68-1e98-4865-8ba8-534566a61342"
          },
          {
            "name": "PersonDetailsID",
            "dataType": "string",
            "sourceColumn": "PersonDetailsID",
            "lineageTag": "3ee7bbd0-ae62-4872-a4ee-fe5a0e57accf"
          },
          {
            "name": "PersonID",
            "dataType": "string",
            "sourceColumn": "PersonID",
            "lineageTag": "91166f1f-6cb6-431e-b17d-dc24e7143144"
          },
          {
            "name": "SolutionArea",
            "dataType": "string",
            "sourceColumn": "SolutionArea",
            "lineageTag": "c40164c7-c935-47f8-9f0e-b30910d531eb"
          },
          {
            "name": "StartDate",
            "dataType": "dateTime",
            "sourceColumn": "StartDate",
            "lineageTag": "a6a89744-1779-453e-9cd4-91b7bd0be114"
          },
          {
            "name": "StartUpDuration",
            "dataType": "int64",
            "sourceColumn": "StartUpDuration",
            "lineageTag": "5cfaa231-90b1-4051-a9a6-1bcab4b49463"
          },
          {
            "name": "TotalTime",
            "dataType": "int64",
            "sourceColumn": "TotalTime",
            "lineageTag": "667a5292-96a3-4693-a5b7-3106b0eb6e17"
          }
        ],
        "partitions": [
          {
            "name": "AppliedSkill_Staging",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT ASP.AppliedSkillParticipationID",
                ",CASE ",
                "WHEN TRY_CAST(ASP.AppliedSkillCompletionDate AS DATE) IS NOT NULL",
                "THEN CONVERT(DATE, ASP.AppliedSkillCompletionDate)",
                "ELSE '1900-01-01'",
                "END AS AppliedSkillCompletionDate",
                ",ASP.AppliedSkillName",
                ",ASP.AppliedSkillScore",
                ",ISNULL(ASP.PersonDetailsID, 'Unknown') AS PersonDetailsID",
                ",CASE ",
                "WHEN TRY_CAST(ASP.AppliedSkillStartTime AS DATE) IS NOT NULL",
                "THEN CONVERT(DATE, ASP.AppliedSkillStartTime)",
                "ELSE '1900-01-01'",
                "END AS AppliedSkillStartTime",
                ",CASE ",
                "WHEN TRY_CAST(ASP.AppliedSkillEndTime AS DATE) IS NOT NULL",
                "THEN CONVERT(DATE, ASP.AppliedSkillEndTime)",
                "ELSE '1900-01-01'",
                "END AS AppliedSkillEndTime",
                ",ASP.AppliedSkillStatus",
                ",ASP.IsPassed",
                ",ASP.PersonID",
                ",ASP.TotalTime",
                ",ASP.Language",
                ",ASP.SolutionArea",
                ",ASP.StartUpDuration",
                ",ASP.AppliedSkillPassingScore",
                ",ASP.AppliedSkillMaxPossibleScore",
                ",ISNULL(ASP.AppliedSkillCompletionDate, '1900-01-01') AS CompletionDate",
                ",CAST(ISNULL(ASP.AppliedSkillStartTime, '1900-01-01') AS DATE) AS StartDate",
                ",ISNULL(PD.GeographyID, 'Unknown') AS GeographyID",
                ",SUBSTRING(ASP.AppliedSkillName, 1, 8) AS AppliedSkillCode",
                ",CASE ",
                "WHEN ASP.PersonDetailsID IS NULL",
                "AND ISNULL(ASP.IsPassed, 'No') = 'Yes'",
                "THEN 1",
                "WHEN ASP.PersonDetailsID IS NOT NULL",
                "AND ROW_NUMBER() OVER (",
                "PARTITION BY ASP.PersonDetailsID",
                ",ASP.AppliedSkillName ORDER BY ISNULL(ASP.IsPassed, 'No') DESC",
                ",ISNULL(CONVERT(DATE, ASP.AppliedSkillCompletionDate), '2200-01-01')",
                ") = 1",
                "AND ISNULL(ASP.IsPassed, 'No') = 'Yes'",
                "THEN 1",
                "END AppliedSkillEarned",
                "FROM [Learning].[AppliedSkillParticipation] ASP",
                "LEFT JOIN [Learning].[PersonDetails] PD ON ASP.PersonDetailsID = PD.PersonDetailsID",
                "AND PD.SourceSystem = 'Learn'",
                "WHERE ASP.AppliedSkillName LIKE 'APL-____%'",
                "AND (",
                "(NOT ASP.SolutionArea LIKE 'APL-0000%')",
                "OR ASP.SolutionArea IS NULL",
                ")",
                "AND ASP.AppliedSkillStatus <> 'Lab Creation Failed'",
                "AND TRY_CAST(ASP.AppliedSkillStartTime AS DATE) >= '2023-10-25'",
                "\"",
                "        ]",
                "    )",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Partner Organization",
        "description": "Partner Organization",
        "lineageTag": "99bad410-d0bc-4aab-a972-fcce6859fb39",
        "columns": [
          {
            "name": "Partner Organization ID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "Partner Organization ID",
            "isAvailableInMdx": false,
            "lineageTag": "13e1796b-e1be-45ad-9c0e-994e4b52876d"
          },
          {
            "name": "Partner One Id",
            "dataType": "string",
            "description": "Partner One Id",
            "sourceColumn": "Partner One ID",
            "lineageTag": "2be171e9-cde3-4d46-b490-ea3d28a702d7"
          },
          {
            "name": "MPN ID",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "MPN ID",
            "isAvailableInMdx": false,
            "lineageTag": "c2601aca-c252-4ec9-87be-e30c2bbbf553"
          },
          {
            "name": "MPN Organization",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "MPN Organization",
            "isAvailableInMdx": false,
            "lineageTag": "86b36f96-3d2e-4bae-bcca-51d5f2650573"
          },
          {
            "name": "PartnerOrganizationKey",
            "dataType": "string",
            "isHidden": true,
            "isKey": true,
            "sourceColumn": "PartnerOrganizationKey",
            "isAvailableInMdx": false,
            "lineageTag": "d43d16ea-7676-4834-8ab1-429b0cad4f9c"
          },
          {
            "name": "Is ESI Partner",
            "dataType": "string",
            "description": "Is ESI Partner",
            "sourceColumn": "Is ESI Partner"
          },
          {
            "name": "Partner Organization",
            "dataType": "string",
            "sourceColumn": "Partner Organization",
            "lineageTag": "8699f582-b0da-4a23-af83-b875c8a684b7"
          },
          {
            "name": "Partner Segment",
            "dataType": "string",
            "sourceColumn": "Partner Segment",
            "lineageTag": "37f3efbb-0e9b-417d-86a1-e29893f0d9a3"
          },
          {
            "name": "Partner Sub Segment",
            "dataType": "string",
            "sourceColumn": "Partner Sub Segment",
            "lineageTag": "6bc93fee-0fcf-4a2f-90ab-8bcab1b40fa7"
          }
        ],
        "partitions": [
          {
            "name": "Partner Organization",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = Sql.Database(#\"Conformed SQL Fabric Endpoint\", #\"Conformed SQL Endpoint dataset\", [Query=\"",
                "SELECT [Partner Organization ID]",
                "    ,[Partner Organization]",
                "    ,[Partner One ID]",
                "    ,[PartnerOrganizationKey]",
                "    ,[MPN ID]",
                "    ,[MPN Organization]",
                "    ,[Is ESI Partner]",
                "    ,[Partner Segment]",
                "    ,[Partner Sub Segment]",
                "FROM (",
                "    SELECT DISTINCT ISNULL(CAST(PD.PartnerOneID AS NVARCHAR(255)), 'Unknown') AS [Partner Organization ID]",
                "        ,COALESCE(A.PartnerOneName,LP.PartnerOneName,'Unknown') AS [Partner Organization]",
                "        ,ISNULL(CAST(PD.PartnerOneID AS NVARCHAR(255)), 'Unknown') AS [Partner One ID]",
                "        ,ISNULL(CAST(PD.PartnerOneID AS NVARCHAR(255)), 'Unknown') AS [PartnerOrganizationKey]",
                "        ,ISNULL(A.IsGPSNominatedPartner, 'No') AS [Is ESI Partner]",
                "        ,ISNULL(CAST(PD.PartnerOneID AS NVARCHAR(255)), 'Unknown') AS [MPN ID]",
                "        ,COALESCE(A.PartnerOneName,LP.PartnerOneName,'Unknown') AS [MPN Organization]",
                "        ,ROW_NUMBER() OVER (",
                "            PARTITION BY PD.PartnerOneID ORDER BY IIF(A.PartnerOneName IS NOT NULL or LP.PartnerOneName IS NOT NULL, 1, 0) DESC",
                "            ) AS Row_Num",
                "    ,CASE ",
                "    WHEN PD.[PartnerOneID] IS NOT NULL",
                "    THEN ISNULL(PS.PartnerSegment, 'Unknown')",
                "    ELSE 'N/A'",
                "    END AS [Partner Segment]",
                "    ,CASE ",
                "    WHEN PD.[PartnerOneID] IS NOT NULL",
                "    THEN ISNULL(PS.PartnerSubSegment, 'Unknown')",
                "    ELSE 'N/A'",
                "    END AS [Partner Sub Segment]",
                "    FROM (",
                "        SELECT DISTINCT PD.PartnerOneID",
                "        FROM Learning.[PersonDetails] PD ",
                "        WHERE PD.PartnerOneID IS NOT NULL",
                "        ) PD",
                "    LEFT JOIN Learning.[Accounts] A",
                "        ON PD.PartnerOneID = A.PartnerOneID",
                "    LEFT JOIN Learning.LearningPartners LP",
                "        ON LP.PartnerOneID = PD.PartnerOneID",
                "    LEFT JOIN dbo.PartnerSegment PS ",
                "        ON PS.PartnerOneID = PD.PartnerOneID",
                "    ) AS Base",
                "WHERE Row_Num = 1 ",
                "",
                "UNION ALL",
                "",
                "SELECT 'Unknown' AS [Partner Organization ID]",
                "    ,'Unknown' AS [Partner Organization]",
                "    ,'Unknown' AS [Partner One ID]",
                "    ,'Unknown' AS [PartnerOrganizationKey]",
                "    ,'Unknown' AS [MPN ID]",
                "    ,'Unknown' AS [MPN Organization]",
                "    ,'No' AS [Is ESI Partner]",
                ",'Unknown' AS [Partner Segment]",
                ",'Unknown' AS [Partner Sub Segment]",
                "\"])",
                "in",
                "    Source"
              ]
            }
          }
        ]
      },
      {
        "name": "Exam Pass Rate User Requests",
        "isHidden": true,
        "columns": [
          {
            "name": "Requestor Alias",
            "dataType": "string",
            "description": "Requestor Alias",
            "isHidden": true,
            "sourceColumn": "field_2",
            "isAvailableInMdx": false
          }
        ],
        "partitions": [
          {
            "name": "Exam Pass Rate User Requests",
            "dataView": "full",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "  Source = #\"SharePoint/https://microsoft sharepoint com/teams/WWLReporting\", ",
                "  #\"9a82b83f-726b-465f-b210-82cc73ee7bf4\" = Source",
                "    {[Id = \"9a82b83f-726b-465f-b210-82cc73ee7bf4\"]}",
                "    [Items], ",
                "  #\"Removed Other Columns\" = Table.SelectColumns(",
                "    #\"9a82b83f-726b-465f-b210-82cc73ee7bf4\", ",
                "    {\"Title\", \"field_2\"}",
                "  )",
                "in",
                "  #\"Removed Other Columns\""
              ]
            }
          }
        ]
      }
    ],
    "relationships": [
      {
        "name": "ac14d5b9-f550-4384-a19b-881405ad40ba",
        "fromTable": "Applied Skill Participation",
        "fromColumn": "AppliedSkillStartTime",
        "toTable": "Time",
        "toColumn": "Date"
      },
      {
        "name": "e3904568-5baa-4c88-bcb9-7f828e144a6d",
        "fromTable": "Applied Skill Participation",
        "fromColumn": "GeographyID",
        "toTable": "User Profile Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "2c13cac6-e72c-4f71-894e-1a0226bbfa79",
        "fromTable": "Applied Skill Participation",
        "fromColumn": "PersonDetailsID",
        "toTable": "User",
        "toColumn": "UserKey"
      },
      {
        "name": "2e98f496-9bb9-41ee-90fe-f9da27d692e5",
        "fromTable": "Assessment",
        "fromColumn": "DateKey",
        "toTable": "Time",
        "toColumn": "DateKey"
      },
      {
        "name": "1b2d8885-14d0-43d7-b4dc-e3c0fb5ef052",
        "fromTable": "Assessment",
        "fromColumn": "Exam ID",
        "toTable": "Bridge Practice Exam Fact Is AI",
        "toColumn": "ExamKey"
      },
      {
        "name": "18b1c556-283a-4cab-b819-433c00de7193",
        "toCardinality": "many",
        "fromTable": "Assessment",
        "fromColumn": "Exam Number",
        "toTable": "Exam",
        "toColumn": "Exam Number"
      },
      {
        "name": "aaf065ec-4155-4107-80d4-910069da7d57",
        "fromTable": "Assessment",
        "fromColumn": "Locale",
        "toTable": "Language Mapping",
        "toColumn": "LCID string"
      },
      {
        "name": "3ab8669e-1777-4b46-9c9d-8eb0440a5fd6",
        "fromTable": "Assessment",
        "fromColumn": "UserProfileGeographyKey",
        "toTable": "User Profile Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "2a4ca04e-d741-48c4-b830-ab3ac7242f6f",
        "fromTable": "Bridge Certification Exam",
        "fromColumn": "ExamKey",
        "toTable": "Exam",
        "toColumn": "ExamKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "505b4c8a-1726-477e-af32-70d437ee56e1",
        "fromTable": "Bridge Certification Fact Is AI",
        "fromColumn": "Is AI",
        "toTable": "Is AI",
        "toColumn": "Is AI"
      },
      {
        "name": "a961b63b-9c74-4624-a316-365eda275e3f",
        "fromTable": "Bridge Exam Fact Is AI",
        "fromColumn": "Is AI",
        "toTable": "Is AI",
        "toColumn": "Is AI"
      },
      {
        "name": "7ebf6c89-c3c2-49e0-b006-c3354a31ca3d",
        "fromTable": "Bridge Person Account",
        "fromColumn": "AccountID",
        "toTable": "Account",
        "toColumn": "AccountID"
      },
      {
        "name": "c5a31804-9319-4dc3-b692-fad0ad961c1c",
        "fromTable": "Bridge Practice Exam Fact Is AI",
        "fromColumn": "Is AI",
        "toTable": "Is AI",
        "toColumn": "Is AI"
      },
      {
        "name": "006cedc4-b9d3-4bbd-922c-07c9f9d0b173",
        "fromTable": "CertificationRenewalParticipation",
        "fromColumn": "UserProfileGeographyKey",
        "toTable": "User Profile Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "865ccf31-09a5-4cdd-8d28-43e4928791d6",
        "fromTable": "Fact Certification",
        "fromColumn": "AchievementEndDateKey",
        "toTable": "Time",
        "toColumn": "DateKey",
        "isActive": false
      },
      {
        "name": "2e46bda9-702f-49fb-b3ae-7377b8000711",
        "fromTable": "Fact Certification",
        "fromColumn": "CertificationKey",
        "toTable": "Bridge Certification Fact Is AI",
        "toColumn": "CertificationKey"
      },
      {
        "name": "caaf3055-7c96-4692-9ff5-2cdd0bd7f6f8",
        "fromTable": "Fact Certification",
        "fromColumn": "DateKey",
        "toTable": "Time",
        "toColumn": "DateKey"
      },
      {
        "name": "ff577bca-eef8-42b9-807d-112b7aa423d4",
        "fromTable": "Fact Certification",
        "fromColumn": "Is Migrated Certification",
        "toTable": "Migrated Certification",
        "toColumn": "Is Migrated Certification"
      },
      {
        "name": "7e5cc2a8-19aa-44e5-87d5-ca54d9ed89ef",
        "fromTable": "Fact Certification",
        "fromColumn": "PreviousExpirationDatekey",
        "toTable": "Time",
        "toColumn": "DateKey",
        "isActive": false
      },
      {
        "name": "5f68fca9-c02b-4889-bd99-0202c6766704",
        "fromTable": "Fact Certification",
        "fromColumn": "StayCurrentEligibilityEndDateKey",
        "toTable": "Time",
        "toColumn": "DateKey",
        "isActive": false
      },
      {
        "name": "444fb3fd-7690-4d44-bccf-a1162dc964dd",
        "fromTable": "Fact Certification",
        "fromColumn": "StayCurrentEligibilityStartDateKey",
        "toTable": "Time",
        "toColumn": "DateKey",
        "isActive": false
      },
      {
        "name": "3a6c4a5f-7275-4303-9e9b-7be27adb4c50",
        "fromTable": "Fact Certification",
        "fromColumn": "UserProfileGeographyKey",
        "toTable": "User Profile Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "4d5c1d41-f8e1-477f-a9d4-e06ec30819e9",
        "fromTable": "Fact Certiport VLUtilization",
        "fromColumn": "DatePurchased_PK",
        "toTable": "Time",
        "toColumn": "Date"
      },
      {
        "name": "9c53271b-f90b-46c0-a2a5-9988631bd726",
        "toCardinality": "many",
        "fromTable": "Fact Certiport VLUtilization",
        "fromColumn": "Product_PK",
        "toTable": "Certiport Product Type",
        "toColumn": "Product_PK"
      },
      {
        "name": "ae4e0b83-a92c-404c-bb36-f816e11d3ef7",
        "fromTable": "Fact Certiport VLUtilization",
        "fromColumn": "VLUtilization_PK",
        "toTable": "Certiport VLUtilization",
        "toColumn": "VLUtilization_PK"
      },
      {
        "name": "8a4b5445-f48a-44a8-8146-aacba01c3d8f",
        "fromTable": "Fact Exam",
        "fromColumn": "ChannelKey",
        "toTable": "Channel",
        "toColumn": "ChannelKey"
      },
      {
        "name": "b57ecae9-d8e2-415e-b870-5889172aeccb",
        "fromTable": "Fact Exam",
        "fromColumn": "DateKey",
        "toTable": "Time",
        "toColumn": "DateKey"
      },
      {
        "name": "6f1da271-cfbd-4989-b284-6d9ebc734c87",
        "fromTable": "Fact Exam",
        "fromColumn": "EventKey",
        "toTable": "Event",
        "toColumn": "EventKey"
      },
      {
        "name": "c0660172-8bc3-4504-840e-ea4935a9d591",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamDeliveryKey",
        "toTable": "Exam Delivery",
        "toColumn": "ExamDeliveryKey"
      },
      {
        "name": "588b9449-36d3-449a-b9f2-04cf24be4a97",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamKey",
        "toTable": "Bridge Exam Fact Is AI",
        "toColumn": "ExamKey"
      },
      {
        "name": "be2e938d-fff9-4fb8-b0e2-cbe14d598ec9",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamKey",
        "toTable": "Exam",
        "toColumn": "ExamKey"
      },
      {
        "name": "46932b82-ea0e-4ee9-8de6-c22633b3567a",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamOfferKey",
        "toTable": "Exam Offer",
        "toColumn": "ExamOfferKey"
      },
      {
        "name": "07b5a77b-802d-4350-b6cc-6187d5be7f73",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamOfferKey",
        "toTable": "Stg_Channel_Offer",
        "toColumn": "ExamOfferKey"
      },
      {
        "name": "0859325c-5252-4cca-b5eb-996729ed0227",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamStatusKey",
        "toTable": "Exam Status",
        "toColumn": "ExamStatusKey"
      },
      {
        "name": "686c1128-a690-4403-8221-897c8f9f3be5",
        "fromTable": "Fact Exam",
        "fromColumn": "ExamVendorKey",
        "toTable": "Stg_Channel_Exams",
        "toColumn": "ExamVendorKey"
      },
      {
        "name": "2d8f651d-a2cc-4e5d-b5db-e520ac7af226",
        "fromTable": "Fact Exam",
        "fromColumn": "TestCenterGeographyKey",
        "toTable": "Test Center Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "d91613b9-8e8b-4034-86b7-5535fd0f66f1",
        "fromTable": "Fact Exam",
        "fromColumn": "TestCenterKey",
        "toTable": "Test Center",
        "toColumn": "TestCenterKey"
      },
      {
        "name": "67df8270-5845-4c5b-b6f4-16cb8a05e9d4",
        "fromTable": "Fact Exam",
        "fromColumn": "UserProfileGeographyKey",
        "toTable": "User Profile Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "00165c99-1f00-4f26-b90a-0056cbed1112",
        "fromTable": "Fact MCT",
        "fromColumn": "MCTExpirationKey",
        "toTable": "MCT Expiration",
        "toColumn": "MCTExpirationKey"
      },
      {
        "name": "c7795939-0c0a-4792-8751-80a121ef150f",
        "fromTable": "Fact Registrations",
        "fromColumn": "ChannelKey",
        "toTable": "Channel",
        "toColumn": "ChannelKey"
      },
      {
        "name": "e86f32d1-409e-4721-a93a-9f439a47dc5c",
        "fromTable": "Fact Registrations",
        "fromColumn": "DateKey",
        "toTable": "Time",
        "toColumn": "DateKey"
      },
      {
        "name": "78d71b1b-1363-444d-82e0-1bbb65f8ead3",
        "fromTable": "Fact Registrations",
        "fromColumn": "ExamDeliveryKey",
        "toTable": "Exam Delivery",
        "toColumn": "ExamDeliveryKey"
      },
      {
        "name": "b60aaf17-9ce3-4550-b010-a7f80adde0e9",
        "fromTable": "Fact Registrations",
        "fromColumn": "ExamKey",
        "toTable": "Exam",
        "toColumn": "ExamKey"
      },
      {
        "name": "cc986ee7-19a0-4c22-b072-920653b5ee18",
        "fromTable": "Fact Registrations",
        "fromColumn": "ExamOfferKey",
        "toTable": "Exam Offer",
        "toColumn": "ExamOfferKey"
      },
      {
        "name": "7a9e84c6-526f-49d1-9e03-6699edd2997c",
        "fromTable": "Fact Registrations",
        "fromColumn": "ExamOfferKey",
        "toTable": "Stg_Channel_Offer",
        "toColumn": "ExamOfferKey"
      },
      {
        "name": "7f8d7b36-87eb-4982-9f98-a1e45b6195b4",
        "fromTable": "Fact Registrations",
        "fromColumn": "ExamVendorKey",
        "toTable": "Stg_Channel_Exams",
        "toColumn": "ExamVendorKey"
      },
      {
        "name": "1712dad2-b960-4914-ad15-71dd5a013892",
        "fromTable": "Fact Registrations",
        "fromColumn": "TestCenterGeographyKey",
        "toTable": "Test Center Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "17546fd6-7562-4fc0-900a-2f4bd511c4e8",
        "fromTable": "Fact Registrations",
        "fromColumn": "TestCenterKey",
        "toTable": "Test Center",
        "toColumn": "TestCenterKey"
      },
      {
        "name": "eb137322-b29e-4f3e-b186-1fdf81472f21",
        "fromTable": "Fact Registrations",
        "fromColumn": "UserProfileGeographyKey",
        "toTable": "User Profile Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "188eb912-98f4-4745-ba28-21ca254e41b4",
        "toCardinality": "many",
        "fromTable": "Sales Group",
        "fromColumn": "SalesGroupHierarchyKey",
        "toTable": "Account",
        "toColumn": "SalesGroupHierarchyKey",
        "crossFilteringBehavior": "bothDirections",
        "securityFilteringBehavior": "bothDirections"
      },
      {
        "name": "b6d6f277-81ac-47be-a2ab-5849c8701f05",
        "fromTable": "User",
        "fromColumn": "FinanceGeographyKey",
        "toTable": "FTE Geo",
        "toColumn": "FinanceGeographyKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "02d1e7cb-a689-49b2-821e-21f9de52834d",
        "fromTable": "User",
        "fromColumn": "FinanceOrganizationKey",
        "toTable": "Finance Organization",
        "toColumn": "FinanceOrganizationKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "3047c28e-ef08-41a9-b302-de040d3c5159",
        "fromTable": "User",
        "fromColumn": "MCTGeographyKey",
        "toTable": "MCT Geography",
        "toColumn": "GeographyKey"
      },
      {
        "name": "a394613f-124b-4c06-a85b-de2c69929a9c",
        "fromTable": "User",
        "fromColumn": "MSUserKey",
        "toTable": "FTE Classification",
        "toColumn": "MSUserKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "18189eef-33be-4498-9b61-c86923e7f997",
        "toCardinality": "many",
        "fromTable": "Fact Registrations",
        "fromColumn": "VendorKey",
        "toTable": "Test Center Vendor",
        "toColumn": "VendorKey"
      },
      {
        "name": "d7087d62-5b9e-42a1-9adf-5d67dfdbce15",
        "toCardinality": "many",
        "fromTable": "Fact Exam",
        "fromColumn": "VendorKey",
        "toTable": "Test Center Vendor",
        "toColumn": "VendorKey"
      },
      {
        "name": "07912c0d-b101-4a6a-8a78-bc4069b6959d",
        "toCardinality": "many",
        "fromTable": "Fact Exam",
        "fromColumn": "LanguageKey",
        "toTable": "Language",
        "toColumn": "LanguageKey"
      },
      {
        "name": "d200f9ec-42da-4227-9426-ec649fe58e95",
        "fromTable": "Applied Skill Participation",
        "fromColumn": "Is AI",
        "toTable": "Is AI",
        "toColumn": "Is AI"
      },
      {
        "name": "e8c7a9db-e361-45ed-8b9a-c1fa5a1b18b8",
        "fromTable": "Bridge Person Account",
        "fromColumn": "PersonDetailsID",
        "toTable": "User",
        "toColumn": "UserKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "ce7af39a-c8ee-49c0-a561-ab68aed94dce",
        "fromTable": "Fact Exam",
        "fromColumn": "UserKey",
        "toTable": "User",
        "toColumn": "UserKey"
      },
      {
        "name": "126ae181-12b4-46d7-9062-f0c4b647ae49",
        "fromTable": "Fact Registrations",
        "fromColumn": "UserKey",
        "toTable": "User",
        "toColumn": "UserKey"
      },
      {
        "name": "d38ee955-7529-462d-aa40-cfcfe2c81465",
        "fromTable": "Fact Certification",
        "fromColumn": "CertificationKey",
        "toTable": "Certification",
        "toColumn": "CertificationKey"
      },
      {
        "name": "51f4ead5-b35a-40f1-9f2a-aec903e5ea09",
        "fromTable": "Bridge Certification Exam",
        "fromColumn": "CertificationKey",
        "toTable": "Certification",
        "toColumn": "CertificationKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "2f2881b4-2bb6-42fd-9ae1-7433bbaf43a8",
        "fromTable": "Fact Certification",
        "fromColumn": "UserKey",
        "toTable": "User",
        "toColumn": "UserKey"
      },
      {
        "name": "0ec392f4-e7ff-4ba1-9db2-2039e787bbc9",
        "fromTable": "User",
        "fromColumn": "PartnerOrganizationKey",
        "toTable": "Partner Organization",
        "toColumn": "PartnerOrganizationKey",
        "crossFilteringBehavior": "bothDirections"
      },
      {
        "name": "a782695b-9e56-4ede-89a8-7106f7e2243a",
        "fromTable": "CertificationRenewalParticipation",
        "fromColumn": "PersonDetailsID",
        "toTable": "User",
        "toColumn": "UserKey"
      },
      {
        "name": "12bd11c6-50d6-407a-b98a-65fdb18c5a7d",
        "fromTable": "Bridge Person Account",
        "fromColumn": "EmailAddressDomain",
        "toTable": "IsAcademic PersonID",
        "toColumn": "EmailAddressDomain_Trim"
      },
      {
        "name": "16031d4e-1c68-43f8-a1d0-a4d52d681377",
        "fromTable": "Fact MCT",
        "fromColumn": "UserKey",
        "toTable": "User",
        "toColumn": "UserKey"
      },
      {
        "name": "9d00bf2f-6fdd-480e-bb33-7578b7e9d861",
        "fromTable": "Assessment",
        "fromColumn": "PersonDetailsID",
        "toTable": "User",
        "toColumn": "UserKey"
      }
    ],
    "expressions": [
      {
        "name": "Conformed SQL Endpoint dataset",
        "kind": "m",
        "expression": "\"WISE_DEA_Conformed_DEV\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = \"Text\"]",
        "lineageTag": "1a054e79-d4cc-46e7-95de-d254736914e1"
      },
      {
        "name": "Conformed SQL Fabric Endpoint",
        "kind": "m",
        "expression": "\"x6eps4xrq2xudenlfv6naeo3i4-ivvhvqa7vb5ehmh3mvln52zqo4.msit-datawarehouse.fabric.microsoft.com\" meta [IsParameterQuery = true, IsParameterQueryRequired = true, Type = \"Text\"]",
        "lineageTag": "f82724ba-a79a-4331-8057-839a09eaa3c4"
      }
    ],
    "annotations": [
      {
        "name": "TabularEditor_SerializeOptions",
        "value": "{\"IgnoreInferredObjects\":true,\"IgnoreInferredProperties\":true,\"IgnoreTimestamps\":true,\"SplitMultilineStrings\":true,\"PrefixFilenames\":false,\"LocalTranslations\":false,\"LocalPerspectives\":false,\"LocalRelationships\":false,\"Levels\":[\"Data Sources\",\"Perspectives\",\"Relationships\",\"Roles\",\"Shared Expressions\",\"Tables\",\"Tables/Calculation Items\",\"Tables/Columns\",\"Tables/Hierarchies\",\"Tables/Measures\",\"Tables/Partitions\",\"Translations\"]}"
      },
      {
        "name": "BestPracticeAnalyzer_IgnoreRules",
        "value": "{\"RuleIDs\":[]}"
      },
      {
        "name": "BestPracticeAnalyzer_ExternalRuleFiles",
        "value": "[\"..\\\\..\\\\Dax Best Practices (2).json\"]"
      },
      {
        "name": "__PBI_ServiceStoredInTmdl",
        "value": "reserved"
      }
    ]
  }
}